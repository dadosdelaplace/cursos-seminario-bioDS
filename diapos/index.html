<!DOCTYPE html>
<html lang="es"><head>
<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/tabby.min.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.294">

  <meta name="author" content="Seminarios BioDS • curso 2023-2024">
  <title>Tidyverse y Quarto</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="index_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="img/data-science-2.jpeg" data-background-opacity="0.2" data-background-size="cover" class="quarto-title-block center">
  <h1 class="title">Tidyverse y Quarto</h1>
  <p class="subtitle">Seminario de tidyverse y Quarto para docencia e investigación</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Seminarios BioDS • curso 2023-2024 
</div>
</div>
</div>

</section>
<section>
<section id="bienvenidos-a-tidyverse" class="title-slide slide level1 center">
<h1>¡Bienvenidos a tidyverse!</h1>
<p><span style="color:#444442;"><strong>Dejad vuestros bucles a un lado</strong></span></p>
</section>
<section id="objetivos" class="slide level2">
<h2>Objetivos</h2>
<div class="columns">
<div class="column" style="width:37%;">
<p><img data-src="https://assets-global.website-files.com/6092cb6b4ac959f39728dd26/6188a97fa499b5fbfe410417_target%20(1).png" class="quarto-discovered-preview-image"></p>
</div><div class="column" style="width:63%;">
<div>
<ul>
<li class="fragment"><p>Entender los <span class="hl-yellow"><strong>conceptos básicos de tidyverse</strong></span> desde cero → aprender programar funcional (sin bucles)</p></li>
<li class="fragment"><p>Utilidad de tidyverse → flujos de trabajo <span class="hl-yellow"><strong>reproducibles</strong>, <strong>legibles</strong>, <strong>transparentes</strong></span> y mantenibles</p></li>
<li class="fragment"><p>Introducción a <span class="hl-yellow"><strong>Quarto</strong></span> → elaboración de material docente</p></li>
<li class="fragment"><p>Introducción a Github en RStudio</p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="materiales" class="slide level2">
<h2>Materiales</h2>
<ul>
<li><span class="hl-yellow"><strong>Diapositivas</strong></span>: las diapositivas que usaremos disponibles y actualizadas en <strong><a href="https://javieralvarezliebana.es/cursos-seminario-bioDS/diapos" class="uri">https://javieralvarezliebana.es/cursos-seminario-bioDS/diapos</a></strong></li>
</ul>
<p>En el menú de las diapositivas (abajo a la izquierda) tienes una <span class="hl-yellow"><strong>opción para descargarlas en pdf</strong></span> en <code>Tools</code> (consejo: no lo hagas hasta el final del curso ya que irán modificándose)</p>
<p>&nbsp;</p>
<ul>
<li><p><span class="hl-yellow"><strong>Código de las diapositivas</strong></span>: <a href="https://github.com/dadosdelaplace/cursos-seminario-bioDS"><strong>repositorio Github</strong></a></p></li>
<li><p><span class="hl-yellow"><strong>Resúmenes de paquetes</strong></span>: <a href="https://github.com/dadosdelaplace/cursos-seminario-bioDS/tree/main/fichas%20paquetes"><strong>chuletas de los paquetes</strong></a> en formato .pdf</p></li>
</ul>
</section>
<section id="sé-organizado-proyectos" class="slide level2">
<h2>Sé organizado: proyectos</h2>
<p>De la misma manera que en el ordenador solemos trabajar de manera <span class="hl-yellow"><strong>ordenada por carpetas</strong></span>, en <code>RStudio</code> podemos hacer lo mismo para trabajar de <span class="hl-yellow"><strong>manera eficaz creando proyectos</strong></span>.</p>
<div class="fragment">
<div class="columns">
<div class="column" style="width:60%;">
<p>Un <span class="hl-yellow"><strong>proyecto será una «carpeta»</strong></span> dentro de <code>RStudio</code>, de manera que nuestro directorio raíz automáticamente será la propia carpeta de proyecto (pudiendo pasar de un proyecto a otro con el menu superior derecho).</p>
<p>Podemos crear uno en una carpeta nueva o en una carpeta ya existente.</p>
</div><div class="column" style="width:40%;">
<p><img data-src="img/rstudio_proyectos.png" width="370"></p>
</div>
</div>
</div>
</section></section>
<section>
<section id="bloque-I" class="title-slide slide level1 center">
<h1>Intentos de bases de datos</h1>
<p><span style="color:#444442;"><strong>Matrices y data.frames</strong></span></p>
</section>
<section id="primera-intento-matrices" class="slide level2">
<h2>Primera intento: matrices</h2>
<p>Cuando analizamos datos solemos tener <span class="hl-yellow"><strong>varias variables</strong></span> de cada individuo: necesitamos una «tabla» que las recopile. La opción más inmediata son las <span class="hl-yellow"><strong>matrices</strong></span>: concatenación de variables del <span class="hl-purple"><strong>mismo tipo e igual longitud</strong></span>.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>estaturas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">150</span>, <span class="dv">160</span>, <span class="dv">170</span>, <span class="dv">180</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a>pesos <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">63</span>, <span class="dv">70</span>, <span class="dv">85</span>, <span class="dv">95</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a>datos_matriz <span class="ot">&lt;-</span> <span class="fu">cbind</span>(estaturas, pesos)</span>
<span id="cb1-4"><a href="#cb1-4"></a>datos_matriz</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     estaturas pesos
[1,]       150    63
[2,]       160    70
[3,]       170    85
[4,]       180    95</code></pre>
</div>
</div>
</div>
</section>
<section id="primer-intento-matrices" class="slide level2">
<h2>Primer intento: matrices</h2>
<p>También podemos <span class="hl-yellow"><strong>realizar operaciones por columnas/filas</strong></span> sin recurrir a bucles con la función <code>apply()</code>, y le indicaremos como <strong>argumentos</strong></p>
<ul>
<li>la matriz</li>
<li>el sentido de la operación (MARGIN = 1 por filas, MARGIN = 2 por columnas)</li>
<li>la función a aplicar</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># Media (mean) por columnas (MARGIN = 2)</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="fu">apply</span>(datos_matriz, <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> <span class="st">"mean"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>estaturas     pesos 
   165.00     78.25 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># (Cuasi)varianza (var) por columnas (MARGIN = 2)</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="fu">apply</span>(datos_matriz, <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> <span class="st">"var"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>estaturas     pesos 
 166.6667  208.9167 </code></pre>
</div>
</div>
</div>
</section>
<section id="segundo-intento-data.frame" class="slide level2">
<h2>Segundo intento: data.frame</h2>
<p>Para poder trabajar con <span class="hl-yellow"><strong>variables de distinto tipo</strong></span> tenemos lo que se conoce como <span class="hl-yellow"><strong>data.frame</strong></span>: concatenación de variables de igual longitud pero pueden ser de <span class="hl-purple"><strong>tipo distinto</strong></span>.</p>
<p>Dado que un <code>data.frame</code> es ya una «base de datos» las variables no son meros vectores matemáticos: <span class="hl-yellow"><strong>tienen un significado</strong></span> y podemos (debemos) <span class="hl-purple"><strong>ponerles nombres</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb7-2"><a href="#cb7-2"></a>tabla <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"edad"</span> <span class="ot">=</span> <span class="dv">25</span><span class="sc">:</span><span class="dv">27</span>, <span class="st">"estado"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">NA</span>, <span class="cn">FALSE</span>),</span>
<span id="cb7-3"><a href="#cb7-3"></a>                    <span class="st">"nombre"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"javi"</span>, <span class="st">"sandra"</span>, <span class="st">"carlos"</span>),</span>
<span id="cb7-4"><a href="#cb7-4"></a>                    <span class="st">"f_nacimiento"</span> <span class="ot">=</span> <span class="fu">as_date</span>(<span class="fu">c</span>(<span class="st">"1989-09-10"</span>, <span class="st">"1996-06-12"</span>, <span class="st">"1980-11-27"</span>)))</span>
<span id="cb7-5"><a href="#cb7-5"></a>tabla</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  edad estado nombre f_nacimiento
1   25   TRUE   javi   1989-09-10
2   26     NA sandra   1996-06-12
3   27  FALSE carlos   1980-11-27</code></pre>
</div>
</div>
</section>
<section id="segundo-intento-data.frame-1" class="slide level2">
<h2>Segundo intento: data.frame</h2>
<p>Si queremos acceder a sus elementos, podemos como en las matrices (aunque no es recomendable): ahora <span class="hl-yellow"><strong>tenemos dos índices</strong></span> (filas y columnas, dejando libre la que no usemos)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>tabla[<span class="dv">2</span>, ]  <span class="co"># segunda fila (todas sus variables)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  edad estado nombre f_nacimiento
2   26     NA sandra   1996-06-12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>tabla[, <span class="dv">3</span>]  <span class="co"># tercera columna (de todos los individuos)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "javi"   "sandra" "carlos"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>tabla[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># primera característica de la segunda persona</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 26</code></pre>
</div>
</div>
<div class="fragment">
<div class="columns">
<div class="column" style="width:25%;">
<p><img data-src="img/menu_data_frame.jpg"></p>
</div><div class="column" style="width:75%;">
<p>También tiene ventajas de una <span class="hl-yellow"><strong>«base» de datos</strong></span> : podemos <span class="hl-purple"><strong>aceder a las variables por su nombre</strong></span> (<strong>recomendable</strong> ya que las variables pueden cambiar de posición), poniendo el nombre de la tabla seguido del símbolo <code>$</code> (con el <strong>tabulador</strong>, nos aparecerá un menú de columnas a elegir)</p>
</div>
</div>
</div>
</section>
<section id="intento-final-tibble" class="slide level2">
<h2>Intento final: tibble</h2>
<p>Las tablas en formato <code>data.frame</code> tienen algunas <span class="hl-red"><strong>limitaciones</strong></span></p>
<p>La principal es que <span class="hl-red"><strong>no permite la definición “al vuelo”</strong></span>: imagina que definimos una base de datos con estaturas y pesos, y queremos una tercera variable con el IMC</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">data.frame</span>(<span class="st">"estatura"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">1.7</span>, <span class="fl">1.8</span>, <span class="fl">1.6</span>), <span class="st">"peso"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">75</span>, <span class="dv">70</span>),</span>
<span id="cb15-2"><a href="#cb15-2"></a>           <span class="st">"IMC"</span> <span class="ot">=</span> peso <span class="sc">/</span> (estatura<span class="sc">^</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in data.frame(estatura = c(1.7, 1.8, 1.6), peso = c(80, 75, 70), : objeto 'peso' no encontrado</code></pre>
</div>
</div>
<div class="fragment">
<p>De ahora en adelante usaremos el formato <code>tibble</code> (un <span class="hl-yellow"><strong>data.frame mejorado</strong></span>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="fu">tibble</span>(<span class="st">"estatura"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">1.7</span>, <span class="fl">1.8</span>, <span class="fl">1.6</span>), <span class="st">"peso"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">75</span>, <span class="dv">70</span>),</span>
<span id="cb17-3"><a href="#cb17-3"></a>       <span class="st">"IMC"</span> <span class="ot">=</span> peso <span class="sc">/</span> (estatura<span class="sc">^</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  estatura  peso   IMC
     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1      1.7    80  27.7
2      1.8    75  23.1
3      1.6    70  27.3</code></pre>
</div>
</div>
</div>
</section>
<section id="intento-final-tibble-1" class="slide level2">
<h2>Intento final: tibble</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>tabla <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"estatura"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">1.7</span>, <span class="fl">1.8</span>, <span class="fl">1.6</span>), <span class="st">"peso"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">75</span>, <span class="dv">70</span>),</span>
<span id="cb19-2"><a href="#cb19-2"></a>                <span class="st">"IMC"</span> <span class="ot">=</span> peso <span class="sc">/</span> (estatura<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb19-3"><a href="#cb19-3"></a>tabla</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  estatura  peso   IMC
     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1      1.7    80  27.7
2      1.8    75  23.1
3      1.6    70  27.3</code></pre>
</div>
</div>
<p>Las tablas en formato <code>tibble</code> nos permitirá una <span class="hl-yellow"><strong>gestión más ágil, eficiente y coherente</strong></span> de los datos, con 4 ventajas principales:</p>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Metainformación</strong></span>: si te fijas en la cabecera, nos dice ya automáticamente el número de filas y columnas, y el tipo de cada variable</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Recursividad</strong></span>: permite definir las variables secuencialmente (como hemos visto)</li>
</ul>
</div>
</section>
<section id="intento-final-tibble-2" class="slide level2">
<h2>Intento final: tibble</h2>
<ul>
<li><span class="hl-yellow"><strong>Consistencia</strong></span>: si accedes a una columna que no existe avisa con un warning</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>tabla<span class="sc">$</span>invent</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Unknown or uninitialised column: `invent`.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
</div>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Por filas</strong></span>: crear por filas (copiar y pegar de una tabla) con <code>tribble()</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="fu">tribble</span>(<span class="sc">~</span>colA, <span class="sc">~</span>colB,</span>
<span id="cb24-2"><a href="#cb24-2"></a>        <span class="st">"a"</span>,   <span class="dv">1</span>,</span>
<span id="cb24-3"><a href="#cb24-3"></a>        <span class="st">"b"</span>,   <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  colA   colB
  &lt;chr&gt; &lt;dbl&gt;
1 a         1
2 b         2</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Consejo</strong></p>
</div>
<div class="callout-content">
<p>El paquete <code>{datapasta}</code> nos permite <span class="hl-green"><strong>copiar y pegar</strong></span> tablas de páginas web y documentos sencillos</p>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="bloque-II" class="title-slide slide level1 center">
<h1>Base de tidyverse: tidydata</h1>
<p><span style="color:#444442;"><strong>Nuestra base de datos: tibble. Tidydata: un multiverso de datos limpios</strong></span></p>
</section>
<section id="r-base-vs-tidyverse" class="slide level2">
<h2>R base vs Tidyverse</h2>
<p>Si conoces algún otro lenguaje de programación (o tienes gente cercana que programa) te extrañará que no vayamos a usar conceptos habituales como</p>
<ul>
<li><p><span class="hl-yellow"><strong>Bucles for</strong></span>: repetir un código un número fijo de iteraciones.</p></li>
<li><p><span class="hl-yellow"><strong>Bucles while</strong></span>: repetir un código hasta que se cumpla una condición</p></li>
<li><p><span class="hl-yellow"><strong>Estructuras if-else</strong></span>: estructuras de control para decidir por donde camina el código en función del valor de las variables.</p></li>
</ul>
<div class="fragment">
<p>Y es que con tidyverse, en la <span class="hl-red"><strong>mayoría de ocasiones vamos a poder evitarlas</strong></span> (en especial los bucles)</p>
</div>
</section>
<section id="qué-es-tidyverse" class="slide level2">
<h2>¿Qué es tidyverse?</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/tidyverrse_universe.jpg"></p>
</div><div class="column" style="width:50%;">
<p><img data-src="img/flow_tidyverse.jpg"></p>
</div>
</div>
<p><code>{tidyverse}</code> es un <span class="hl-yellow"><strong>«universo» de paquetes</strong></span> para garanatizar un flujo de trabajo (de inicio a fin) eficiente, coherente y lexicográficamente sencillo de entender, basado en la idea de que <span class="hl-purple"><strong>nuestros datos están limpios y ordenados (tidy)</strong></span></p>
</section>
<section id="qué-es-tidyverse-1" class="slide level2">
<h2>¿Qué es tidyverse?</h2>
<div class="columns">
<div class="column" style="width:45%;">
<p><img data-src="img/tidyverrse_universe.jpg"></p>
</div><div class="column" style="width:55%;">
<ul>
<li><code>{tibble}</code>: optimizando data.frame</li>
<li><code>{tidyr}</code>: limpieza de datos</li>
<li><code>{readr}</code>: carga datos rectangulares (.csv)</li>
<li><code>{dplyr}</code>: gramática para depurar</li>
<li><code>{stringr}</code>: manejo de textos</li>
<li><code>{ggplot2}</code>: visualización de datos</li>
<li><code>{tidymodels}</code>: modelización/predicción</li>
</ul>
</div>
</div>
<p>También tenemos los paquetes <code>{purrr}</code> para el manejo de listas, <code>{forcast}</code> para cualitativas, <code>{lubridate}</code> para fechas, <code>{readxl}</code> para importar archivos .xls y .xlsx, <code>{rvest}</code> para web scraping y <code>{rmarkdown}</code> para comunicar resultados.</p>
</section>
<section id="qué-es-tidyverse-2" class="slide level2">
<h2>¿Qué es tidyverse?</h2>
<div class="columns">
<div class="column" style="width:45%;">
<p><img data-src="img/tidyverrse_universe.jpg"></p>
</div><div class="column" style="width:55%;">
<ul>
<li><code>{tibble}</code>: <span class="hl-yellow"><strong>optimizando data.frame</strong></span></li>
<li><code>{tidyr}</code>: <span class="hl-yellow"><strong>limpieza de datos</strong></span></li>
<li><code>{readr}</code>: carga datos rectangulares (.csv)</li>
<li><code>{dplyr}</code>: gramática para depurar</li>
<li><code>{stringr}</code>: manejo de textos</li>
<li><code>{ggplot2}</code>: visualización de datos</li>
<li><code>{tidymodels}</code>: modelización/predicción</li>
</ul>
</div>
</div>
<p>También tenemos los paquetes <code>{purrr}</code> para el manejo de listas, <code>{forcast}</code> para cualitativas, <code>{lubridate}</code> para fechas, <code>{readxl}</code> para importar archivos .xls y .xlsx, <code>{rvest}</code> para web scraping y <code>{rmarkdown}</code> para comunicar resultados.</p>
</section>
<section id="filosofía-base-tidy-data" class="slide level2">
<h2>Filosofía base: tidy data</h2>
<blockquote>
<p>Tidy datasets are all alike, but every messy dataset is messy in its own way (Hadley Wickham, Chief Scientist en RStudio)</p>
</blockquote>
<div style="font-size:120px; text-align: center; color:#F8DF58;">
<p><b>TIDY</b><b><span style="color:#CAB0EE;">VERSE</span></b></p>
</div>
<p>El <span class="hl-purple"><strong>universo</strong></span> de paquetes <code>{tidyverse}</code> se basa en la idea introducido por <strong>Hadley Wickham</strong> (el Dios al que rezo) de <span class="hl-yellow"><strong>estandarizar</strong></span> el formato los datos para</p>
<div>
<ul>
<li class="fragment"><span class="hl-green"><strong>sistematizar</strong></span> la depuración</li>
<li class="fragment">hacer más <span class="hl-green"><strong>sencillo</strong></span> su manipulación.</li>
<li class="fragment">código <span class="hl-green"><strong>legible</strong></span></li>
</ul>
</div>
</section>
<section id="reglas-del-tidy-data" class="slide level2">
<h2>Reglas del tidy data</h2>
<p>Lo primero por tanto será entender qué son los <span class="hl-yellow"><strong>conjuntos tidydata</strong></span> ya que todo <code>{tidyverse}</code> se basa en que los datos están estandarizados.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="fragment fade-in">
<ol type="1">
<li>Cada <span class="hl-yellow"><strong>variable</strong></span> en una <span class="hl-purple"><strong>única columna</strong></span></li>
</ol>
</div>
<div class="fragment fade-in">
<ol start="2" type="1">
<li>Cada <span class="hl-yellow"><strong>individuo</strong></span> en una <span class="hl-purple"><strong>fila diferente</strong></span></li>
</ol>
</div>
<div class="fragment fade-in">
<ol start="3" type="1">
<li>Cada <span class="hl-yellow"><strong>celda</strong></span> con un <span class="hl-purple"><strong>único valor</strong></span></li>
</ol>
</div>
<div class="fragment fade-in">
<ol start="4" type="1">
<li>Cada <span class="hl-yellow"><strong>dataset</strong></span> en un <span class="hl-purple"><strong>tibble</strong></span></li>
</ol>
</div>
<div class="fragment fade-in">
<ol start="5" type="1">
<li>Si queremos cruzar <span class="hl-yellow"><strong>múltiples tablas</strong></span> debemos tener una <span class="hl-purple"><strong>columna común</strong></span></li>
</ol>
</div>
</div><div class="column" style="width:50%;">
<p><img data-src="img/tidy_def.jpg" style="width:160.0%"></p>
</div>
</div>
</section>
<section id="tubería-pipe" class="slide level2">
<h2>Tubería (pipe)</h2>
<p>En <code>{tidyverse}</code> será clave el <span class="hl-yellow"><strong>operador pipe (tubería)</strong></span> definido como <code>|&gt;</code> (<span class="hl-purple"><strong>ctrl+shift+M</strong></span>): será una <span class="hl-yellow"><strong>tubería que recorre los datos</strong></span> y los transforma.</p>
<div class="fragment">
<div class="columns">
<div class="column" style="width:50%;">
<p>En R base, si queremos aplicar tres funciones <code>first()</code>, <code>second()</code> y <code>third()</code> en orden, sería</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="fu">third</span>(<span class="fu">second</span>(<span class="fu">first</span>(datos)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<p>En <code>{tidyverse}</code> podremos <span class="hl-yellow"><strong>leer de izquierda a derecha</strong></span> y separar los datos de las acciones</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">first</span>() <span class="sc">|&gt;</span> <span class="fu">second</span>() <span class="sc">|&gt;</span> <span class="fu">third</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>&nbsp;</p>
</div>
<div class="fragment">
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Apunte importante</strong></p>
</div>
<div class="callout-content">
<p>Desde la versión 4.1.0 de <code>R</code> disponemos de <code>|&gt;</code>, un pipe <strong>nativo</strong> disponible <span class="hl-purple"><strong>fuera de tidyverse</strong></span>, sustituyendo al <span class="hl-red"><strong>antiguo pipe</strong></span> <code>%&gt;%</code> que dependía del paquete <code>{magrittr}</code> (bastante problemático).</p>
</div>
</div>
</div>
</div>
</section>
<section id="tubería-pipe-1" class="slide level2">
<h2>Tubería (pipe)</h2>
<p>La principal ventaja es que el <span class="hl-yellow"><strong>código sea muy legible (casi literal)</strong></span> pudiendo hacer grandes operaciones con los datos con apenas código.</p>
<p>&nbsp;</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb28-2"><a href="#cb28-2"></a>  <span class="fu">limpio</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb28-3"><a href="#cb28-3"></a>  <span class="fu">filtro</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb28-4"><a href="#cb28-4"></a>  <span class="fu">selecciono</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb28-5"><a href="#cb28-5"></a>  <span class="fu">ordeno</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb28-6"><a href="#cb28-6"></a>  <span class="fu">modifico</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb28-7"><a href="#cb28-7"></a>  <span class="fu">renombro</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb28-8"><a href="#cb28-8"></a>  <span class="fu">agrupo</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb28-9"><a href="#cb28-9"></a>  <span class="fu">cuento</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb28-10"><a href="#cb28-10"></a>  <span class="fu">resumo</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb28-11"><a href="#cb28-11"></a>  <span class="fu">pinto</span>(...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<center>
<img src="img/logo_pipe.png" width="360px">
</center>
</div>
</div>
</section>
<section id="datos-sucios-messy-data" class="slide level2">
<h2>Datos SUCIOS: messy data</h2>
<p>¿Pero qué aspecto tienen los <span class="hl-yellow"><strong>datos no tidy</strong></span>? Vamos a cargar la tabla <code>table4a</code> del paquete <code>{tidyr}</code> (ya lo tenemos cargado del entorno tidyverse).</p>
<p>&nbsp;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb29-2"><a href="#cb29-2"></a>table4a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  country     `1999` `2000`
  &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;
1 Afghanistan    745   2666
2 Brazil       37737  80488
3 China       212258 213766</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p><span class="hl-red"><strong>¿Qué puede estar fallando?</strong></span></p>
</section>
<section id="pivotar-pivot_longer" class="slide level2">
<h2>Pivotar: pivot_longer()</h2>
<div class="columns">
<div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>table4a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  country     `1999` `2000`
  &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;
1 Afghanistan    745   2666
2 Brazil       37737  80488
3 China       212258 213766</code></pre>
</div>
</div>
</div><div class="column" style="width:60%;">
<p>❎ Cada <span class="hl-red"><strong>fila representa dos observaciones</strong></span> (1999 y 2000) → las columnas <code>1999</code> y <code>2000</code> en realidad deberían ser en sí <span class="hl-yellow"><strong>valores de una variable</strong></span> y no nombres de columnas.</p>
</div>
</div>
<div class="fragment">
<p>Incluiremos una <span class="hl-yellow"><strong>nueva columna</strong></span> que nos guarde el año y otra que guarde el valor de la variable de interés en cada uno de esos años. Y lo haremos con la función <code>pivot_longer()</code>: <span class="hl-yellow"><strong>pivotaremos la tabla</strong></span> a formato long:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>table4a <span class="sc">|&gt;</span> </span>
<span id="cb33-2"><a href="#cb33-2"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"1999"</span>, <span class="st">"2000"</span>), <span class="at">names_to =</span> <span class="st">"year"</span>, <span class="at">values_to =</span> <span class="st">"cases"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  country     year   cases
  &lt;chr&gt;       &lt;chr&gt;  &lt;dbl&gt;
1 Afghanistan 1999     745
2 Afghanistan 2000    2666
3 Brazil      1999   37737
4 Brazil      2000   80488
5 China       1999  212258
6 China       2000  213766</code></pre>
</div>
</div>
</div>
</section>
<section id="pivotar-pivot_longer-1" class="slide level2">
<h2>Pivotar: pivot_longer()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>table4a <span class="sc">|&gt;</span> </span>
<span id="cb35-2"><a href="#cb35-2"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"1999"</span>, <span class="st">"2000"</span>),</span>
<span id="cb35-3"><a href="#cb35-3"></a>               <span class="at">names_to =</span> <span class="st">"year"</span>,</span>
<span id="cb35-4"><a href="#cb35-4"></a>               <span class="at">values_to =</span> <span class="st">"cases"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  country     year   cases
  &lt;chr&gt;       &lt;chr&gt;  &lt;dbl&gt;
1 Afghanistan 1999     745
2 Afghanistan 2000    2666
3 Brazil      1999   37737
4 Brazil      2000   80488
5 China       1999  212258
6 China       2000  213766</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><img data-src="img/table4a.jpg"></p>
</div>
</div>
<p>&nbsp;</p>
<ul>
<li><code>cols</code>: <span class="hl-yellow"><strong>nombre de las variables a pivotar</strong></span></li>
<li><code>names_to</code>: nombre de la nueva variable a la quemandamos la <span class="hl-yellow"><strong>cabecera</strong></span> de la tabla (los nombres).</li>
<li><code>values_to</code>: nombre de la nueva variable a la que vamos a mandar los <span class="hl-yellow"><strong>datos</strong></span>.</li>
</ul>
</section>
<section id="datos-sucios-messy-data-1" class="slide level2">
<h2>Datos SUCIOS: messy data</h2>
<p>Veamos otro ejemplo con la tabla <code>table2</code></p>
<p>&nbsp;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>table2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 4
   country      year type            count
   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt;
 1 Afghanistan  1999 cases             745
 2 Afghanistan  1999 population   19987071
 3 Afghanistan  2000 cases            2666
 4 Afghanistan  2000 population   20595360
 5 Brazil       1999 cases           37737
 6 Brazil       1999 population  172006362
 7 Brazil       2000 cases           80488
 8 Brazil       2000 population  174504898
 9 China        1999 cases          212258
10 China        1999 population 1272915272
11 China        2000 cases          213766
12 China        2000 population 1280428583</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p><span class="hl-red"><strong>¿Qué puede estar fallando?</strong></span></p>
</section>
<section id="pivotar-pivot_wider" class="slide level2">
<h2>Pivotar: pivot_wider()</h2>
<div class="columns">
<div class="column" style="width:60%;">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 4
   country      year type            count
   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt;
 1 Afghanistan  1999 cases             745
 2 Afghanistan  1999 population   19987071
 3 Afghanistan  2000 cases            2666
 4 Afghanistan  2000 population   20595360
 5 Brazil       1999 cases           37737
 6 Brazil       1999 population  172006362
 7 Brazil       2000 cases           80488
 8 Brazil       2000 population  174504898
 9 China        1999 cases          212258
10 China        1999 population 1272915272
11 China        2000 cases          213766
12 China        2000 population 1280428583</code></pre>
</div>
</div>
</div><div class="column" style="width:40%;">
<p>❎ Cada <span class="hl-red"><strong>observación está dividido en dos filas</strong></span> → los <span class="hl-yellow"><strong>registros con el mismo año deberían ser el mismo</strong></span></p>
</div>
</div>
<div class="fragment">
<p>Lo que haremos será lo opuesto: con <code>pivot_wider()</code> <span class="hl-yellow"><strong>ensancharemos la tabla</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>table2 <span class="sc">|&gt;</span>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> type, <span class="at">values_from =</span> count)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  country      year  cases population
  &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;
1 Afghanistan  1999    745   19987071
2 Afghanistan  2000   2666   20595360
3 Brazil       1999  37737  172006362
4 Brazil       2000  80488  174504898
5 China        1999 212258 1272915272
6 China        2000 213766 1280428583</code></pre>
</div>
</div>
</div>
</section>
<section id="datos-sucios-messy-data-2" class="slide level2">
<h2>Datos SUCIOS: messy data</h2>
<p>Veamos otro ejemplo con la tabla <code>table3</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>table3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  country      year rate             
  &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;            
1 Afghanistan  1999 745/19987071     
2 Afghanistan  2000 2666/20595360    
3 Brazil       1999 37737/172006362  
4 Brazil       2000 80488/174504898  
5 China        1999 212258/1272915272
6 China        2000 213766/1280428583</code></pre>
</div>
</div>
<p><span class="hl-red"><strong>¿Qué puede estar fallando?</strong></span></p>
</section>
<section id="separar-separate" class="slide level2">
<h2>Separar: separate()</h2>
<div class="columns">
<div class="column" style="width:60%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>table3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  country      year rate             
  &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;            
1 Afghanistan  1999 745/19987071     
2 Afghanistan  2000 2666/20595360    
3 Brazil       1999 37737/172006362  
4 Brazil       2000 80488/174504898  
5 China        1999 212258/1272915272
6 China        2000 213766/1280428583</code></pre>
</div>
</div>
</div><div class="column" style="width:40%;">
<p>❎ Cada <span class="hl-red"><strong>celda contiene varios valores</strong></span></p>
</div>
</div>
<div class="fragment">
<p>Lo que haremos será hacer uso de la función <code>separate()</code> para mandar <span class="hl-yellow"><strong>separar cada valor</strong></span> a una columna diferente.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>table3 <span class="sc">|&gt;</span> <span class="fu">separate</span>(rate, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"cases"</span>, <span class="st">"pop"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  country      year cases  pop       
  &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;     
1 Afghanistan  1999 745    19987071  
2 Afghanistan  2000 2666   20595360  
3 Brazil       1999 37737  172006362 
4 Brazil       2000 80488  174504898 
5 China        1999 212258 1272915272
6 China        2000 213766 1280428583</code></pre>
</div>
</div>
</div>
</section>
<section id="separar-separate-1" class="slide level2">
<h2>Separar: separate()</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>table3 <span class="sc">|&gt;</span> <span class="fu">separate</span>(rate, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"cases"</span>, <span class="st">"pop"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  country      year cases  pop       
  &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;     
1 Afghanistan  1999 745    19987071  
2 Afghanistan  2000 2666   20595360  
3 Brazil       1999 37737  172006362 
4 Brazil       2000 80488  174504898 
5 China        1999 212258 1272915272
6 China        2000 213766 1280428583</code></pre>
</div>
</div>
<p>Fíjate que los datos, aunque los ha separado, <span class="hl-red"><strong>los ha mantenido como texto</strong></span> cuando en realidad deberían ser variables numéricas. Para ello podemos añadir el argumento opcional <code>convert = TRUE</code></p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>table3 <span class="sc">|&gt;</span> <span class="fu">separate</span>(rate, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"cases"</span>, <span class="st">"pop"</span>), <span class="at">convert =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  country      year  cases        pop
  &lt;chr&gt;       &lt;dbl&gt;  &lt;int&gt;      &lt;int&gt;
1 Afghanistan  1999    745   19987071
2 Afghanistan  2000   2666   20595360
3 Brazil       1999  37737  172006362
4 Brazil       2000  80488  174504898
5 China        1999 212258 1272915272
6 China        2000 213766 1280428583</code></pre>
</div>
</div>
</div>
</section>
<section id="datos-sucios-messy-data-3" class="slide level2">
<h2>Datos SUCIOS: messy data</h2>
<p>Veamos el último ejemplo con la tabla <code>table5</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>table5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  country     century year  rate             
  &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;            
1 Afghanistan 19      99    745/19987071     
2 Afghanistan 20      00    2666/20595360    
3 Brazil      19      99    37737/172006362  
4 Brazil      20      00    80488/174504898  
5 China       19      99    212258/1272915272
6 China       20      00    213766/1280428583</code></pre>
</div>
</div>
<p><span class="hl-red"><strong>¿Qué puede estar fallando?</strong></span></p>
</section>
<section id="unir-unite" class="slide level2">
<h2>Unir unite()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a>table5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  country     century year  rate             
  &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;            
1 Afghanistan 19      99    745/19987071     
2 Afghanistan 20      00    2666/20595360    
3 Brazil      19      99    37737/172006362  
4 Brazil      20      00    80488/174504898  
5 China       19      99    212258/1272915272
6 China       20      00    213766/1280428583</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>❎ Tenemos <span class="hl-red"><strong>mismos valores divididos en dos columnas</strong></span></p>
</div>
</div>
<div class="fragment">
<p>Usaremos <code>unite()</code> para <span class="hl-yellow"><strong>unir los valores</strong></span> de siglo y año en una misma columna</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a>table5 <span class="sc">|&gt;</span> <span class="fu">unite</span>(<span class="at">col =</span> year_completo, century, year, <span class="at">sep =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  country     year_completo rate             
  &lt;chr&gt;       &lt;chr&gt;         &lt;chr&gt;            
1 Afghanistan 1999          745/19987071     
2 Afghanistan 2000          2666/20595360    
3 Brazil      1999          37737/172006362  
4 Brazil      2000          80488/174504898  
5 China       1999          212258/1272915272
6 China       2000          213766/1280428583</code></pre>
</div>
</div>
</div>
</section>
<section id="tu-turno-6" class="slide level2">
<h2>💻 Tu turno</h2>
<p><span style="color:#444442;"><strong>Intenta realizar los siguientes ejercicios sin mirar las soluciones</strong></span></p>
<div class="panel-tabset">
<ul id="tabset-1" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-1-1"><span class="hl-yellow"><strong>Ejercicio 1</strong></span></a></li><li><a href="#tabset-1-2"><span class="hl-yellow"><strong>Ejercicio 2</strong></span></a></li><li><a href="#tabset-1-3"><span class="hl-yellow"><strong>Ejercicio 3</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-1-1">
<p>📝 Echa un vistazo a la tabla <code>table4b</code> del paquete <code>{tidyr}</code>. ¿Es tidydata? En caso negativo, ¿qué falla? ¿Cómo convertirla a tidy data en caso de que no lo sea ya?</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a>table4b <span class="sc">|&gt;</span></span>
<span id="cb58-2"><a href="#cb58-2"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="st">"1999"</span><span class="sc">:</span><span class="st">"2000"</span>, <span class="at">names_to =</span> <span class="st">"year"</span>,</span>
<span id="cb58-3"><a href="#cb58-3"></a>               <span class="at">values_to =</span> <span class="st">"cases"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-2">
<p>📝 Echa un vistazo a la tabla <code>relig_income</code> del paquete <code>{tidyr}</code>. ¿Es tidydata? En caso negativo, ¿qué falla? ¿Cómo convertirla a tidy data en caso de que no lo sea ya?</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a>relig_income <span class="sc">|&gt;</span></span>
<span id="cb59-2"><a href="#cb59-2"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="st">"&lt;$10k"</span><span class="sc">:</span><span class="st">"Don't know/refused"</span>,</span>
<span id="cb59-3"><a href="#cb59-3"></a>               <span class="at">names_to =</span> <span class="st">"income"</span>,</span>
<span id="cb59-4"><a href="#cb59-4"></a>               <span class="at">values_to =</span> <span class="st">"people"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-3">
<p>📝 Echa un vistazo a la tabla <code>billboard</code> del paquete <code>{tidyr}</code>. ¿Es tidydata? En caso negativo, ¿qué falla? ¿Cómo convertirla a tidy data en caso de que no lo sea ya?</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a>billboard <span class="sc">|&gt;</span></span>
<span id="cb60-2"><a href="#cb60-2"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="st">"wk1"</span><span class="sc">:</span><span class="st">"wk76"</span>,</span>
<span id="cb60-3"><a href="#cb60-3"></a>               <span class="at">names_to =</span> <span class="st">"week"</span>,</span>
<span id="cb60-4"><a href="#cb60-4"></a>               <span class="at">names_prefix =</span> <span class="st">"wk"</span>,</span>
<span id="cb60-5"><a href="#cb60-5"></a>               <span class="at">values_to =</span> <span class="st">"position"</span>,</span>
<span id="cb60-6"><a href="#cb60-6"></a>               <span class="at">values_drop_na =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="filas-tidyverse" class="title-slide slide level1 center">
<h1>Operaciones con filas</h1>
<p><span style="color:#444442;"><strong>Operaciones con filas en tidyverse</strong></span></p>
</section>
<section id="qué-es-tidyverse-3" class="slide level2">
<h2>¿Qué es tidyverse?</h2>
<div class="columns">
<div class="column" style="width:45%;">
<p><img data-src="img/tidyverrse_universe.jpg"></p>
</div><div class="column" style="width:55%;">
<ul>
<li><code>{tibble}</code>: <span class="hl-yellow"><strong>optimizando data.frame</strong></span></li>
<li><code>{tidyr}</code>: limpieza de datos</li>
<li><code>{readr}</code>: carga datos rectangulares (.csv)</li>
<li><code>{dplyr}</code>: <span class="hl-yellow"><strong>gramática para depurar</strong></span></li>
<li><code>{stringr}</code>: manejo de textos</li>
<li><code>{ggplot2}</code>: visualización de datos</li>
<li><code>{tidymodels}</code>: modelización/predicción</li>
</ul>
</div>
</div>
<p>También tenemos los paquetes <code>{purrr}</code> para el manejo de listas, <code>{forcast}</code> para cualitativas, <code>{lubridate}</code> para fechas, <code>{readxl}</code> para importar archivos .xls y .xlsx, <code>{rvest}</code> para web scraping y <code>{rmarkdown}</code> para comunicar resultados.</p>
</section>
<section id="preprocesamiento-dplyr" class="slide level2">
<h2>Preprocesamiento: dplyr</h2>
<p>Dentro de <code>{tidyverse}</code> usaremos el paquete <code>{dplyr}</code> para el <span class="hl-yellow"><strong>preprocesamiento y depuración</strong></span> de datos de datos.</p>
<div class="columns">
<div class="column" style="width:60%;">
<p><img data-src="img/dplyr.png" width="450"></p>
</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb61-2"><a href="#cb61-2"></a>  <span class="fu">limpio</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb61-3"><a href="#cb61-3"></a>  <span class="fu">filtro</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb61-4"><a href="#cb61-4"></a>  <span class="fu">selecciono</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb61-5"><a href="#cb61-5"></a>  <span class="fu">ordeno</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb61-6"><a href="#cb61-6"></a>  <span class="fu">modifico</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb61-7"><a href="#cb61-7"></a>  <span class="fu">renombro</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb61-8"><a href="#cb61-8"></a>  <span class="fu">agrupo</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb61-9"><a href="#cb61-9"></a>  <span class="fu">cuento</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb61-10"><a href="#cb61-10"></a>  <span class="fu">resumo</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb61-11"><a href="#cb61-11"></a>  <span class="fu">pinto</span>(...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>La idea es que el <span class="hl-yellow"><strong>código sea legible</strong></span>, como si fuese una lista de instrucciones que al leerla nos diga de manera muy evidente lo que está haciendo.</p>
</section>
<section id="hipótesis-tidydata" class="slide level2">
<h2>Hipótesis: tidydata</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>Toda la depuración que vamos a realizar es sobre la <span class="hl-yellow"><strong>hipótesis de que nuestros datos están en tidydata</strong></span></p>
</div><div class="column" style="width:50%;">
<p><img data-src="img/tidy_def.jpg" style="width:160.0%"></p>
</div>
</div>
<p>Recuerda que en <code>{tidyverse}</code> será clave el <span class="hl-yellow"><strong>operador pipe (tubería)</strong></span> definido como <code>|&gt;</code> (<span class="hl-purple"><strong>ctrl+shift+M</strong></span>): será una <span class="hl-yellow"><strong>tubería que recorre los datos</strong></span> y los transforma.</p>
<div class="fragment">
<p>Vamos a practicar con el dataset <code>starwars</code> del paquete cargado <code>{dplyr}</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb62-2"><a href="#cb62-2"></a>starwars</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="filtrar-filas-filter" class="slide level2">
<h2>Filtrar filas: filter()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb63-2"><a href="#cb63-2"></a>  <span class="fu">filtro</span>(condicion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb64-2"><a href="#cb64-2"></a>  <span class="fu">filter</span>(condicion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>El más simple es cuando <span class="hl-yellow"><strong>filtramos registros</strong></span> en base a alguna condición lógica: con <code>filter()</code> se seleccionarán solo individuos que cumplan ciertas condiciones (muestreo no aleatorio por condiciones)</p>
<div>
<ul>
<li class="fragment"><code>==</code>, <code>!=</code>: <span class="hl-purple"><strong>igual</strong></span> o <span class="hl-yellow"><strong>distinto</strong></span> que (<code>|&gt; filter(variable == "a")</code>)</li>
<li class="fragment"><code>&gt;</code>, <code>&lt;</code>: <span class="hl-purple"><strong>mayor</strong></span> o <span class="hl-yellow"><strong>menor</strong></span> que (<code>|&gt; filter(variable &lt; 3)</code>)</li>
<li class="fragment"><code>&gt;=</code>, <code>&lt;=</code>: <span class="hl-yellow"><strong>mayor o igual</strong></span> o <span class="hl-purple"><strong>menor o igual</strong></span> que (<code>|&gt; filter(variable &gt;= 5)</code>)</li>
<li class="fragment"><code>%in%</code>: valores <span class="hl-yellow"><strong>pertenencen</strong></span> a un listado de opciones (<code>|&gt; filter(variable %in% c("azul", "verde"))</code>)</li>
<li class="fragment"><code>between(variable, val1, val2)</code>: si los valores (continuos) <span class="hl-yellow"><strong>caen dentro de un rango</strong></span> de valores (<code>|&gt; filter(between(variable, 160, 180))</code>)</li>
</ul>
</div>
</section>
<section id="filtrar-filas-filter-1" class="slide level2">
<h2>Filtrar filas: filter()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb65-2"><a href="#cb65-2"></a>  <span class="fu">filtro</span>(condicion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb66-2"><a href="#cb66-2"></a>  <span class="fu">filter</span>(condicion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>¿Cómo harías para… <span class="hl-yellow"><strong>filtrar</strong></span> los personajes de <span class="hl-purple"><strong>ojos marrones</strong></span>?</p>
<div class="fragment">
<p><span class="hl-yellow"><strong>¿Qué tipo de variable es?</strong></span> –&gt; La variable <code>eye_color</code> es cualitativa así que está representada por textos</p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb67-2"><a href="#cb67-2"></a>  <span class="fu">filter</span>(eye_color <span class="sc">==</span> <span class="st">"brown"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 21 × 14
   name     height  mass hair_color skin_color eye_color birth_year sex   gender
   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
 1 Leia Or…    150  49   brown      light      brown           19   fema… femin…
 2 Biggs D…    183  84   black      light      brown           24   male  mascu…
 3 Han Solo    180  80   brown      fair       brown           29   male  mascu…
 4 Yoda         66  17   white      green      brown          896   male  mascu…
 5 Boba Fe…    183  78.2 black      fair       brown           31.5 male  mascu…
 6 Lando C…    177  79   black      dark       brown           31   male  mascu…
 7 Arvel C…     NA  NA   brown      fair       brown           NA   male  mascu…
 8 Wicket …     88  20   brown      brown      brown            8   male  mascu…
 9 Quarsh …    183  NA   black      dark       brown           62   &lt;NA&gt;  &lt;NA&gt;  
10 Shmi Sk…    163  NA   black      fair       brown           72   fema… femin…
# ℹ 11 more rows
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="filtrar-filas-filter-2" class="slide level2">
<h2>Filtrar filas: filter()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb69-2"><a href="#cb69-2"></a>  <span class="fu">filtro</span>(condicion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb70-2"><a href="#cb70-2"></a>  <span class="fu">filter</span>(condicion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>¿Cómo harías para… <span class="hl-yellow"><strong>filtrar</strong></span> los personajes que <span class="hl-purple"><strong>no tienen ojos marrones</strong></span>?</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb71-2"><a href="#cb71-2"></a>  <span class="fu">filter</span>(eye_color <span class="sc">!=</span> <span class="st">"brown"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 66 × 14
   name     height  mass hair_color skin_color eye_color birth_year sex   gender
   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
 1 Luke Sk…    172    77 blond      fair       blue            19   male  mascu…
 2 C-3PO       167    75 &lt;NA&gt;       gold       yellow         112   none  mascu…
 3 R2-D2        96    32 &lt;NA&gt;       white, bl… red             33   none  mascu…
 4 Darth V…    202   136 none       white      yellow          41.9 male  mascu…
 5 Owen La…    178   120 brown, gr… light      blue            52   male  mascu…
 6 Beru Wh…    165    75 brown      light      blue            47   fema… femin…
 7 R5-D4        97    32 &lt;NA&gt;       white, red red             NA   none  mascu…
 8 Obi-Wan…    182    77 auburn, w… fair       blue-gray       57   male  mascu…
 9 Anakin …    188    84 blond      fair       blue            41.9 male  mascu…
10 Wilhuff…    180    NA auburn, g… fair       blue            64   male  mascu…
# ℹ 56 more rows
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="filtrar-filas-filter-3" class="slide level2">
<h2>Filtrar filas: filter()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb73-2"><a href="#cb73-2"></a>  <span class="fu">filtro</span>(condicion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb74-2"><a href="#cb74-2"></a>  <span class="fu">filter</span>(condicion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>¿Cómo harías para … <span class="hl-yellow"><strong>filtrar</strong></span> los personajes que <span class="hl-purple"><strong>tengan los ojos marrones o azules</strong></span>?</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb75-2"><a href="#cb75-2"></a>  <span class="fu">filter</span>(eye_color <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"brown"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 40 × 14
   name     height  mass hair_color skin_color eye_color birth_year sex   gender
   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
 1 Luke Sk…    172    77 blond      fair       blue            19   male  mascu…
 2 Leia Or…    150    49 brown      light      brown           19   fema… femin…
 3 Owen La…    178   120 brown, gr… light      blue            52   male  mascu…
 4 Beru Wh…    165    75 brown      light      blue            47   fema… femin…
 5 Biggs D…    183    84 black      light      brown           24   male  mascu…
 6 Anakin …    188    84 blond      fair       blue            41.9 male  mascu…
 7 Wilhuff…    180    NA auburn, g… fair       blue            64   male  mascu…
 8 Chewbac…    228   112 brown      unknown    blue           200   male  mascu…
 9 Han Solo    180    80 brown      fair       brown           29   male  mascu…
10 Jek Ton…    180   110 brown      fair       blue            NA   male  mascu…
# ℹ 30 more rows
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="filtrar-filas-filter-4" class="slide level2">
<h2>Filtrar filas: filter()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb77-2"><a href="#cb77-2"></a>  <span class="fu">filtro</span>(condicion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb78-2"><a href="#cb78-2"></a>  <span class="fu">filter</span>(condicion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Fíjate que <code>%in%</code> es equivalente a concatenar varios <code>==</code> con una conjunción o (<code>|</code>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb79-2"><a href="#cb79-2"></a>  <span class="fu">filter</span>(eye_color <span class="sc">==</span> <span class="st">"blue"</span> <span class="sc">|</span> eye_color <span class="sc">==</span> <span class="st">"brown"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 40 × 14
   name     height  mass hair_color skin_color eye_color birth_year sex   gender
   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
 1 Luke Sk…    172    77 blond      fair       blue            19   male  mascu…
 2 Leia Or…    150    49 brown      light      brown           19   fema… femin…
 3 Owen La…    178   120 brown, gr… light      blue            52   male  mascu…
 4 Beru Wh…    165    75 brown      light      blue            47   fema… femin…
 5 Biggs D…    183    84 black      light      brown           24   male  mascu…
 6 Anakin …    188    84 blond      fair       blue            41.9 male  mascu…
 7 Wilhuff…    180    NA auburn, g… fair       blue            64   male  mascu…
 8 Chewbac…    228   112 brown      unknown    blue           200   male  mascu…
 9 Han Solo    180    80 brown      fair       brown           29   male  mascu…
10 Jek Ton…    180   110 brown      fair       blue            NA   male  mascu…
# ℹ 30 more rows
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</section>
<section id="filtrar-filas-filter-5" class="slide level2">
<h2>Filtrar filas: filter()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb81-2"><a href="#cb81-2"></a>  <span class="fu">filtro</span>(condicion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb82-2"><a href="#cb82-2"></a>  <span class="fu">filter</span>(condicion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>¿Cómo harías para … <span class="hl-yellow"><strong>filtrar</strong></span> los personajes que <span class="hl-purple"><strong>midan entre 120 y 160 cm</strong></span>?</p>
<div class="fragment">
<p><span class="hl-yellow"><strong>¿Qué tipo de variable es?</strong></span> –&gt; La variable <code>height</code> es cuantitativa continua así que deberemos filtrar por rangos de valores (intervalos) –&gt; usaremos <code>between()</code></p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb83-2"><a href="#cb83-2"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(height, <span class="dv">120</span>, <span class="dv">160</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 14
  name      height  mass hair_color skin_color eye_color birth_year sex   gender
  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
1 Leia Org…    150    49 brown      light      brown             19 fema… femin…
2 Mon Moth…    150    NA auburn     fair       blue              48 fema… femin…
3 Nien Nunb    160    68 none       grey       black             NA male  mascu…
4 Watto        137    NA black      blue, grey yellow            NA male  mascu…
5 Gasgano      122    NA none       white, bl… black             NA male  mascu…
6 Cordé        157    NA brown      light      brown             NA fema… femin…
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="filtrar-filas-filter-6" class="slide level2">
<h2>Filtrar filas: filter()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb85-2"><a href="#cb85-2"></a>  <span class="fu">filtro</span>(condicion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb86-2"><a href="#cb86-2"></a>  <span class="fu">filter</span>(condicion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>¿Cómo harías… <span class="hl-yellow"><strong>filtrar</strong></span> los personajes que <span class="hl-purple"><strong>tengan ojos y no sean humanos</strong></span>?</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb87-2"><a href="#cb87-2"></a>  <span class="fu">filter</span>(eye_color <span class="sc">==</span> <span class="st">"brown"</span> <span class="sc">&amp;</span> species <span class="sc">!=</span> <span class="st">"Human"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 14
  name      height  mass hair_color skin_color eye_color birth_year sex   gender
  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
1 Yoda          66    17 white      green      brown            896 male  mascu…
2 Wicket S…     88    20 brown      brown      brown              8 male  mascu…
3 Eeth Koth    171    NA black      brown      brown             NA male  mascu…
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="eliminar-ausentes-drop_na" class="slide level2">
<h2>Eliminar ausentes: drop_na()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb89-2"><a href="#cb89-2"></a>  <span class="fu">retirar_ausentes</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb90-2"><a href="#cb90-2"></a>  <span class="fu">drop_na</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Hay un filtro especial para una de las operaciones más habituales en depuración: <span class="hl-yellow"><strong>retirar los ausentes</strong></span>. Para ello podemos usar dentro de un filtro <code>is.na()</code>, que nos devuelve <code>TRUE/FALSE</code> en función de si es ausente, o bien …</p>
<div class="fragment">
<p>Usar <code>drop_na()</code>: si no indicamos variable, elimina registros con ausente en cualquier variable. Más adelante veremos como <span class="hl-yellow"><strong>imputar esos ausentes</strong></span></p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb91-2"><a href="#cb91-2"></a>  <span class="fu">drop_na</span>(mass, height)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 4
  name                mass height hair_color 
  &lt;chr&gt;              &lt;dbl&gt;  &lt;int&gt; &lt;chr&gt;      
1 Luke Skywalker        77    172 blond      
2 C-3PO                 75    167 &lt;NA&gt;       
3 R2-D2                 32     96 &lt;NA&gt;       
4 Darth Vader          136    202 none       
5 Leia Organa           49    150 brown      
6 Owen Lars            120    178 brown, grey
7 Beru Whitesun lars    75    165 brown      </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb93-2"><a href="#cb93-2"></a>  <span class="fu">drop_na</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 4
  name                mass height hair_color   
  &lt;chr&gt;              &lt;dbl&gt;  &lt;int&gt; &lt;chr&gt;        
1 Luke Skywalker        77    172 blond        
2 Darth Vader          136    202 none         
3 Leia Organa           49    150 brown        
4 Owen Lars            120    178 brown, grey  
5 Beru Whitesun lars    75    165 brown        
6 Biggs Darklighter     84    183 black        
7 Obi-Wan Kenobi        77    182 auburn, white</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="tu-turno-9a" class="slide level2">
<h2>💻 Tu turno</h2>
<p><span style="color:#444442;"><strong>Intenta realizar los siguientes ejercicios sin mirar las soluciones</strong></span></p>
<div class="panel-tabset">
<ul id="tabset-2" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-2-1"><span class="hl-yellow"><strong>Ejercicio 1</strong></span></a></li><li><a href="#tabset-2-2"><span class="hl-yellow"><strong>Ejercicio 2</strong></span></a></li><li><a href="#tabset-2-3"><span class="hl-yellow"><strong>Ejercicio 3</strong></span></a></li><li><a href="#tabset-2-4"><span class="hl-yellow"><strong>Ejercicio 4</strong></span></a></li><li><a href="#tabset-2-5"><span class="hl-yellow"><strong>Ejercicio 5</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-2-1">
<p>📝 Selecciona del conjunto de starwars solo los personajes que sean androides o cuyo valor en <code>species</code> sea desconocido</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb95-2"><a href="#cb95-2"></a>  <span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">"Droid"</span> <span class="sc">|</span> <span class="fu">is.na</span>(species))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-2-2">
<p>📝 Selecciona del conjunto de starwars solo los personajes cuyo peso esté entre 65 y 90 kg.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="fu">between</span>(mass, <span class="dv">65</span>, <span class="dv">90</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-2-3">
<p>📝 Tras limpiar de ausentes en todas las variables, selecciona del conjunto de starwars solo los personajes que sean humanos y que vengan de Tatooine</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb97-2"><a href="#cb97-2"></a>  <span class="fu">drop_na</span>() <span class="sc">|&gt;</span> </span>
<span id="cb97-3"><a href="#cb97-3"></a>  <span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">"Human"</span> <span class="sc">&amp;</span> homeworld <span class="sc">==</span> <span class="st">"Tatooine"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-2-4">
<p>📝 Selecciona del conjunto original de starwars los personajes no humanos, <code>male</code> en el sexo y que midan entre 120 y 170 cm, o los personajes con ojos marrones o rojos.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb98-2"><a href="#cb98-2"></a>  <span class="fu">filter</span>((species <span class="sc">!=</span> <span class="st">"Human"</span> <span class="sc">&amp;</span> sex <span class="sc">==</span> <span class="st">"male"</span> <span class="sc">&amp;</span></span>
<span id="cb98-3"><a href="#cb98-3"></a>            <span class="fu">between</span>(height, <span class="dv">120</span>, <span class="dv">170</span>)) <span class="sc">|</span></span>
<span id="cb98-4"><a href="#cb98-4"></a>           eye_color <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"brown"</span>, <span class="st">"red"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-2-5">
<p>📝 Busca información en la ayuda de la función <code>str_detect()</code> del paquete <code>{stringr}</code> (cargado en <code>{tidyverse}</code>). Consejo: prueba antes las funciones que vayas a usar con algún vector de prueba para poder comprobar su funcionamiento. Tras saber lo que hace, filtra solo aquellos personajes con apellido <code>Skywalker</code></p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="fu">str_detect</span>(name, <span class="st">"Skywalker"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="rebanadas-de-datos-slice" class="slide level2">
<h2>Rebanadas de datos: slice()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">rebanadas</span>(posiciones)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">slice</span>(posiciones)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>A veces nos puede interesar realizar un <span class="hl-yellow"><strong>muestreo no aleatorio discreccional</strong></span>, o lo que es lo mismo, <span class="hl-yellow"><strong>filtrar por posición</strong></span>: con <code>slice(posiciones)</code> podremos seleccionar filas concretas pasando como argumento un <span class="hl-yellow"><strong>vector de índices</strong></span></p>
<div class="fragment">
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1"></a><span class="co"># fila 1</span></span>
<span id="cb102-2"><a href="#cb102-2"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb102-3"><a href="#cb102-3"></a>  <span class="fu">slice</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  name           height  mass hair_color
  &lt;chr&gt;           &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;     
1 Luke Skywalker    172    77 blond     </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1"></a><span class="co"># filas de la 7 a la 9</span></span>
<span id="cb104-2"><a href="#cb104-2"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb104-3"><a href="#cb104-3"></a>  <span class="fu">slice</span>(<span class="dv">7</span><span class="sc">:</span><span class="dv">9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  name               height  mass hair_color
  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;     
1 Beru Whitesun lars    165    75 brown     
2 R5-D4                  97    32 &lt;NA&gt;      
3 Biggs Darklighter     183    84 black     </code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1"></a><span class="co"># filas 2, 7, 10 y 31</span></span>
<span id="cb106-2"><a href="#cb106-2"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb106-3"><a href="#cb106-3"></a>  <span class="fu">slice</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">31</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 8
  name             height  mass hair_color skin_color eye_color birth_year sex  
  &lt;chr&gt;             &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;
1 C-3PO               167    75 &lt;NA&gt;       gold       yellow           112 none 
2 Beru Whitesun l…    165    75 brown      light      blue              47 fema…
3 Obi-Wan Kenobi      182    77 auburn, w… fair       blue-gray         57 male 
4 Qui-Gon Jinn        193    89 brown      fair       blue              92 male </code></pre>
</div>
</div>
</div>
</section>
<section id="rebanadas-de-datos-slice-1" class="slide level2">
<h2>Rebanadas de datos: slice()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb108-2"><a href="#cb108-2"></a>  <span class="fu">rebanadas</span>(posiciones)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb109-2"><a href="#cb109-2"></a>  <span class="fu">slice</span>(posiciones)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Disponemos de opciones por defecto:</p>
<ul>
<li>con <code>slice_head(n = ...)</code> y <code>slice_tail(n = ...)</code> podemos obtener la <span class="hl-yellow"><strong>cabecera y cola</strong></span> de la tabla</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  name           height  mass hair_color
  &lt;chr&gt;           &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;     
1 Luke Skywalker    172    77 blond     
2 C-3PO             167    75 &lt;NA&gt;      </code></pre>
</div>
</div>
</div><div class="column" style="width:&quot;50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">slice_tail</span>(<span class="at">n =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  name           height  mass hair_color
  &lt;chr&gt;           &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;     
1 Captain Phasma     NA    NA unknown   
2 Padmé Amidala     165    45 brown     </code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="rebanadas-de-datos-slice-2" class="slide level2">
<h2>Rebanadas de datos: slice()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb114-2"><a href="#cb114-2"></a>  <span class="fu">rebanadas</span>(posiciones)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb115-2"><a href="#cb115-2"></a>  <span class="fu">slice</span>(posiciones)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Disponemos de opciones por defecto:</p>
<ul>
<li>con <code>slice_max()</code> y <code>slice_min()</code> obtenemos la <span class="hl-yellow"><strong>filas con menor/mayor valor de una variable</strong></span> (si empate, todas salvo que <code>with_ties = FALSE</code>) que indicamos en <code>order_by = ...</code></li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">slice_min</span>(mass, <span class="at">n =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  name          height  mass hair_color
  &lt;chr&gt;          &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;     
1 Ratts Tyerell     79    15 none      
2 Yoda              66    17 white     </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">slice_max</span>(height, <span class="at">n =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  name        height  mass hair_color
  &lt;chr&gt;        &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;     
1 Yarael Poof    264    NA none      
2 Tarfful        234   136 brown     </code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="aleatorio-slice_sample" class="slide level2">
<h2>Aleatorio: slice_sample()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb120-2"><a href="#cb120-2"></a>  <span class="fu">rebanadas_aleatorias</span>(posiciones)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb121-2"><a href="#cb121-2"></a>  <span class="fu">slice_sample</span>(posiciones)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>El conocido como <span class="hl-yellow"><strong>muestreo aleatorio simple</strong></span> se basa en <span class="hl-yellow"><strong>seleccionar individuos aleatoriamente</strong></span>, de forma que cada uno tenga ciertas <span class="hl-yellow"><strong>probabilidades</strong></span> de ser seleccionado. Con <code>slice_sample(n = ...)</code> podemos extraer n registros aleatoriamente (a priori equiprobables).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 14
  name      height  mass hair_color skin_color eye_color birth_year sex   gender
  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
1 Mace Win…    188    84 none       dark       brown             72 male  mascu…
2 Cliegg L…    183    NA brown      fair       blue              82 male  mascu…
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</section>
<section id="aleatorio-slice_sample-1" class="slide level2">
<h2>Aleatorio: slice_sample()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb124-2"><a href="#cb124-2"></a>  <span class="fu">rebanadas_aleatorias</span>(posiciones)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb125-2"><a href="#cb125-2"></a>  <span class="fu">slice_sample</span>(posiciones)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>También podremos indicarle la <span class="hl-yellow"><strong>proporción de datos a samplear</strong></span> (en lugar del número) y si queremos que sea <span class="hl-yellow"><strong>con reemplazamiento (que se puedan repetir)</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1"></a><span class="co"># 5% de registros aleatorios con reemplazamiento</span></span>
<span id="cb126-2"><a href="#cb126-2"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb126-3"><a href="#cb126-3"></a>  <span class="fu">slice_sample</span>(<span class="at">prop =</span> <span class="fl">0.05</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 14
  name      height  mass hair_color skin_color eye_color birth_year sex   gender
  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
1 R5-D4         97    32 &lt;NA&gt;       white, red red               NA none  mascu…
2 Watto        137    NA black      blue, grey yellow            NA male  mascu…
3 Jabba De…    175  1358 &lt;NA&gt;       green-tan… orange           600 herm… mascu…
4 R5-D4         97    32 &lt;NA&gt;       white, red red               NA none  mascu…
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</section>
<section id="aleatorio-slice_sample-2" class="slide level2">
<h2>Aleatorio: slice_sample()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb128-2"><a href="#cb128-2"></a>  <span class="fu">rebanadas_aleatorias</span>(posiciones)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb129-2"><a href="#cb129-2"></a>  <span class="fu">slice_sample</span>(posiciones)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Como decíamos, «aleatorio» no es igual que «equiprobable», así que podemos pasarle un <span class="hl-yellow"><strong>vector de probabilidades</strong></span>. Por ejemplo, vamos a forzar que sea muy improbable sacar una fila que no sean las dos primeras</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb130-2"><a href="#cb130-2"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">2</span>, <span class="at">weight_by =</span> <span class="fu">c</span>(<span class="fl">0.495</span>, <span class="fl">0.495</span>, <span class="fu">rep</span>(<span class="fl">0.01</span><span class="sc">/</span><span class="dv">85</span>, <span class="dv">85</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 14
  name      height  mass hair_color skin_color eye_color birth_year sex   gender
  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
1 C-3PO        167    75 &lt;NA&gt;       gold       yellow           112 none  mascu…
2 Luke Sky…    172    77 blond      fair       blue              19 male  mascu…
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb132-2"><a href="#cb132-2"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">2</span>, <span class="at">weight_by =</span> <span class="fu">c</span>(<span class="fl">0.495</span>, <span class="fl">0.495</span>, <span class="fu">rep</span>(<span class="fl">0.01</span><span class="sc">/</span><span class="dv">85</span>, <span class="dv">85</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 14
  name      height  mass hair_color skin_color eye_color birth_year sex   gender
  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
1 Luke Sky…    172    77 blond      fair       blue              19 male  mascu…
2 C-3PO        167    75 &lt;NA&gt;       gold       yellow           112 none  mascu…
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="paréntesis-sample" class="slide level2">
<h2>Paréntesis: sample()</h2>
<p>La función <code>slice_sample()</code> es simplemente una integración de <code>{tidyverse}</code> de la función básica de <code>R</code> conocida como <code>sample()</code> que nos permite <span class="hl-yellow"><strong>muestrear elementos</strong></span></p>
<div class="fragment">
<p>Por ejemplo, vamos a <span class="hl-yellow"><strong>muestrear 10 tiradas de un dado</strong></span>, indicándole</p>
<ul>
<li><span class="hl-purple"><strong>soporte</strong></span> de nuestra variable aleatorio (valores permitidos en <code>x</code>)</li>
<li><span class="hl-purple"><strong>tamaño</strong></span> muestral (<code>size</code>)</li>
<li><span class="hl-purple"><strong>reemplazamiento</strong></span> (si <code>TRUE</code> entonces pueden salir repetidas, como en el caso del dado)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1"></a><span class="fu">sample</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 2 3 6 4 2 2 5 6 2</code></pre>
</div>
</div>
</div>
</section>
<section id="tu-turno-9b" class="slide level2">
<h2>💻 Tu turno</h2>
<p><span style="color:#444442;"><strong>Intenta realizar los siguientes ejercicios sin mirar las soluciones</strong></span></p>
<div class="panel-tabset">
<ul id="tabset-3" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-3-1"><span class="hl-yellow"><strong>Ejercicio 1</strong></span></a></li><li><a href="#tabset-3-2"><span class="hl-yellow"><strong>Ejercicio 2</strong></span></a></li><li><a href="#tabset-3-3"><span class="hl-yellow"><strong>Ejercicio 3</strong></span></a></li><li><a href="#tabset-3-4"><span class="hl-yellow"><strong>Ejercicio 4</strong></span></a></li><li><a href="#tabset-3-5"><span class="hl-yellow"><strong>Ejercicio 5</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-3-1">
<p>📝 Selecciona solo los personajes que sean humanos y de ojos marrones, para después ordernarlos en altura descendente y peso ascendente.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb136-2"><a href="#cb136-2"></a>  <span class="fu">filter</span>(eye_color <span class="sc">==</span> <span class="st">"brown"</span> <span class="sc">&amp;</span> species <span class="sc">==</span> <span class="st">"Human"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb136-3"><a href="#cb136-3"></a>  <span class="fu">arrange</span>(height, <span class="fu">desc</span>(mass))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-3-2">
<p>📝 Extrae 3 registros aleatoriamente.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-3-3">
<p>📝 Extrae el 10% de los registros aleatoriamente.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">slice_sample</span>(<span class="at">prop =</span> <span class="fl">0.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-3-4">
<p>📝 Extrae aleatoriamente 10 personajes pero de forma que la probabilidad de que salga cada uno sea proporcional a su peso (más pesados, más probable)</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb139-2"><a href="#cb139-2"></a>  <span class="fu">drop_na</span>(mass) <span class="sc">|&gt;</span> </span>
<span id="cb139-3"><a href="#cb139-3"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">weight_by =</span> mass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-3-5">
<p>📝 Selecciona los 3 personajes más mayores.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">slice_max</span>(birth_year, <span class="at">n =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="tidyverse-columnas" class="title-slide slide level1 center">
<h1>Operaciones con columnas</h1>
<p><span style="color:#444442;"><strong>Operaciones con columnas en tidyverse</strong></span></p>
</section>
<section id="reordenar-filas-arrange" class="slide level2">
<h2>Reordenar filas: arrange()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">ordenar</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">arrange</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>También podemos <span class="hl-yellow"><strong>ordenar filas</strong></span> en función de alguna variable con <code>arrange()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">arrange</span>(mass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 6
  name                  height  mass hair_color skin_color  eye_color
  &lt;chr&gt;                  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;    
1 Ratts Tyerell             79    15 none       grey, blue  unknown  
2 Yoda                      66    17 white      green       brown    
3 Wicket Systri Warrick     88    20 brown      brown       brown    
4 R2-D2                     96    32 &lt;NA&gt;       white, blue red      
5 R5-D4                     97    32 &lt;NA&gt;       white, red  red      </code></pre>
</div>
</div>
<div class="fragment">
<p>Por <span class="hl-yellow"><strong>defecto de menor a mayor</strong></span> pero podemos <span class="hl-purple"><strong>invertir el orden</strong></span> con <code>desc()</code></p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(height))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  name         height  mass
  &lt;chr&gt;         &lt;int&gt; &lt;dbl&gt;
1 Yarael Poof     264    NA
2 Tarfful         234   136
3 Lama Su         229    88
4 Chewbacca       228   112
5 Roos Tarpals    224    82</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">arrange</span>(mass, <span class="fu">desc</span>(height))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  name                  height  mass
  &lt;chr&gt;                  &lt;int&gt; &lt;dbl&gt;
1 Ratts Tyerell             79    15
2 Yoda                      66    17
3 Wicket Systri Warrick     88    20
4 R5-D4                     97    32
5 R2-D2                     96    32</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="eliminar-duplicados-distinct" class="slide level2">
<h2>Eliminar duplicados: distinct()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">sin_duplicados</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">distinct</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Muchas veces necesitaremos asegurarnos que no hay duplicados en alguna variable (DNI) y podemos <span class="hl-yellow"><strong>eliminar filas duplicadas</strong></span> con <code>distinct()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">distinct</span>(sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 1
  sex           
  &lt;chr&gt;         
1 male          
2 none          
3 female        
4 hermaphroditic
5 &lt;NA&gt;          </code></pre>
</div>
</div>
<div class="fragment">
<p>Para mantener todas las columnas de la tabla usaremos <code>.keep_all = TRUE</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">distinct</span>(sex, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 14
  name      height  mass hair_color skin_color eye_color birth_year sex   gender
  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
1 Luke Sky…    172    77 blond      fair       blue              19 male  mascu…
2 C-3PO        167    75 &lt;NA&gt;       gold       yellow           112 none  mascu…
3 Leia Org…    150    49 brown      light      brown             19 fema… femin…
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="añadir-filas-bind_rows" class="slide level2">
<h2>Añadir filas: bind_rows()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1"></a>tibble1 <span class="sc">|&gt;</span> <span class="fu">encuadernar_filas</span>(tibble2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1"></a>tibble1 <span class="sc">|&gt;</span> <span class="fu">bind_rows</span>(tibble2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Por último, podemos <span class="hl-yellow"><strong>concatenar nuevas filas</strong></span> con <code>bind_rows()</code> con <span class="hl-red"><strong>las nuevas observaciones en tabla</strong></span> (si no cuadran columnas rellena con ausentes)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1"></a>datos <span class="ot">&lt;-</span></span>
<span id="cb157-2"><a href="#cb157-2"></a>  <span class="fu">tibble</span>(<span class="st">"nombre"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"javi"</span>, <span class="st">"laura"</span>), <span class="st">"edad"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">33</span>, <span class="dv">50</span>))</span>
<span id="cb157-3"><a href="#cb157-3"></a>datos</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  nombre  edad
  &lt;chr&gt;  &lt;dbl&gt;
1 javi      33
2 laura     50</code></pre>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">bind_rows</span>(<span class="fu">tibble</span>(<span class="st">"nombre"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"carlos"</span>, <span class="cn">NA</span>), <span class="st">"cp"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">28045</span>, <span class="dv">28019</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  nombre  edad    cp
  &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 javi      33    NA
2 laura     50    NA
3 carlos    NA 28045
4 &lt;NA&gt;      NA 28019</code></pre>
</div>
</div>
</div>
</section>
<section id="tu-turno-10a" class="slide level2">
<h2>💻 Tu turno</h2>
<p><span style="color:#444442;"><strong>Intenta realizar los siguientes ejercicios sin mirar las soluciones</strong></span></p>
<div class="panel-tabset">
<ul id="tabset-4" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-4-1"><span class="hl-yellow"><strong>Ejercicio 1</strong></span></a></li><li><a href="#tabset-4-2"><span class="hl-yellow"><strong>Ejercicio 2</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-4-1">
<p>📝 Para saber que valores únicos hay en el color de pelo, elimina duplicados de la variable <code>hair_color</code>, eliminando antes los ausentes de dicha variable.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb161-2"><a href="#cb161-2"></a>  <span class="fu">drop_na</span>(hair_color) <span class="sc">|&gt;</span> </span>
<span id="cb161-3"><a href="#cb161-3"></a>  <span class="fu">distinct</span>(hair_color)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-4-2">
<p>📝 De los personajes que son humanos y miden más de 160 cm, elimina duplicados en color de ojos, elimina ausentes en peso, selecciona los 3 más altos, y orden de mayor a menor peso. Devuelve la tabla.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb162-2"><a href="#cb162-2"></a>  <span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">"Human"</span> <span class="sc">&amp;</span> height <span class="sc">&gt;</span> <span class="dv">160</span>) <span class="sc">|&gt;</span> </span>
<span id="cb162-3"><a href="#cb162-3"></a>  <span class="fu">distinct</span>(eye_color, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb162-4"><a href="#cb162-4"></a>  <span class="fu">drop_na</span>(mass) <span class="sc">|&gt;</span> </span>
<span id="cb162-5"><a href="#cb162-5"></a>  <span class="fu">slice_max</span>(height, <span class="at">n =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb162-6"><a href="#cb162-6"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(mass))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="resumen" class="slide level2">
<h2>Resumen</h2>
<p>La clave de <code>{tidyverse}</code> es la <span class="hl-yellow"><strong>legibilidad</strong></span>: es importantísimo que el código se entienda, por nuestro yo el futuro pero también por la <span class="hl-yellow"><strong>transparencia algorítmica</strong></span> hacia los demás</p>
<p><span class="hl-purple"><strong>Por ejemplo</strong></span>: quitaremos ausentes de la variable peso, filtraremos los personajes humanos y altura superior a 140cm, sin duplicados en el color de pelo, extrayendo los 5 más altos y obteniendo 2 personajes aleatorios finalmente.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb163" data-code-line-numbers="2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb163-2"><a href="#cb163-2"></a>  <span class="fu">elimino_ausentes</span>(peso) <span class="sc">|&gt;</span> </span>
<span id="cb163-3"><a href="#cb163-3"></a>  <span class="fu">filtro</span>(especie humana Y altura <span class="sc">&gt;</span> <span class="dv">140</span> cm) <span class="sc">|&gt;</span> </span>
<span id="cb163-4"><a href="#cb163-4"></a>  <span class="fu">sin_duplicados</span>(color de pelo) <span class="sc">|&gt;</span></span>
<span id="cb163-5"><a href="#cb163-5"></a>  <span class="fu">rebanadas_max</span>(peso, <span class="at">n =</span> <span class="dv">5</span>) <span class="sc">|&gt;</span> </span>
<span id="cb163-6"><a href="#cb163-6"></a>  <span class="fu">rebanadas_aleatorias</span>(<span class="at">n =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb164" data-code-line-numbers="2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb164-2"><a href="#cb164-2"></a>  <span class="fu">drop_na</span>(mass) <span class="sc">|&gt;</span> </span>
<span id="cb164-3"><a href="#cb164-3"></a>  <span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">"Human"</span> <span class="sc">&amp;</span> height <span class="sc">&gt;</span> <span class="dv">140</span>) <span class="sc">|&gt;</span> </span>
<span id="cb164-4"><a href="#cb164-4"></a>  <span class="fu">distinct</span>(hair_color, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb164-5"><a href="#cb164-5"></a>  <span class="fu">slice_max</span>(mass, <span class="at">n =</span> <span class="dv">5</span>) <span class="sc">|&gt;</span> </span>
<span id="cb164-6"><a href="#cb164-6"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="resumen-1" class="slide level2">
<h2>Resumen</h2>
<p>La clave de <code>{tidyverse}</code> es la <span class="hl-yellow"><strong>legibilidad</strong></span>: es importantísimo que el código se entienda, por nuestro yo el futuro pero también por la <span class="hl-yellow"><strong>transparencia algorítmica</strong></span> hacia los demás</p>
<p><span class="hl-purple"><strong>Por ejemplo</strong></span>: quitaremos ausentes de la variable peso, filtraremos los personajes humanos y altura superior a 140cm, sin duplicados en el color de pelo, extrayendo los 5 más altos y obteniendo 2 personajes aleatorios finalmente.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb165" data-code-line-numbers="3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb165-2"><a href="#cb165-2"></a>  <span class="fu">elimino_ausentes</span>(peso) <span class="sc">|&gt;</span> </span>
<span id="cb165-3"><a href="#cb165-3"></a>  <span class="fu">filtro</span>(especie humana Y altura <span class="sc">&gt;</span> <span class="dv">140</span> cm) <span class="sc">|&gt;</span> </span>
<span id="cb165-4"><a href="#cb165-4"></a>  <span class="fu">sin_duplicados</span>(color de pelo) <span class="sc">|&gt;</span></span>
<span id="cb165-5"><a href="#cb165-5"></a>  <span class="fu">rebanadas_max</span>(peso, <span class="at">n =</span> <span class="dv">5</span>) <span class="sc">|&gt;</span> </span>
<span id="cb165-6"><a href="#cb165-6"></a>  <span class="fu">rebanadas_aleatorias</span>(<span class="at">n =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb166" data-code-line-numbers="3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb166-2"><a href="#cb166-2"></a>  <span class="fu">drop_na</span>(mass) <span class="sc">|&gt;</span> </span>
<span id="cb166-3"><a href="#cb166-3"></a>  <span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">"Human"</span> <span class="sc">&amp;</span> height <span class="sc">&gt;</span> <span class="dv">140</span>) <span class="sc">|&gt;</span> </span>
<span id="cb166-4"><a href="#cb166-4"></a>  <span class="fu">distinct</span>(hair_color, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb166-5"><a href="#cb166-5"></a>  <span class="fu">slice_max</span>(mass, <span class="at">n =</span> <span class="dv">5</span>) <span class="sc">|&gt;</span> </span>
<span id="cb166-6"><a href="#cb166-6"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="resumen-2" class="slide level2">
<h2>Resumen</h2>
<p>La clave de <code>{tidyverse}</code> es la <span class="hl-yellow"><strong>legibilidad</strong></span>: es importantísimo que el código se entienda, por nuestro yo el futuro pero también por la <span class="hl-yellow"><strong>transparencia algorítmica</strong></span> hacia los demás</p>
<p><span class="hl-purple"><strong>Por ejemplo</strong></span>: quitaremos ausentes de la variable peso, filtraremos los personajes humanos y altura superior a 140cm, sin duplicados en el color de pelo, extrayendo los 5 más altos y obteniendo 2 personajes aleatorios finalmente.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb167" data-code-line-numbers="4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb167-2"><a href="#cb167-2"></a>  <span class="fu">elimino_ausentes</span>(peso) <span class="sc">|&gt;</span> </span>
<span id="cb167-3"><a href="#cb167-3"></a>  <span class="fu">filtro</span>(especie humana Y altura <span class="sc">&gt;</span> <span class="dv">140</span> cm) <span class="sc">|&gt;</span> </span>
<span id="cb167-4"><a href="#cb167-4"></a>  <span class="fu">sin_duplicados</span>(color de pelo) <span class="sc">|&gt;</span></span>
<span id="cb167-5"><a href="#cb167-5"></a>  <span class="fu">rebanadas_max</span>(peso, <span class="at">n =</span> <span class="dv">5</span>) <span class="sc">|&gt;</span> </span>
<span id="cb167-6"><a href="#cb167-6"></a>  <span class="fu">rebanadas_aleatorias</span>(<span class="at">n =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb168" data-code-line-numbers="4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb168-2"><a href="#cb168-2"></a>  <span class="fu">drop_na</span>(mass) <span class="sc">|&gt;</span> </span>
<span id="cb168-3"><a href="#cb168-3"></a>  <span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">"Human"</span> <span class="sc">&amp;</span> height <span class="sc">&gt;</span> <span class="dv">140</span>) <span class="sc">|&gt;</span> </span>
<span id="cb168-4"><a href="#cb168-4"></a>  <span class="fu">distinct</span>(hair_color, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb168-5"><a href="#cb168-5"></a>  <span class="fu">slice_max</span>(mass, <span class="at">n =</span> <span class="dv">5</span>) <span class="sc">|&gt;</span> </span>
<span id="cb168-6"><a href="#cb168-6"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="resumen-3" class="slide level2">
<h2>Resumen</h2>
<p>La clave de <code>{tidyverse}</code> es la <span class="hl-yellow"><strong>legibilidad</strong></span>: es importantísimo que el código se entienda, por nuestro yo el futuro pero también por la <span class="hl-yellow"><strong>transparencia algorítmica</strong></span> hacia los demás</p>
<p><span class="hl-purple"><strong>Por ejemplo</strong></span>: quitaremos ausentes de la variable peso, filtraremos los personajes humanos y altura superior a 140cm, sin duplicados en el color de pelo, extrayendo los 5 más altos y obteniendo 2 personajes aleatorios finalmente.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb169" data-code-line-numbers="5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb169-2"><a href="#cb169-2"></a>  <span class="fu">elimino_ausentes</span>(peso) <span class="sc">|&gt;</span> </span>
<span id="cb169-3"><a href="#cb169-3"></a>  <span class="fu">filtro</span>(especie humana Y altura <span class="sc">&gt;</span> <span class="dv">140</span> cm) <span class="sc">|&gt;</span> </span>
<span id="cb169-4"><a href="#cb169-4"></a>  <span class="fu">sin_duplicados</span>(color de pelo) <span class="sc">|&gt;</span></span>
<span id="cb169-5"><a href="#cb169-5"></a>  <span class="fu">rebanadas_max</span>(peso, <span class="at">n =</span> <span class="dv">5</span>) <span class="sc">|&gt;</span> </span>
<span id="cb169-6"><a href="#cb169-6"></a>  <span class="fu">rebanadas_aleatorias</span>(<span class="at">n =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb170" data-code-line-numbers="5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb170-2"><a href="#cb170-2"></a>  <span class="fu">drop_na</span>(mass) <span class="sc">|&gt;</span> </span>
<span id="cb170-3"><a href="#cb170-3"></a>  <span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">"Human"</span> <span class="sc">&amp;</span> height <span class="sc">&gt;</span> <span class="dv">140</span>) <span class="sc">|&gt;</span> </span>
<span id="cb170-4"><a href="#cb170-4"></a>  <span class="fu">distinct</span>(hair_color, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb170-5"><a href="#cb170-5"></a>  <span class="fu">slice_max</span>(mass, <span class="at">n =</span> <span class="dv">5</span>) <span class="sc">|&gt;</span> </span>
<span id="cb170-6"><a href="#cb170-6"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="resumen-4" class="slide level2">
<h2>Resumen</h2>
<p>La clave de <code>{tidyverse}</code> es la <span class="hl-yellow"><strong>legibilidad</strong></span>: es importantísimo que el código se entienda, por nuestro yo el futuro pero también por la <span class="hl-yellow"><strong>transparencia algorítmica</strong></span> hacia los demás</p>
<p><span class="hl-purple"><strong>Por ejemplo</strong></span>: quitaremos ausentes de la variable peso, filtraremos los personajes humanos y altura superior a 140cm, sin duplicados en el color de pelo, extrayendo los 5 más altos y obteniendo 2 personajes aleatorios finalmente.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb171" data-code-line-numbers="6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb171-2"><a href="#cb171-2"></a>  <span class="fu">elimino_ausentes</span>(peso) <span class="sc">|&gt;</span> </span>
<span id="cb171-3"><a href="#cb171-3"></a>  <span class="fu">filtro</span>(especie humana Y altura <span class="sc">&gt;</span> <span class="dv">140</span> cm) <span class="sc">|&gt;</span> </span>
<span id="cb171-4"><a href="#cb171-4"></a>  <span class="fu">sin_duplicados</span>(color de pelo) <span class="sc">|&gt;</span></span>
<span id="cb171-5"><a href="#cb171-5"></a>  <span class="fu">rebanadas_max</span>(peso, <span class="at">n =</span> <span class="dv">5</span>) <span class="sc">|&gt;</span> </span>
<span id="cb171-6"><a href="#cb171-6"></a>  <span class="fu">rebanadas_aleatorias</span>(<span class="at">n =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb172" data-code-line-numbers="6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb172-2"><a href="#cb172-2"></a>  <span class="fu">drop_na</span>(mass) <span class="sc">|&gt;</span> </span>
<span id="cb172-3"><a href="#cb172-3"></a>  <span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">"Human"</span> <span class="sc">&amp;</span> height <span class="sc">&gt;</span> <span class="dv">140</span>) <span class="sc">|&gt;</span> </span>
<span id="cb172-4"><a href="#cb172-4"></a>  <span class="fu">distinct</span>(hair_color, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb172-5"><a href="#cb172-5"></a>  <span class="fu">slice_max</span>(mass, <span class="at">n =</span> <span class="dv">5</span>) <span class="sc">|&gt;</span> </span>
<span id="cb172-6"><a href="#cb172-6"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="selección-columnas-select" class="slide level2">
<h2>Selección columnas: select()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">selecciono</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">select</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>La opción más sencilla para <span class="hl-yellow"><strong>seleccionar variables por nombre</strong></span> es <code>select()</code>, dando como argumentos los nombres de columnas <span class="hl-purple"><strong>sin comillas</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">select</span>(name, hair_color)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 2
   name               hair_color   
   &lt;chr&gt;              &lt;chr&gt;        
 1 Luke Skywalker     blond        
 2 C-3PO              &lt;NA&gt;         
 3 R2-D2              &lt;NA&gt;         
 4 Darth Vader        none         
 5 Leia Organa        brown        
 6 Owen Lars          brown, grey  
 7 Beru Whitesun lars brown        
 8 R5-D4              &lt;NA&gt;         
 9 Biggs Darklighter  black        
10 Obi-Wan Kenobi     auburn, white
# ℹ 77 more rows</code></pre>
</div>
</div>
</section>
<section id="selección-columnas-select-1" class="slide level2">
<h2>Selección columnas: select()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">selecciono</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">select</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>La función <code>select()</code> nos permite seleccionar varias variables a la vez, incluso <span class="hl-yellow"><strong>concatenando sus nombres como si fuesen índices numéricos</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">select</span>(name<span class="sc">:</span>eye_color) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 6
  name           height  mass hair_color skin_color  eye_color
  &lt;chr&gt;           &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;    
1 Luke Skywalker    172    77 blond      fair        blue     
2 C-3PO             167    75 &lt;NA&gt;       gold        yellow   
3 R2-D2              96    32 &lt;NA&gt;       white, blue red      
4 Darth Vader       202   136 none       white       yellow   </code></pre>
</div>
</div>
<div class="fragment">
<p>Y podemos <span class="hl-yellow"><strong>deseleccionar columnas</strong></span> con <code>-</code> delante</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1"></a>starwars <span class="sc">|&gt;</span>  <span class="fu">select</span>(<span class="sc">-</span>mass, <span class="sc">-</span>(eye_color<span class="sc">:</span>starships))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
  name           height hair_color skin_color 
  &lt;chr&gt;           &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;      
1 Luke Skywalker    172 blond      fair       
2 C-3PO             167 &lt;NA&gt;       gold       
3 R2-D2              96 &lt;NA&gt;       white, blue
4 Darth Vader       202 none       white      </code></pre>
</div>
</div>
</div>
</section>
<section id="selección-columnas-select-2" class="slide level2">
<h2>Selección columnas: select()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">selecciono</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">select</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Tenemos además <span class="hl-yellow"><strong>palabras reservadas</strong></span>: <code>everything()</code> <span class="hl-purple"><strong>todas las variables</strong></span>…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">select</span>(mass, homeworld, <span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 14
   mass homeworld name   height hair_color skin_color eye_color birth_year sex  
  &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;   &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;
1    77 Tatooine  Luke …    172 blond      fair       blue            19   male 
2    75 Tatooine  C-3PO     167 &lt;NA&gt;       gold       yellow         112   none 
3    32 Naboo     R2-D2      96 &lt;NA&gt;       white, bl… red             33   none 
4   136 Tatooine  Darth…    202 none       white      yellow          41.9 male 
# ℹ 5 more variables: gender &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
<div class="fragment">
<p>…y <code>last_col()</code> para referirnos a <span class="hl-purple"><strong>la última columna</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">select</span>(name<span class="sc">:</span>mass, homeworld, <span class="fu">last_col</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
  name           height  mass homeworld starships
  &lt;chr&gt;           &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;     &lt;list&gt;   
1 Luke Skywalker    172    77 Tatooine  &lt;chr [2]&gt;
2 C-3PO             167    75 Tatooine  &lt;chr [0]&gt;
3 R2-D2              96    32 Naboo     &lt;chr [0]&gt;
4 Darth Vader       202   136 Tatooine  &lt;chr [1]&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="selección-columnas-select-3" class="slide level2">
<h2>Selección columnas: select()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">selecciono</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">select</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>También podemos jugar con <span class="hl-yellow"><strong>patrones</strong></span> en el nombre, aquellas que <span class="hl-purple"><strong>comiencen por un prefijo</strong></span> (<code>starts_with()</code>), <span class="hl-purple"><strong>terminen con un sufijo</strong></span> (<code>ends_with()</code>), <span class="hl-purple"><strong>contengan un texto</strong></span> (<code>contains()</code>) o cumplan una <span class="hl-purple"><strong>expresión regular</strong></span> (<code>matches()</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1"></a><span class="co"># variables cuyo nombre acaba en "color" y contengan sexo o género</span></span>
<span id="cb191-2"><a href="#cb191-2"></a>starwars <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">ends_with</span>(<span class="st">"color"</span>), <span class="fu">matches</span>(<span class="st">"sex|gender"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 5
   hair_color    skin_color  eye_color sex    gender   
   &lt;chr&gt;         &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt;  &lt;chr&gt;    
 1 blond         fair        blue      male   masculine
 2 &lt;NA&gt;          gold        yellow    none   masculine
 3 &lt;NA&gt;          white, blue red       none   masculine
 4 none          white       yellow    male   masculine
 5 brown         light       brown     female feminine 
 6 brown, grey   light       blue      male   masculine
 7 brown         light       blue      female feminine 
 8 &lt;NA&gt;          white, red  red       none   masculine
 9 black         light       brown     male   masculine
10 auburn, white fair        blue-gray male   masculine
# ℹ 77 more rows</code></pre>
</div>
</div>
</section>
<section id="selección-columnas-select-4" class="slide level2">
<h2>Selección columnas: select()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">selecciono</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">select</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Incluso podemos <span class="hl-yellow"><strong>seleccionar por rango numérico</strong></span> si tenemos variables con un prefijo y números.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1"></a>datos <span class="ot">&lt;-</span></span>
<span id="cb195-2"><a href="#cb195-2"></a>  <span class="fu">tibble</span>(<span class="st">"semana1"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">115</span>, <span class="dv">141</span>, <span class="dv">232</span>), <span class="st">"semana2"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="cn">NA</span>, <span class="dv">17</span>),</span>
<span id="cb195-3"><a href="#cb195-3"></a>         <span class="st">"semana3"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">95</span>, <span class="dv">162</span>, <span class="cn">NA</span>), <span class="st">"semana4"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">19</span>, <span class="dv">15</span>),</span>
<span id="cb195-4"><a href="#cb195-4"></a>         <span class="st">"semana5"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">262</span>, <span class="dv">190</span>), <span class="st">"semana6"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">15</span>, <span class="dv">23</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p>Con <code>num_range()</code> podemos seleccionar con un prefijo y una secuencia numérica.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">num_range</span>(<span class="st">"semana"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  semana1 semana2 semana3 semana4
    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1     115       7      95      11
2     141      NA     162      19
3     232      17      NA      15</code></pre>
</div>
</div>
</div>
</section>
<section id="selección-columnas-select-5" class="slide level2">
<h2>Selección columnas: select()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">selecciono</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">select</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Por último, podemos seleccionar columnas por <span class="hl-yellow"><strong>tipo de dato</strong></span> haciendo uso de <code>where()</code> y dentro una función que devuelva un valor lógico de tipo de dato.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1"></a><span class="co"># Solo columnas numéricas o de texto</span></span>
<span id="cb200-2"><a href="#cb200-2"></a>starwars <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">where</span>(is.numeric) <span class="sc">|</span> <span class="fu">where</span>(is.character))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 11
   height  mass birth_year name     hair_color skin_color eye_color sex   gender
    &lt;int&gt; &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt; 
 1    172    77       19   Luke Sk… blond      fair       blue      male  mascu…
 2    167    75      112   C-3PO    &lt;NA&gt;       gold       yellow    none  mascu…
 3     96    32       33   R2-D2    &lt;NA&gt;       white, bl… red       none  mascu…
 4    202   136       41.9 Darth V… none       white      yellow    male  mascu…
 5    150    49       19   Leia Or… brown      light      brown     fema… femin…
 6    178   120       52   Owen La… brown, gr… light      blue      male  mascu…
 7    165    75       47   Beru Wh… brown      light      blue      fema… femin…
 8     97    32       NA   R5-D4    &lt;NA&gt;       white, red red       none  mascu…
 9    183    84       24   Biggs D… black      light      brown     male  mascu…
10    182    77       57   Obi-Wan… auburn, w… fair       blue-gray male  mascu…
# ℹ 77 more rows
# ℹ 2 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;</code></pre>
</div>
</div>
</section>
<section id="mover-columnas-relocate" class="slide level2">
<h2>Mover columnas: relocate()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb202-2"><a href="#cb202-2"></a>  <span class="fu">recolocar</span>(var1, <span class="at">despues_de =</span> var2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb203-2"><a href="#cb203-2"></a>  <span class="fu">relocate</span>(var1, <span class="at">.after =</span> var2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Para facilitar la <span class="hl-yellow"><strong>recolocación de variables</strong></span> tenemos una función para ello, <code>relocate()</code>, indicándole en <code>.after</code> o <code>.before</code> <span class="hl-purple"><strong>detrás</strong></span> o <span class="hl-purple"><strong>delante</strong></span> de qué columnas queremos moverlas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">relocate</span>(species, <span class="at">.before =</span> name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 14
   species name    height  mass hair_color skin_color eye_color birth_year sex  
   &lt;chr&gt;   &lt;chr&gt;    &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;
 1 Human   Luke S…    172    77 blond      fair       blue            19   male 
 2 Droid   C-3PO      167    75 &lt;NA&gt;       gold       yellow         112   none 
 3 Droid   R2-D2       96    32 &lt;NA&gt;       white, bl… red             33   none 
 4 Human   Darth …    202   136 none       white      yellow          41.9 male 
 5 Human   Leia O…    150    49 brown      light      brown           19   fema…
 6 Human   Owen L…    178   120 brown, gr… light      blue            52   male 
 7 Human   Beru W…    165    75 brown      light      blue            47   fema…
 8 Droid   R5-D4       97    32 &lt;NA&gt;       white, red red             NA   none 
 9 Human   Biggs …    183    84 black      light      brown           24   male 
10 Human   Obi-Wa…    182    77 auburn, w… fair       blue-gray       57   male 
# ℹ 77 more rows
# ℹ 5 more variables: gender &lt;chr&gt;, homeworld &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</section>
<section id="renombrar-rename" class="slide level2">
<h2>Renombrar: rename()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">renombrar</span>(<span class="at">nuevo =</span> antiguo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="at">nuevo =</span> antiguo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>A veces también podemos querer <span class="hl-yellow"><strong>modificar la «metainformación»</strong></span> de los datos, <span class="hl-yellow"><strong>renombrando columnas</strong></span>. Para ello usaremos de <code>rename()</code> poniendo <span class="hl-purple"><strong>primero el nombre nuevo</strong></span> y luego el <span class="hl-purple"><strong>antiguo</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="at">nombre =</span> name, <span class="at">altura =</span> height, <span class="at">peso =</span> mass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 14
   nombre   altura  peso hair_color skin_color eye_color birth_year sex   gender
   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
 1 Luke Sk…    172    77 blond      fair       blue            19   male  mascu…
 2 C-3PO       167    75 &lt;NA&gt;       gold       yellow         112   none  mascu…
 3 R2-D2        96    32 &lt;NA&gt;       white, bl… red             33   none  mascu…
 4 Darth V…    202   136 none       white      yellow          41.9 male  mascu…
 5 Leia Or…    150    49 brown      light      brown           19   fema… femin…
 6 Owen La…    178   120 brown, gr… light      blue            52   male  mascu…
 7 Beru Wh…    165    75 brown      light      blue            47   fema… femin…
 8 R5-D4        97    32 &lt;NA&gt;       white, red red             NA   none  mascu…
 9 Biggs D…    183    84 black      light      brown           24   male  mascu…
10 Obi-Wan…    182    77 auburn, w… fair       blue-gray       57   male  mascu…
# ℹ 77 more rows
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</section>
<section id="extraer-columnas-pull" class="slide level2">
<h2>Extraer columnas: pull()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">retirar</span>(var)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">pull</span>(var)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Si observas la salida de los <code>select()</code> <span class="hl-yellow"><strong>sigue siendo una tabla tibble</strong></span>, ya que nos preserva la naturaleza de nuestros datos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">select</span>(name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 1
   name              
   &lt;chr&gt;             
 1 Luke Skywalker    
 2 C-3PO             
 3 R2-D2             
 4 Darth Vader       
 5 Leia Organa       
 6 Owen Lars         
 7 Beru Whitesun lars
 8 R5-D4             
 9 Biggs Darklighter 
10 Obi-Wan Kenobi    
# ℹ 77 more rows</code></pre>
</div>
</div>
</section>
<section id="extraer-columnas-pull-1" class="slide level2">
<h2>Extraer columnas: pull()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">retirar</span>(var)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">pull</span>(var)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>A veces no querremos dicha estructura sino <span class="hl-yellow"><strong>extraer literalmente la columna en un vector</strong></span>, algo que podemos hacer con <code>pull()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">pull</span>(name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Luke Skywalker"        "C-3PO"                 "R2-D2"                
 [4] "Darth Vader"           "Leia Organa"           "Owen Lars"            
 [7] "Beru Whitesun lars"    "R5-D4"                 "Biggs Darklighter"    
[10] "Obi-Wan Kenobi"        "Anakin Skywalker"      "Wilhuff Tarkin"       
[13] "Chewbacca"             "Han Solo"              "Greedo"               
[16] "Jabba Desilijic Tiure" "Wedge Antilles"        "Jek Tono Porkins"     
[19] "Yoda"                  "Palpatine"             "Boba Fett"            
[22] "IG-88"                 "Bossk"                 "Lando Calrissian"     
[25] "Lobot"                 "Ackbar"                "Mon Mothma"           
[28] "Arvel Crynyd"          "Wicket Systri Warrick" "Nien Nunb"            
[31] "Qui-Gon Jinn"          "Nute Gunray"           "Finis Valorum"        
[34] "Jar Jar Binks"         "Roos Tarpals"          "Rugor Nass"           
[37] "Ric Olié"              "Watto"                 "Sebulba"              
[40] "Quarsh Panaka"         "Shmi Skywalker"        "Darth Maul"           
[43] "Bib Fortuna"           "Ayla Secura"           "Dud Bolt"             
[46] "Gasgano"               "Ben Quadinaros"        "Mace Windu"           
[49] "Ki-Adi-Mundi"          "Kit Fisto"             "Eeth Koth"            
[52] "Adi Gallia"            "Saesee Tiin"           "Yarael Poof"          
[55] "Plo Koon"              "Mas Amedda"            "Gregar Typho"         
[58] "Cordé"                 "Cliegg Lars"           "Poggle the Lesser"    
[61] "Luminara Unduli"       "Barriss Offee"         "Dormé"                
[64] "Dooku"                 "Bail Prestor Organa"   "Jango Fett"           
[67] "Zam Wesell"            "Dexter Jettster"       "Lama Su"              
[70] "Taun We"               "Jocasta Nu"            "Ratts Tyerell"        
[73] "R4-P17"                "Wat Tambor"            "San Hill"             
[76] "Shaak Ti"              "Grievous"              "Tarfful"              
[79] "Raymus Antilles"       "Sly Moore"             "Tion Medon"           
[82] "Finn"                  "Rey"                   "Poe Dameron"          
[85] "BB8"                   "Captain Phasma"        "Padmé Amidala"        </code></pre>
</div>
</div>
</section>
<section id="tu-turno-10b" class="slide level2">
<h2>💻 Tu turno</h2>
<p><span style="color:#444442;"><strong>Intenta realizar los siguientes ejercicios sin mirar las soluciones</strong></span></p>
<div class="panel-tabset">
<ul id="tabset-5" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-5-1"><span class="hl-yellow"><strong>Ejercicio 1</strong></span></a></li><li><a href="#tabset-5-2"><span class="hl-yellow"><strong>Ejercicio 2</strong></span></a></li><li><a href="#tabset-5-3"><span class="hl-yellow"><strong>Ejercicio 3</strong></span></a></li><li><a href="#tabset-5-4"><span class="hl-yellow"><strong>Ejercicio 4</strong></span></a></li><li><a href="#tabset-5-5"><span class="hl-yellow"><strong>Ejercicio 5</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-5-1">
<p>📝 Filtra el conjunto de personajes y quédate solo con aquellos que en la variable <code>height</code> no tengan un dato ausente. Con los datos obtenidos del filtro anterior, selecciona solo las variables name, height, así como todas aquellas variables que CONTENGAN la palabra color en su nombre.</p>
</div>
<div id="tabset-5-2">
<p>📝 Con los datos obtenidos del ejercicio anterior, traduce el nombre de las columnas a castellano</p>
</div>
<div id="tabset-5-3">
<p>📝 Con los datos obtenidos del ejercicio anterior, coloca la variable de color de pelo justo detrás de la variable de nombres.</p>
</div>
<div id="tabset-5-4">
<p>📝 Con los datos obtenidos del ejercicio anterior, comprueba cuántas modalidades únicas hay en la variable de color de pelo (sin usar <code>unique()</code>).</p>
</div>
<div id="tabset-5-5">
<p>📝 Del conjunto de datos originales, elimina las columnas de tipo lista, y tras ello elimina duplicados en la variable <code>eye_color</code>. Tras eliminar duplicados extrae dicha columna en un vector.</p>
</div>
</div>
</div>
</section>
<section id="modificar-columnas-mutate" class="slide level2">
<h2>Modificar columnas: mutate()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">modificar</span>(<span class="at">nueva =</span> <span class="fu">funcion</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">nueva =</span> <span class="fu">funcion</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>En muchas ocasiones querremos <span class="hl-yellow"><strong>modificar o crear variables</strong></span> con <code>mutate()</code>.</p>
<div class="fragment">
<p>Vamos a crear por ejemplo una nueva variable <code>height_m</code> con la altura en metros.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">height_m =</span> height <span class="sc">/</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 15
   name     height  mass hair_color skin_color eye_color birth_year sex   gender
   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
 1 Luke Sk…    172    77 blond      fair       blue            19   male  mascu…
 2 C-3PO       167    75 &lt;NA&gt;       gold       yellow         112   none  mascu…
 3 R2-D2        96    32 &lt;NA&gt;       white, bl… red             33   none  mascu…
 4 Darth V…    202   136 none       white      yellow          41.9 male  mascu…
 5 Leia Or…    150    49 brown      light      brown           19   fema… femin…
 6 Owen La…    178   120 brown, gr… light      blue            52   male  mascu…
 7 Beru Wh…    165    75 brown      light      blue            47   fema… femin…
 8 R5-D4        97    32 &lt;NA&gt;       white, red red             NA   none  mascu…
 9 Biggs D…    183    84 black      light      brown           24   male  mascu…
10 Obi-Wan…    182    77 auburn, w… fair       blue-gray       57   male  mascu…
# ℹ 77 more rows
# ℹ 6 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;, height_m &lt;dbl&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="modificar-columnas-mutate-1" class="slide level2">
<h2>Modificar columnas: mutate()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">modificar</span>(<span class="at">nueva =</span> <span class="fu">funcion</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">nueva =</span> <span class="fu">funcion</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Además con los argumentos opcionales podemos <span class="hl-yellow"><strong>recolocar la columna modificada</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb224-2"><a href="#cb224-2"></a>  <span class="fu">mutate</span>(<span class="at">height_m =</span> height <span class="sc">/</span> <span class="dv">100</span>,</span>
<span id="cb224-3"><a href="#cb224-3"></a>         <span class="at">IMC =</span> mass <span class="sc">/</span> (height_m<span class="sc">^</span><span class="dv">2</span>), <span class="at">.before =</span> name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 16
   height_m   IMC name   height  mass hair_color skin_color eye_color birth_year
      &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt;
 1     1.72  26.0 Luke …    172    77 blond      fair       blue            19  
 2     1.67  26.9 C-3PO     167    75 &lt;NA&gt;       gold       yellow         112  
 3     0.96  34.7 R2-D2      96    32 &lt;NA&gt;       white, bl… red             33  
 4     2.02  33.3 Darth…    202   136 none       white      yellow          41.9
 5     1.5   21.8 Leia …    150    49 brown      light      brown           19  
 6     1.78  37.9 Owen …    178   120 brown, gr… light      blue            52  
 7     1.65  27.5 Beru …    165    75 brown      light      blue            47  
 8     0.97  34.0 R5-D4      97    32 &lt;NA&gt;       white, red red             NA  
 9     1.83  25.1 Biggs…    183    84 black      light      brown           24  
10     1.82  23.2 Obi-W…    182    77 auburn, w… fair       blue-gray       57  
# ℹ 77 more rows
# ℹ 7 more variables: sex &lt;chr&gt;, gender &lt;chr&gt;, homeworld &lt;chr&gt;, species &lt;chr&gt;,
#   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</section>
<section id="modificar-columnas-mutate-2" class="slide level2">
<h2>Modificar columnas: mutate()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">modificar</span>(<span class="at">nueva =</span> <span class="fu">funcion</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">nueva =</span> <span class="fu">funcion</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Importante…</strong></p>
</div>
<div class="callout-content">
<p>Cuando aplicamos <code>mutate()</code>, debemos de acordarnos que las <span class="hl-yellow"><strong>operaciones se realizan de manera vectorial</strong></span>, elemento a elemento, por lo que la función que usemos dentro debe devolver un vector de igual longitud. En caso contrario, <span class="hl-red"><strong>devolverá una constante</strong></span></p>
</div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb228-2"><a href="#cb228-2"></a>  <span class="fu">mutate</span>(<span class="at">constante =</span> <span class="fu">mean</span>(mass, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.before =</span> name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 15
   constante name  height  mass hair_color skin_color eye_color birth_year sex  
       &lt;dbl&gt; &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;
 1      97.3 Luke…    172    77 blond      fair       blue            19   male 
 2      97.3 C-3PO    167    75 &lt;NA&gt;       gold       yellow         112   none 
 3      97.3 R2-D2     96    32 &lt;NA&gt;       white, bl… red             33   none 
 4      97.3 Dart…    202   136 none       white      yellow          41.9 male 
 5      97.3 Leia…    150    49 brown      light      brown           19   fema…
 6      97.3 Owen…    178   120 brown, gr… light      blue            52   male 
 7      97.3 Beru…    165    75 brown      light      blue            47   fema…
 8      97.3 R5-D4     97    32 &lt;NA&gt;       white, red red             NA   none 
 9      97.3 Bigg…    183    84 black      light      brown           24   male 
10      97.3 Obi-…    182    77 auburn, w… fair       blue-gray       57   male 
# ℹ 77 more rows
# ℹ 6 more variables: gender &lt;chr&gt;, homeworld &lt;chr&gt;, species &lt;chr&gt;,
#   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="recategorizar-if_else" class="slide level2">
<h2>Recategorizar: if_else()</h2>
<p>También podemos combinar <code>mutate()</code> con la expresión de control <code>if_else()</code> para <span class="hl-yellow"><strong>recategorizar la variable</strong></span>: si <span class="hl-purple"><strong>se cumple una condición</strong></span>, hace una cosa, en caso contrario otra.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb230-2"><a href="#cb230-2"></a>  <span class="fu">mutate</span>(<span class="at">human =</span> <span class="fu">if_else</span>(species <span class="sc">==</span> <span class="st">"Human"</span>, <span class="st">"Human"</span>, <span class="st">"Not Human"</span>),</span>
<span id="cb230-3"><a href="#cb230-3"></a>         <span class="at">.after =</span> name) <span class="sc">|&gt;</span> </span>
<span id="cb230-4"><a href="#cb230-4"></a>  <span class="fu">select</span>(name<span class="sc">:</span>mass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 4
   name               human     height  mass
   &lt;chr&gt;              &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt;
 1 Luke Skywalker     Human        172    77
 2 C-3PO              Not Human    167    75
 3 R2-D2              Not Human     96    32
 4 Darth Vader        Human        202   136
 5 Leia Organa        Human        150    49
 6 Owen Lars          Human        178   120
 7 Beru Whitesun lars Human        165    75
 8 R5-D4              Not Human     97    32
 9 Biggs Darklighter  Human        183    84
10 Obi-Wan Kenobi     Human        182    77
# ℹ 77 more rows</code></pre>
</div>
</div>
</section>
<section id="recategorizar-case_when" class="slide level2">
<h2>Recategorizar: case_when()</h2>
<p>Para <span class="hl-yellow"><strong>recategorizaciones más complejas</strong></span> tenemos <code>case_when()</code>, por ejemplo, para crear una categoría de los personajes en función de su altura.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb232-2"><a href="#cb232-2"></a>  <span class="fu">drop_na</span>(height) <span class="sc">|&gt;</span> </span>
<span id="cb232-3"><a href="#cb232-3"></a>  <span class="fu">mutate</span>(<span class="at">altura =</span> <span class="fu">case_when</span>(height <span class="sc">&lt;</span> <span class="dv">120</span> <span class="sc">~</span> <span class="st">"enanos"</span>,</span>
<span id="cb232-4"><a href="#cb232-4"></a>                            height <span class="sc">&lt;</span> <span class="dv">160</span> <span class="sc">~</span> <span class="st">"bajito"</span>,</span>
<span id="cb232-5"><a href="#cb232-5"></a>                            height <span class="sc">&lt;</span> <span class="dv">180</span> <span class="sc">~</span> <span class="st">"normal"</span>,</span>
<span id="cb232-6"><a href="#cb232-6"></a>                            height <span class="sc">&lt;</span> <span class="dv">200</span> <span class="sc">~</span> <span class="st">"alto"</span>,</span>
<span id="cb232-7"><a href="#cb232-7"></a>                            <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"gigante"</span>), <span class="at">.before =</span> name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 81 × 15
   altura  name    height  mass hair_color skin_color eye_color birth_year sex  
   &lt;chr&gt;   &lt;chr&gt;    &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;
 1 normal  Luke S…    172    77 blond      fair       blue            19   male 
 2 normal  C-3PO      167    75 &lt;NA&gt;       gold       yellow         112   none 
 3 enanos  R2-D2       96    32 &lt;NA&gt;       white, bl… red             33   none 
 4 gigante Darth …    202   136 none       white      yellow          41.9 male 
 5 bajito  Leia O…    150    49 brown      light      brown           19   fema…
 6 normal  Owen L…    178   120 brown, gr… light      blue            52   male 
 7 normal  Beru W…    165    75 brown      light      blue            47   fema…
 8 enanos  R5-D4       97    32 &lt;NA&gt;       white, red red             NA   none 
 9 alto    Biggs …    183    84 black      light      brown           24   male 
10 alto    Obi-Wa…    182    77 auburn, w… fair       blue-gray       57   male 
# ℹ 71 more rows
# ℹ 6 more variables: gender &lt;chr&gt;, homeworld &lt;chr&gt;, species &lt;chr&gt;,
#   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</section>
<section id="tu-turno-11" class="slide level2">
<h2>💻 Tu turno</h2>
<p><span style="color:#444442;"><strong>Intenta realizar los siguientes ejercicios sin mirar las soluciones</strong></span></p>
<div class="panel-tabset">
<ul id="tabset-6" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-6-1"><span class="hl-yellow"><strong>Ejercicio 1</strong></span></a></li><li><a href="#tabset-6-2"><span class="hl-yellow"><strong>Ejercicio 2</strong></span></a></li><li><a href="#tabset-6-3"><span class="hl-yellow"><strong>Ejercicio 3</strong></span></a></li><li><a href="#tabset-6-4"><span class="hl-yellow"><strong>Ejercicio 4</strong></span></a></li><li><a href="#tabset-6-5"><span class="hl-yellow"><strong>Ejercicio 5</strong></span></a></li><li><a href="#tabset-6-6"><span class="hl-yellow"><strong>Ejercicio 6</strong></span></a></li><li><a href="#tabset-6-7"><span class="hl-yellow"><strong>Ejercicio 7</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-6-1">
<p>📝 Selecciona solo las variables nombre, altura y así como todas aquellas variables relacionadas con el color, a la vez que te quedas solo con aquellos que no tengan ausente en la altura.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb234-2"><a href="#cb234-2"></a>  <span class="fu">select</span>(name, height, <span class="fu">contains</span>(<span class="st">"color"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb234-3"><a href="#cb234-3"></a>  <span class="fu">drop_na</span>(height)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-6-2">
<p>📝 Con los datos obtenidos del ejercicio anterior, traduce el nombre de las columnas a castellano.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb235-2"><a href="#cb235-2"></a>  <span class="fu">select</span>(name, height, <span class="fu">contains</span>(<span class="st">"color"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb235-3"><a href="#cb235-3"></a>  <span class="fu">drop_na</span>(height) <span class="sc">|&gt;</span> </span>
<span id="cb235-4"><a href="#cb235-4"></a>  <span class="fu">rename</span>(<span class="at">nombre =</span> name, <span class="at">altura =</span> height,</span>
<span id="cb235-5"><a href="#cb235-5"></a>         <span class="at">color_pelo =</span> eye_color, <span class="at">color_piel =</span> skin_color,</span>
<span id="cb235-6"><a href="#cb235-6"></a>         <span class="at">color_pelo =</span> hair_color)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-6-3">
<p>📝 Con los datos obtenidos del ejercicio anterior, coloca la variable de color de pelo justo detrás de la variable de nombres.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb236-2"><a href="#cb236-2"></a>  <span class="fu">select</span>(name, height, <span class="fu">contains</span>(<span class="st">"color"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb236-3"><a href="#cb236-3"></a>  <span class="fu">drop_na</span>(height) <span class="sc">|&gt;</span> </span>
<span id="cb236-4"><a href="#cb236-4"></a>  <span class="fu">rename</span>(<span class="at">nombre =</span> name, <span class="at">altura =</span> height,</span>
<span id="cb236-5"><a href="#cb236-5"></a>         <span class="at">color_pelo =</span> eye_color, <span class="at">color_piel =</span> skin_color,</span>
<span id="cb236-6"><a href="#cb236-6"></a>         <span class="at">color_pelo =</span> hair_color) <span class="sc">|&gt;</span> </span>
<span id="cb236-7"><a href="#cb236-7"></a>  <span class="fu">relocate</span>(color_pelo, <span class="at">.after =</span> nombre)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-6-4">
<p>📝 Con los datos originales, comprueba cuántas modalidades únicas hay en la variable de color de pelo.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb237-2"><a href="#cb237-2"></a>  <span class="fu">distinct</span>(hair_color) <span class="sc">|&gt;</span> </span>
<span id="cb237-3"><a href="#cb237-3"></a>  <span class="fu">nrow</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-6-5">
<p>📝 Del dataset original, selecciona solo las variables numéricas y de tipo texto. Tras ello define una nueva variable llamada <code>under_18</code> que nos recategorice la variable de edad: <code>TRUE</code> si es menor de edad y <code>FALSE</code> en caso contrario</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb238-2"><a href="#cb238-2"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric) <span class="sc">|</span> <span class="fu">where</span>(is.character)) <span class="sc">|&gt;</span> </span>
<span id="cb238-3"><a href="#cb238-3"></a>  <span class="fu">mutate</span>(<span class="at">under_18 =</span> birth_year <span class="sc">&lt;</span> <span class="dv">18</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-6-6">
<p>📝 Del dataset original, crea una nueva columna llamada <code>auburn</code> (cobrizo/caoba) que nos diga TRUE si el color de pelo contiene dicha palabra y FALSE en caso contrario (reminder <code>str_detect()</code>).</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb239-2"><a href="#cb239-2"></a>  <span class="fu">mutate</span>(<span class="at">auburn =</span> <span class="fu">str_detect</span>(hair_color, <span class="st">"auburn"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-6-7">
<p>📝 Del dataset original, incluye una columna que calcule el IMC. Tras ello, crea una nueva variable que valga <code>NA</code> si no es humano, <code>delgadez</code> por debajo de 18, <code>normal</code> entre 18 y 30, <code>sobrepeso</code> por encima de 30.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb240-2"><a href="#cb240-2"></a>  <span class="fu">mutate</span>(<span class="at">IMC =</span> mass <span class="sc">/</span> ((height<span class="sc">/</span><span class="dv">100</span>)<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb240-3"><a href="#cb240-3"></a>         <span class="at">IMC_recat =</span> <span class="fu">case_when</span>(species <span class="sc">!=</span> <span class="st">"Human"</span> <span class="sc">~</span> <span class="cn">NA</span>,</span>
<span id="cb240-4"><a href="#cb240-4"></a>                               IMC <span class="sc">&lt;</span> <span class="dv">18</span> <span class="sc">~</span> <span class="st">"delgadez"</span>,</span>
<span id="cb240-5"><a href="#cb240-5"></a>                               IMC <span class="sc">&lt;</span> <span class="dv">30</span> <span class="sc">~</span> <span class="st">"normal"</span>,</span>
<span id="cb240-6"><a href="#cb240-6"></a>                               <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"sobrepeso"</span>),</span>
<span id="cb240-7"><a href="#cb240-7"></a>         <span class="at">.after =</span> name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="caso-11" class="slide level2">
<h2>🐣 Caso práctico</h2>
<p>Haciendo uso de todo lo aprendido, vamos a proceder a <span class="hl-yellow"><strong>crear una tabla con datos de bebés</strong></span> de tamaño <code>n = 20</code> en donde <span class="hl-yellow"><strong>simulemos el sexo de los bebés y su peso</strong></span></p>
<div class="fragment">
<ol type="1">
<li><p>Crea un <code>tibble</code> con dos columnas, una llamada <code>id_bebe</code> y otra llamada <code>sexo</code>. En el primer caso debe ir de 1 a 20. En el segundo caso, simula su sexo de manera que haya un 0.5 de probabilidad de <code>chico</code> y 0.5 de <code>chica</code>.</p></li>
<li><p>Conocido el sexo, crea una tercera columna llamada <code>peso</code> en la que simules dicho valor. Supondremos que para los chicos el peso sigue una distribución <span class="math inline">\(N(\mu = 3.266kg, \sigma = 0.514)\)</span> y que para las chicas sigue una distribución <span class="math inline">\(N(\mu = 3.155kg, \sigma = 0.495)\)</span>.</p></li>
</ol>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1"></a>tb <span class="ot">&lt;-</span> </span>
<span id="cb241-2"><a href="#cb241-2"></a>  <span class="fu">tibble</span>(<span class="st">"id_bebe"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,</span>
<span id="cb241-3"><a href="#cb241-3"></a>         <span class="st">"sexo"</span> <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"chico"</span>, <span class="st">"chica"</span>), <span class="at">size =</span> <span class="dv">20</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb241-4"><a href="#cb241-4"></a>microbenchmark<span class="sc">::</span><span class="fu">microbenchmark</span>(tb <span class="sc">|&gt;</span> </span>
<span id="cb241-5"><a href="#cb241-5"></a>  <span class="fu">mutate</span>(<span class="at">peso =</span></span>
<span id="cb241-6"><a href="#cb241-6"></a>           <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="fu">if_else</span>(sexo <span class="sc">==</span> <span class="st">"chico"</span>, <span class="fl">3.266</span>, <span class="fl">3.155</span>),</span>
<span id="cb241-7"><a href="#cb241-7"></a>                 <span class="at">sd =</span> <span class="fu">if_else</span>(sexo <span class="sc">==</span> <span class="st">"chico"</span>, <span class="fl">0.514</span>, <span class="fl">0.495</span>))), <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>) { tb[i, <span class="dv">3</span>] <span class="ot">=</span> <span class="fu">ifelse</span>(tb<span class="sc">$</span>sexo[i] <span class="sc">==</span> <span class="st">"chico"</span>, <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">3.266</span>, <span class="at">sd =</span> <span class="fl">0.514</span>), <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">3.155</span>, <span class="at">sd =</span> <span class="fl">0.495</span>)) }, <span class="at">times =</span> <span class="fl">1e3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Unit: microseconds
                                                                                                                                                      expr
                         mutate(tb, peso = rnorm(n = 20, mean = if_else(sexo == "chico",      3.266, 3.155), sd = if_else(sexo == "chico", 0.514, 0.495)))
 for (i in 1:20) {     tb[i, 3] = ifelse(tb$sexo[i] == "chico", rnorm(n = 1, mean = 3.266,          sd = 0.514), rnorm(n = 1, mean = 3.155, sd = 0.495)) }
    min      lq      mean  median      uq     max neval cld
  594.9  648.75  849.7468  701.70  816.15 59327.7  1000  a 
 2373.6 2522.30 2870.1816 2594.45 2867.25  8377.3  1000   b</code></pre>
</div>
</div>
</div>
</section></section>
<section>
<section id="summarise" class="title-slide slide level1 center">
<h1>Resúmenes</h1>
<p><span style="color:#444442;"><strong>Summarise y group_by(). Contar y resumir: estadísticas desagregadas por factores/grupos.</strong></span></p>
</section>
<section id="contar-count" class="slide level2">
<h2>Contar: count()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">contar</span>(var1, var2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">count</span>(var1, var2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Hasta ahora solo hemos transformado o consultado los datos pero no hemos generado estadísticas. Empecemos por lo sencillo: <span class="hl-yellow"><strong>¿cómo contar (frecuencias)?</strong></span></p>
<div class="fragment">
<p>Cuando lo usamos en solitario <code>count()</code> nos devolverá simplemente el número de registros , pero cuando lo usamos con variables <code>count()</code> calcula lo que se conoce como <span class="hl-yellow"><strong>frecuencias</strong></span>: <span class="hl-purple"><strong>número de elementos de cada modalidad</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">count</span>(sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  sex                n
  &lt;chr&gt;          &lt;int&gt;
1 female            16
2 hermaphroditic     1
3 male              60
4 none               6
5 &lt;NA&gt;               4</code></pre>
</div>
</div>
</div>
</section>
<section id="contar-count-1" class="slide level2">
<h2>Contar: count()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">contar</span>(var1, var2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">count</span>(var1, var2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Además si pasamos varias variables nos calcula lo que se conoce como una <span class="hl-yellow"><strong>tabla de contigencia</strong></span>. Con <code>sort = TRUE</code> nos devolverá el <span class="hl-purple"><strong>conteo ordenado</strong></span> (más frecuentes primero).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">count</span>(sex, gender, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  sex            gender        n
  &lt;chr&gt;          &lt;chr&gt;     &lt;int&gt;
1 male           masculine    60
2 female         feminine     16
3 none           masculine     5
4 &lt;NA&gt;           &lt;NA&gt;          4
5 hermaphroditic masculine     1
6 none           feminine      1</code></pre>
</div>
</div>
</section>
<section id="agrupar-group_by" class="slide level2">
<h2>Agrupar: group_by()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb251-2"><a href="#cb251-2"></a>  <span class="fu">agrupar</span>(var1, var2) <span class="sc">|&gt;</span> </span>
<span id="cb251-3"><a href="#cb251-3"></a>  <span class="fu">accion</span>() <span class="sc">|&gt;</span> </span>
<span id="cb251-4"><a href="#cb251-4"></a>  <span class="fu">desagrupar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb252-2"><a href="#cb252-2"></a>  <span class="fu">group_by</span>(var1, var2) <span class="sc">|&gt;</span> </span>
<span id="cb252-3"><a href="#cb252-3"></a>  <span class="fu">accion</span>() <span class="sc">|&gt;</span> </span>
<span id="cb252-4"><a href="#cb252-4"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Una de las <span class="hl-yellow"><strong>funciones más potentes</strong></span> a combinar con las acciones vistas es <code>group_by()</code>, que nos permitirá <span class="hl-yellow"><strong>agrupar nuestros registros</strong></span> previamente</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb253"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb253-2"><a href="#cb253-2"></a>  <span class="fu">group_by</span>(sex) <span class="sc">|&gt;</span></span>
<span id="cb253-3"><a href="#cb253-3"></a>  <span class="fu">count</span>() <span class="sc">|&gt;</span></span>
<span id="cb253-4"><a href="#cb253-4"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  sex                n
  &lt;chr&gt;          &lt;int&gt;
1 female            16
2 hermaphroditic     1
3 male              60
4 none               6
5 &lt;NA&gt;               4</code></pre>
</div>
</div>
</section>
<section id="agrupar-group_by-1" class="slide level2">
<h2>Agrupar: group_by()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb255-2"><a href="#cb255-2"></a>  <span class="fu">agrupar</span>(var1, var2) <span class="sc">|&gt;</span> </span>
<span id="cb255-3"><a href="#cb255-3"></a>  <span class="fu">accion</span>() <span class="sc">|&gt;</span> </span>
<span id="cb255-4"><a href="#cb255-4"></a>  <span class="fu">desagrupar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb256-2"><a href="#cb256-2"></a>  <span class="fu">group_by</span>(var1, var2) <span class="sc">|&gt;</span> </span>
<span id="cb256-3"><a href="#cb256-3"></a>  <span class="fu">accion</span>() <span class="sc">|&gt;</span> </span>
<span id="cb256-4"><a href="#cb256-4"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Cuando apliquemos <code>group_by()</code> es importante entender que <span class="hl-yellow"><strong>NO MODIFICA los datos</strong></span>, sino que nos crea una <span class="hl-yellow"><strong>variable de grupo</strong></span> (subtablas por cada grupo) que modificará las acciones futuras: las <span class="hl-purple"><strong>operaciones se aplicarán a cada subtabla por separado</strong></span></p>
<div class="fragment">
<p>Por ejemplo, imaginemos que queremos extraer el personaje más alto con <code>slice_max()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb257"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">slice_max</span>(height)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 14
  name      height  mass hair_color skin_color eye_color birth_year sex   gender
  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
1 Yarael P…    264    NA none       white      yellow            NA male  mascu…
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="agrupar-group_by-2" class="slide level2">
<h2>Agrupar: group_by()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb259-2"><a href="#cb259-2"></a>  <span class="fu">agrupar</span>(var1, var2) <span class="sc">|&gt;</span> </span>
<span id="cb259-3"><a href="#cb259-3"></a>  <span class="fu">accion</span>() <span class="sc">|&gt;</span> </span>
<span id="cb259-4"><a href="#cb259-4"></a>  <span class="fu">desagrupar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb260-2"><a href="#cb260-2"></a>  <span class="fu">group_by</span>(var1, var2) <span class="sc">|&gt;</span> </span>
<span id="cb260-3"><a href="#cb260-3"></a>  <span class="fu">accion</span>() <span class="sc">|&gt;</span> </span>
<span id="cb260-4"><a href="#cb260-4"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>¿Y si queremos <span class="hl-yellow"><strong>extraer el personaje más alto pero…de cada uno de los sexos</strong></span>?</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb261-2"><a href="#cb261-2"></a>  <span class="fu">group_by</span>(sex) <span class="sc">|&gt;</span> </span>
<span id="cb261-3"><a href="#cb261-3"></a>  <span class="fu">slice_max</span>(height) <span class="sc">|&gt;</span> </span>
<span id="cb261-4"><a href="#cb261-4"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 14
  name      height  mass hair_color skin_color eye_color birth_year sex   gender
  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
1 Taun We      213    NA none       grey       black             NA fema… femin…
2 Jabba De…    175  1358 &lt;NA&gt;       green-tan… orange           600 herm… mascu…
3 Yarael P…    264    NA none       white      yellow            NA male  mascu…
4 IG-88        200   140 none       metal      red               15 none  mascu…
5 Ric Olié     183    NA brown      fair       blue              NA &lt;NA&gt;  &lt;NA&gt;  
6 Quarsh P…    183    NA black      dark       brown             62 &lt;NA&gt;  &lt;NA&gt;  
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="agrupar-group_by-3" class="slide level2">
<h2>Agrupar: group_by()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb263-2"><a href="#cb263-2"></a>  <span class="fu">agrupar</span>(var1, var2) <span class="sc">|&gt;</span> </span>
<span id="cb263-3"><a href="#cb263-3"></a>  <span class="fu">accion</span>() <span class="sc">|&gt;</span> </span>
<span id="cb263-4"><a href="#cb263-4"></a>  <span class="fu">desagrupar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb264-2"><a href="#cb264-2"></a>  <span class="fu">group_by</span>(var1, var2) <span class="sc">|&gt;</span> </span>
<span id="cb264-3"><a href="#cb264-3"></a>  <span class="fu">accion</span>() <span class="sc">|&gt;</span> </span>
<span id="cb264-4"><a href="#cb264-4"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/tidydatatutor_1.jpg"></p>
</div><div class="column" style="width:50%;">
<p><img data-src="img/tidydatatutor_2.jpg"></p>
</div>
</div>
<p>La web <a href="https://tidydatatutor.com/" class="uri">https://tidydatatutor.com/</a> permite visualizar las operaciones de <code>{tidyverse}</code> (con el pipe antiguo)</p>
</section>
<section id="agrupar-group_by-4" class="slide level2">
<h2>Agrupar: group_by()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb265-2"><a href="#cb265-2"></a>  <span class="fu">agrupar</span>(var1, var2) <span class="sc">|&gt;</span> </span>
<span id="cb265-3"><a href="#cb265-3"></a>  <span class="fu">accion</span>() <span class="sc">|&gt;</span></span>
<span id="cb265-4"><a href="#cb265-4"></a>  <span class="fu">desagrupar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb266-2"><a href="#cb266-2"></a>  <span class="fu">group_by</span>(var1, var2) <span class="sc">|&gt;</span> </span>
<span id="cb266-3"><a href="#cb266-3"></a>  <span class="fu">accion</span>() <span class="sc">|&gt;</span></span>
<span id="cb266-4"><a href="#cb266-4"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Importante</strong></p>
</div>
<div class="callout-content">
<p>Recuerda siempre <span class="hl-red"><strong>hacer ungroup</strong></span> para eliminar la variable de grupo creada</p>
</div>
</div>
</div>
<div class="fragment">
<p>En la nueva versión de <code>{dplyr}</code> ahora se <span class="hl-yellow"><strong>permite incluir la variable de grupo</strong></span> en la llamada a muchas funciones con el argumento <code>by = ...</code> o <code>.by = ...</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">slice_max</span>(height, <span class="at">by =</span> sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  name                  height  mass hair_color skin_color       eye_color
  &lt;chr&gt;                  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;            &lt;chr&gt;    
1 Yarael Poof              264    NA none       white            yellow   
2 IG-88                    200   140 none       metal            red      
3 Taun We                  213    NA none       grey             black    
4 Jabba Desilijic Tiure    175  1358 &lt;NA&gt;       green-tan, brown orange   
5 Ric Olié                 183    NA brown      fair             blue     
6 Quarsh Panaka            183    NA black      dark             brown    </code></pre>
</div>
</div>
</div>
</section>
<section id="fila-a-fila-rowwise" class="slide level2">
<h2>Fila-a-fila: rowwise()</h2>
<p>Una opción muy útil usada antes de una operación también es <code>rowwise()</code>: toda <span class="hl-yellow"><strong>operación que venga después se aplicará en cada fila por separado</strong></span>. Por ejemplo, vamos a definir un conjunto dummy de notas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1"></a>notas <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"mates"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">7.5</span>, <span class="dv">8</span>, <span class="fl">9.1</span>, <span class="dv">3</span>),</span>
<span id="cb269-2"><a href="#cb269-2"></a>                <span class="st">"lengua"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">6</span>, <span class="fl">6.5</span>, <span class="fl">9.2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p>Si aplicamos la media directamente el valor será idéntico ya que nos ha hecho la media global, pero nos gustaría sacar una <span class="hl-yellow"><strong>media por registro</strong></span>. Para eso usaremos <code>rowwise()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb270"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1"></a>notas <span class="sc">|&gt;</span> </span>
<span id="cb270-2"><a href="#cb270-2"></a>  <span class="fu">rowwise</span>() <span class="sc">|&gt;</span> </span>
<span id="cb270-3"><a href="#cb270-3"></a>  <span class="fu">mutate</span>(<span class="at">media_curso =</span> <span class="fu">mean</span>(<span class="fu">c</span>(mates, lengua)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
# Rowwise: 
  mates lengua media_curso
  &lt;dbl&gt;  &lt;dbl&gt;       &lt;dbl&gt;
1   7.5    8          7.75
2   8      6          7   
3   9.1    6.5        7.8 
4   3      9.2        6.1 </code></pre>
</div>
</div>
</div>
</section>
<section id="resumir-summarise" class="slide level2">
<h2>Resumir: summarise()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">resumir</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">summarise</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Por último tenemos <code>summarise()</code>, que nos permitirá sacar resúmenes estadísticos. Por ejemplo, vamos a <span class="hl-yellow"><strong>calcular la media de las alturas</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb274-2"><a href="#cb274-2"></a>  <span class="fu">drop_na</span>(height) <span class="sc">|&gt;</span> </span>
<span id="cb274-3"><a href="#cb274-3"></a>  <span class="fu">summarise</span>(<span class="at">media_altura =</span> <span class="fu">mean</span>(height))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  media_altura
         &lt;dbl&gt;
1         174.</code></pre>
</div>
</div>
<div class="fragment">
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Cuidado</strong></p>
</div>
<div class="callout-content">
<p>Fíjate que <code>mutate()</code> devuelve <span class="hl-yellow"><strong>tantas filas como registros originales</strong></span>, mientras que con <code>summarise()</code> calcula un <span class="hl-purple"><strong>nuevo dataset de resumen</strong></span>, solo incluyendo aquello que esté indicado.</p>
</div>
</div>
</div>
</div>
</section>
<section id="resumir-summarise-1" class="slide level2">
<h2>Resumir: summarise()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">resumir</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb277"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">summarise</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Si además esto lo <span class="hl-yellow"><strong>combinamos con la agrupación</strong></span> de <code>group_by()</code> o <code>.by = ...</code>, en pocas líneas de código puedes obtener <span class="hl-purple"><strong>estadísticas desagreagadas</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb278"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb278-2"><a href="#cb278-2"></a>  <span class="fu">drop_na</span>(sex, height, mass) <span class="sc">|&gt;</span> </span>
<span id="cb278-3"><a href="#cb278-3"></a>  <span class="fu">summarise</span>(<span class="at">media_altura =</span> <span class="fu">mean</span>(height),</span>
<span id="cb278-4"><a href="#cb278-4"></a>            <span class="at">media_peso =</span> <span class="fu">mean</span>(mass),</span>
<span id="cb278-5"><a href="#cb278-5"></a>            <span class="at">.by =</span> sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  sex            media_altura media_peso
  &lt;chr&gt;                 &lt;dbl&gt;      &lt;dbl&gt;
1 male                   178.       81.0
2 none                   140        69.8
3 female                 169.       54.7
4 hermaphroditic         175      1358  </code></pre>
</div>
</div>
</section>
<section id="resumir-reframe" class="slide level2">
<h2>Resumir: reframe()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">resumir</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb281"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">reframe</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>En el nuevo <code>{dplyr}</code> han incluido <code>reframe()</code> para evitar problemas de <code>summarise()</code> cuando <span class="hl-yellow"><strong>devolvemos más de un valor por variable</strong></span>.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb282-2"><a href="#cb282-2"></a>  <span class="fu">drop_na</span>(mass) <span class="sc">|&gt;</span></span>
<span id="cb282-3"><a href="#cb282-3"></a>  <span class="fu">summarise</span>(<span class="fu">quantile</span>(mass))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Returning more (or less) than 1 row per `summarise()` group was deprecated in
dplyr 1.1.0.
ℹ Please use `reframe()` instead.
ℹ When switching from `summarise()` to `reframe()`, remember that `reframe()`
  always returns an ungrouped data frame and adjust accordingly.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 1
  `quantile(mass)`
             &lt;dbl&gt;
1             15  
2             55.6
3             79  
4             84.5
5           1358  </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb285"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb285-1"><a href="#cb285-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb285-2"><a href="#cb285-2"></a>  <span class="fu">drop_na</span>(mass) <span class="sc">|&gt;</span></span>
<span id="cb285-3"><a href="#cb285-3"></a>  <span class="fu">reframe</span>(<span class="fu">quantile</span>(mass))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 1
  `quantile(mass)`
             &lt;dbl&gt;
1             15  
2             55.6
3             79  
4             84.5
5           1358  </code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="selectores-across" class="slide level2">
<h2>Selectores: across()</h2>
<p>Un truco es <span class="hl-yellow"><strong>hacer uso de selectores</strong></span> <code>across()</code> y <code>where()</code>. El primero nos permite <span class="hl-purple"><strong>actuar sobre varias columnas por nombre</strong></span> (con <code>mutate()</code> o <code>summarise()</code>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb287"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">summarise</span>(<span class="at">medias =</span> <span class="fu">across</span>(height<span class="sc">:</span>mass, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.by =</span> sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  sex            medias$height  $mass
  &lt;chr&gt;                  &lt;dbl&gt;  &lt;dbl&gt;
1 male                    179.   81.0
2 none                    131.   69.8
3 female                  169.   54.7
4 hermaphroditic          175  1358  
5 &lt;NA&gt;                    181.   48  </code></pre>
</div>
</div>
<div class="fragment">
<p>El segundo, <code>where()</code>, nos permite hacer lo mismo pero <span class="hl-yellow"><strong>seleccionando por tipo</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb289"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb289-1"><a href="#cb289-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb289-2"><a href="#cb289-2"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.by =</span> <span class="fu">c</span>(sex, gender))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  sex            gender    height   mass birth_year
  &lt;chr&gt;          &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;
1 male           masculine   179.   81.0       85.5
2 none           masculine   140    69.8       53.3
3 female         feminine    169.   54.7       47.2
4 hermaphroditic masculine   175  1358        600  
5 &lt;NA&gt;           &lt;NA&gt;        181.   48         62  
6 none           feminine     96   NaN        NaN  </code></pre>
</div>
</div>
</div>
</section>
<section id="tu-turno-11b" class="slide level2">
<h2>💻 Tu turno</h2>
<p><span style="color:#444442;"><strong>Intenta realizar los siguientes ejercicios sin mirar las soluciones</strong></span></p>
<div class="panel-tabset">
<ul id="tabset-7" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-7-1"><span class="hl-yellow"><strong>Ejercicio 1</strong></span></a></li><li><a href="#tabset-7-2"><span class="hl-yellow"><strong>Ejercicio 2</strong></span></a></li><li><a href="#tabset-7-3"><span class="hl-yellow"><strong>Ejercicio 3</strong></span></a></li><li><a href="#tabset-7-4"><span class="hl-yellow"><strong>Ejercicio 4</strong></span></a></li><li><a href="#tabset-7-5"><span class="hl-yellow"><strong>Ejercicio 5</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-7-1">
<p>📝 Calcula cuántos personajes hay de cada especie, ordenados de más a menor frecuencia.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb291"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb291-1"><a href="#cb291-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">count</span>(species, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-7-2">
<p>📝 Tras eliminar ausentes en las variables de peso y estatura, añade una nueva variable que nos calcule el IMC de cada personaje, y determina el IMC medio de nuestros personajes desagregada por sexo</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb292"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb292-2"><a href="#cb292-2"></a>  <span class="fu">drop_na</span>(mass, height) <span class="sc">|&gt;</span> </span>
<span id="cb292-3"><a href="#cb292-3"></a>  <span class="fu">mutate</span>(<span class="at">IMC =</span> mass <span class="sc">/</span> ((height<span class="sc">/</span><span class="dv">100</span>)<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb292-4"><a href="#cb292-4"></a>  <span class="fu">summarise</span>(<span class="at">IMC_medio =</span> <span class="fu">mean</span>(IMC), <span class="at">.by =</span> sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-7-3">
<p>📝 Obtén el personaje más joven por cada sexo.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb293"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb293-1"><a href="#cb293-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb293-2"><a href="#cb293-2"></a>  <span class="fu">slice_min</span>(birth_year, <span class="at">by =</span> sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-7-4">
<p>📝 Obtén la edad del personaje más joven y más viejo de cada sexo.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb294"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb294-1"><a href="#cb294-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb294-2"><a href="#cb294-2"></a>  <span class="fu">drop_na</span>(birth_year) <span class="sc">|&gt;</span></span>
<span id="cb294-3"><a href="#cb294-3"></a>  <span class="fu">summarise</span>(<span class="fu">min</span>(birth_year), <span class="fu">max</span>(birth_year), <span class="at">.by =</span> sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-7-5">
<p>📝 Determina la cantidad de personajes en cada década (echa un vistazo a <code>round()</code>, primero sin desagregar y luego desagregado por sexo.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb295"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb295-1"><a href="#cb295-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb295-2"><a href="#cb295-2"></a>  <span class="fu">count</span>(<span class="at">birth_decade =</span> <span class="fu">round</span>(birth_year, <span class="sc">-</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="caso-12" class="slide level2">
<h2>🐣 Caso práctico</h2>
<p>Vamos antes a hacer un <span class="hl-yellow"><strong>repaso de lo aprendido</strong></span> en <code>{tidyverse}</code></p>
<ol type="1">
<li>Carga la tabla billboard del paquete <code>{tidyr}</code>.</li>
</ol>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb296"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb296-1"><a href="#cb296-1"></a>billboard</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol start="2" type="1">
<li>Antes de nada, selecciona solo las <span class="hl-yellow"><strong>primeras 52 semanas</strong></span>. Tras ello convierte el dataset a <span class="hl-yellow"><strong>tidydata</strong></span> con los formatos y tipos adecuados para cada variable</li>
</ol>
<div class="fragment">
<ol start="3" type="1">
<li>Extrae la <span class="hl-yellow"><strong>lista de artistas distintos</strong></span> que aparecen en la tabla, incluyendo <span class="hl-yellow"><strong>cuántas veces</strong></span> aparece cada uno.</li>
</ol>
</div>
<div class="fragment">
<ol start="4" type="1">
<li>Determina <span class="hl-yellow"><strong>cuántas canciones tiene cada artistal</strong></span></li>
</ol>
</div>
</section>
<section id="caso-práctico" class="slide level2">
<h2>🐣 Caso práctico</h2>
<ol start="5" type="1">
<li>Determina las <span class="hl-yellow"><strong>5 canciones que más semanas</strong></span> aparecen en la lista de éxitos.</li>
</ol>
<div class="fragment">
<ol start="6" type="1">
<li>Determina <span class="hl-yellow"><strong>para cada artista la canción que más semanas</strong></span> aparece en la lista de éxitos.</li>
</ol>
</div>
<div class="fragment">
<ol start="7" type="1">
<li>Determina el <span class="hl-yellow"><strong>artista con más canciones</strong></span> en la lista</li>
</ol>
</div>
</section>
<section id="caso-práctico-1" class="slide level2">
<h2>🐣 Caso práctico</h2>
<ol start="8" type="1">
<li>Calcula la <span class="hl-yellow"><strong>posición más alta</strong></span> en la que ha estado cada canción. Calcula la posición más alta en la que ha estado un artista</li>
</ol>
<div class="fragment">
<ol start="9" type="1">
<li>Realiza un muestreo aleatorio estratificado, extrayendo el 50% de los datos pero manteniendo la proporción de datos entre los distintos cuatrimestres.</li>
</ol>
</div>
</section></section>
<section>
<section id="quarto" class="title-slide slide level1 center">
<h1>Comunicar: Quarto</h1>
<p><span style="color:#444442;"><strong>Comunicar resultados y material docente: rmd y Quarto</strong></span></p>
</section>
<section id="comunicar-rmd-y-quarto" class="slide level2">
<h2>Comunicar: rmd y Quarto</h2>
<p>Una de las <span class="hl-yellow"><strong>principales fortalezas</strong></span> de <code>R</code> es la <span class="hl-yellow"><strong>facilidad para generar informes, libros, webs, apuntes y hasta diapositivas</strong></span> (este mismo material por ejemplo). Para ello <span class="hl-purple"><strong>instalaremos</strong></span> antes</p>
<div class="columns">
<div class="column" style="width:40%;">
<ul>
<li>el paquete <code>{rmarkdown}</code> (para generar archivos <code>.rmd</code>)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1"></a><span class="fu">install.packages</span>(<span class="st">"rmarkdown"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>instalar <a href="https://quarto.org/docs/get-started/"><strong>Quarto</strong></a> (el «nuevo» <code>.rmd</code> ahora como <code>.qmd</code>)</li>
</ul>
</div><div class="column" style="width:60%;">
<p><img data-src="img/quarto.png"></p>
</div>
</div>
</section>
<section id="comunicar-rmd-y-quarto-1" class="slide level2">
<h2>Comunicar: rmd y Quarto</h2>
<p>Los archivos de extensión <code>.qmd</code> (o <code>.rmd</code>) nos permitirán fácilmente combinar:</p>
<ul>
<li><span class="hl-yellow"><strong>Markdown</strong></span>: <span class="hl-purple"><strong>lenguaje tipado</strong></span> que nos permite crear contenido simple (tipo wordpress, con texto, <strong>negritas</strong>, <em>cursivas</em>, etc) con un diseño legible.</li>
</ul>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Matemáticas (latex)</strong></span>: lenguaje para escribir notación matemática como <span class="math inline">\(x^2\)</span> o <span class="math inline">\(\sqrt{y}\)</span> o <span class="math inline">\(\int_{a}^{b} f(x) dx\)</span></li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Código y salidas</strong></span>: podremos no solo mostrar el paso final sino el código que has ido realizando (no solo en <code>R</code>), con <span class="hl-purple"><strong>cajitas de código llamadas chunks</strong></span>.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Imágenes, <span class="hl-yellow"><strong>gráficas</strong></span>, tablas, estilos (css, js), etc.</li>
</ul>
</div>
</section>
<section id="comunicar-rmd-y-quarto-2" class="slide level2">
<h2>Comunicar: rmd y Quarto</h2>
<p>La principal ventaja de realizar este tipo de material en Quarto/Rmarkdown es que, al hacerlo desde <code>RStudio</code>, puedes generar un <span class="hl-yellow"><strong>informe o una presentación sin salirte del entorno de programación</strong></span> en el que estás trabajando</p>
<p>De esta forma podrás analizar los datos, resumirlos y a la vez comunicarlos con la misma herramienta.</p>
<div class="fragment">
<p>Recientemente el equipo de <code>RStudio</code> desarrolló <span class="hl-yellow"><strong>Quarto</strong></span>, una versión mejorada de Rmarkdown (archivos <code>.qmd</code>), con un formato un poco más estético y simple. Tienes toda la documentación y ejemplos en <a href="https://quarto.org/"><strong>https://quarto.org/</strong></a></p>
</div>
</section>
<section id="nuestro-primer-informe" class="slide level2">
<h2>Nuestro primer informe</h2>
<div class="columns">
<div class="column" style="width:55%;">
<p><img data-src="img/quarto-create.png"></p>
</div><div class="column" style="width:45%;">
<p>Vamos a crear el <span class="hl-yellow"><strong>primer fichero rmarkdown con Quarto</strong></span> con extensión <code>.qmd</code>. Para ello solo necesitaremos hacer click en</p>
<p><code>File &lt;&lt; New File &lt;&lt; Quarto Document</code></p>
</div>
</div>
</section>
<section id="nuestro-primer-informe-1" class="slide level2">
<h2>Nuestro primer informe</h2>
<div class="columns">
<div class="column" style="width:45%;">
<p><img data-src="img/quarto-format.png"></p>
</div><div class="column" style="width:55%;">
<p>Tras hacerlo nos aparecerán varias <span class="hl-yellow"><strong>opciones de formatos de salida</strong></span>:</p>
<ul>
<li>archivo <code>.pdf</code></li>
<li>archivo <code>.html</code> (<span class="hl-yellow"><strong>recomendable</strong></span>): documento dinámico, permite la interacción con el usuario, como una «página web».</li>
<li>archivo <code>.doc</code> (nada recomendable)</li>
</ul>
</div>
</div>
<div class="fragment">
<p>De momento dejaremos marcado el <span class="hl-yellow"><strong>formato HTML que viene por defecto</strong></span>, y escribiremos el <span class="hl-yellow"><strong>título</strong></span> de nuestro documento. Tras ello tendremos nuestro <span class="hl-yellow"><strong>archivo .qmd</strong></span> (ya no es un script .R como los que hemos abierto hasta ahora).</p>
</div>
</section>
<section id="nuestro-primer-informe-2" class="slide level2">
<h2>Nuestro primer informe</h2>
<div class="columns">
<div class="column" style="width:60%;">
<p><img data-src="img/quarto-example.png"></p>
</div><div class="column" style="width:40%;">
<p>Deberías tener algo similar a la captura de la imagen con <span class="hl-yellow"><strong>dos modos de edición</strong></span>: <code>Source</code> (con código, la opción recomendada hasta que lo domines) y <code>Visual</code> (más parecido a un blog)</p>
</div>
</div>
<p>Para <span class="hl-yellow"><strong>ejecutar TODO el documento</strong></span> debes clickar <code>Render on Save</code> y darle a guardar.</p>
</section>
<section id="cabecera-de-un-qmd" class="slide level2">
<h2>Cabecera de un qmd</h2>

<img data-src="img/quarto-prueba-html.png" class="r-stretch"><p>Deberías haber obtenido una <span class="hl-yellow"><strong>salida en html similar a esta</strong></span> (y se te ha generado en tu ordenador un <span class="hl-yellow"><strong>archivo html</strong></span>)</p>
</section>
<section id="nuestro-primer-informe-3" class="slide level2">
<h2>Nuestro primer informe</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/quarto-example.png"></p>
</div><div class="column" style="width:50%;">
<p>Un fichero <code>.qmd</code> se <span class="hl-yellow"><strong>divide básicamente en tres partes</strong></span>:</p>
<ul>
<li><p><span class="hl-yellow"><strong>Cabecera</strong></span>: la parte que tienes al inicio entre <code>---</code>.</p></li>
<li><p><span class="hl-yellow"><strong>Texto</strong></span>: que podremos formatear y mejorar con negritas (escrito como <strong>negritas</strong>, con doble astérisco al inicio y final), cursivas (<em>cursivas</em>, con barra baja al inicio y final) o destacar nombres de funciones o variables de R. Puedes añadir ecuaciones como <span class="math inline">\(x^2\)</span> (he escrito <code>$x^2$</code>, entre dólares).</p></li>
<li><p><span class="hl-yellow"><strong>Código R</strong></span></p></li>
</ul>
</div>
</div>
</section>
<section id="cabecera-de-un-qmd-1" class="slide level2">
<h2>Cabecera de un qmd</h2>
<p>La <span class="hl-yellow"><strong>cabecera están en formato YAML</strong></span> y contiene los <span class="hl-yellow"><strong>metadatos</strong></span> del documento:</p>
<div class="columns">
<div class="column" style="width:30%;">
<p><img data-src="img/quarto-cabecera.png"></p>
</div><div class="column" style="width:70%;">
<ul>
<li><code>title</code> y <code>subtitle</code>: el título/subtítulo del documento</li>
<li><code>author</code>: autor del mismo</li>
<li><code>date</code>: fecha</li>
<li><code>format</code>: formato de salida (podremos personalizar)
<ul>
<li><code>theme</code>: si tienes algún archivo de estilos</li>
<li><code>toc</code>: si quieres índice o no</li>
<li><code>toc-location</code>: posición del índice</li>
<li><code>toc-title</code>: título del índice</li>
<li><code>toc-depth</code>: profundidad del índice</li>
</ul></li>
<li><code>editor</code>: si estás en modo visual o source.</li>
</ul>
</div>
</div>
</section>
<section id="texto-de-un-qmd" class="slide level2">
<h2>Texto de un qmd</h2>
<p>Respecto a la escritura solo hay una <span class="hl-yellow"><strong>cosa importante</strong></span>: salvo que indiquemos lo contrario, <span class="hl-yellow"><strong>TODO lo que vamos a escribir es texto (normal)</strong></span>. No código R.</p>
<div class="columns">
<div class="column" style="width:35%;">
<p><img data-src="img/quarto-prueba-qmd2.png" width="350"> <img data-src="img/quarto-prueba-html2.png" width="320"></p>
</div><div class="column" style="width:65%;">
<p>Vamos a empezar escribiendo una sección al inicio (<code># Intro</code> y detrás por ej. la frase</p>
<blockquote>
<p>Este material ha sido diseñado por el profesor Javier Álvarez Liébana, docente en la Universidad Complutense de Madrid</p>
</blockquote>
<p>Además al <code>Running Code</code> le añadiremos una almohadilla <code>#</code>: las <span class="hl-yellow"><strong>almohadillas FUERA DE CHUNKS</strong></span> nos servirán para crear <span class="hl-yellow"><strong>epígrafes (secciones)</strong></span> en el documento</p>
</div>
</div>
</section>
<section id="índice-de-un-qmd" class="slide level2">
<h2>Índice de un qmd</h2>
<div class="columns">
<div class="column" style="width:40%;">
<p><img data-src="img/quarto-indice-qmd-2.png" width="370"> <img data-src="img/quarto-indice-html2.png" width="370"></p>
</div><div class="column" style="width:60%;">
<p>Para que el <span class="hl-yellow"><strong>índice capture dichas secciones</strong></span> modificaremos la cabecera del archivo como se observa en la imagen (puedes cambiar la localización del índice y el título si quieres para probar).</p>
</div>
</div>
</section>
<section id="texto-en-un-qmd" class="slide level2">
<h2>Texto en un qmd</h2>
<p>Vamos a <span class="hl-yellow"><strong>personalizar un poco el texto</strong></span> haciendo lo siguiente:</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/quarto-texto-mejorado-qmd.png" width="370"> <img data-src="img/quarto-texto-mejorado-html.png" width="370"></p>
</div><div class="column" style="width:50%;">
<ul>
<li><p>Vamos a añadir <span class="hl-yellow"><strong>negrita al nombre</strong></span> (poniendo ** al inicio y al final).</p></li>
<li><p>Vamos añadir <span class="hl-yellow"><strong>cursiva</strong></span> a la palabra material (poniendo _ al inicio y al final).</p></li>
<li><p>Vamos añadir un <span class="hl-yellow"><strong>enlace</strong></span> <a href="https://www.ucm.es" class="uri">https://www.ucm.es</a>, asociándolo al nombre de la Universidad. Para ello el título lo ponemos entre corchetes y justo detrás el enlace entre paréntesis <code>[«Universidad Complutense de Madrid»](https://www.ucm.es)</code></p></li>
</ul>
</div>
</div>
</section>
<section id="código-en-un-qmd" class="slide level2">
<h2>Código en un qmd</h2>
<p>Para <span class="hl-yellow"><strong>añadir código R</strong></span> debemos crear nuestras <span class="hl-yellow"><strong>cajas de código llamadas chunks</strong></span>: altos en el camino en nuestro texto markdown donde podremos incluir código de casi cualquier lenguaje (y sus salidas).</p>
<p>&nbsp;</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/quarto-chunk-qmd.png" width="470"></p>
</div><div class="column" style="width:50%;">
<p>Para incluir uno deberá de ir <span class="hl-yellow"><strong>encabezado</strong></span> de la siguiente forma tienes un atajo <code>Command + Option + I</code> (Mac) o <code>Ctrl + Shift + I</code> (Windows)</p>
</div>
</div>
</section>
<section id="código-en-un-qmd-1" class="slide level2">
<h2>Código en un qmd</h2>
<p>Dentro de dicha cajita (que tiene ahora otro color en el documento) <span class="hl-yellow"><strong>escribiremos código R</strong></span> como lo veníamos haciendo hasta ahora en los scripts.</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/quarto-chunk-1-qmd.png" width="410"> <img data-src="img/quarto-chunk-1-html.png" width="410"></p>
</div><div class="column" style="width:50%;">
<p>Vamos por ejemplo a definir dos variables y su suma de la siguiente manera, escribiendo dicho código en nuestro <code>.qmd</code> (dentro de ese chunk)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb298"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb298-1"><a href="#cb298-1"></a><span class="co"># Código R</span></span>
<span id="cb298-2"><a href="#cb298-2"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb298-3"><a href="#cb298-3"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb298-4"><a href="#cb298-4"></a>x <span class="sc">+</span> y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="etiquetando-chunks" class="slide level2">
<h2>Etiquetando chunks</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/quarto-tag-chunks-qmd.png" width="400"> <img data-src="img/quarto-tag-chunks-html.png" width="400"></p>
</div><div class="column" style="width:50%;">
<p>Los chunks pueden tener un <span class="hl-yellow"><strong>nombre o etiqueta</strong></span>, de forma que podamos referenciarlos de nuevo para no repetir código.</p>
</div>
</div>
</section>
<section id="ejecutando-chunks" class="slide level2">
<h2>Ejecutando chunks</h2>
<div class="columns">
<div class="column" style="width:40%;">
<p><img data-src="img/quarto-inline-qmd.png" width="400"> <img data-src="img/quarto-inline-html.png" width="380"></p>
</div><div class="column" style="width:60%;">
<p>En cada chunk aparecen <span class="hl-yellow"><strong>dos botones</strong></span>:</p>
<ul>
<li><p>botón de <span class="hl-yellow"><strong>play</strong></span>: activa la <span class="hl-yellow"><strong>ejecución y salida de ese chunk particular</strong></span> (lo puedes visualizar dentro de tu propio <code>RStudio</code>)</p></li>
<li><p>botón de <span class="hl-yellow"><strong>rebobinar</strong></span>: activa la <span class="hl-yellow"><strong>ejecución y salida de todos los chunk hasta ese</strong></span> (sin llegar a él)</p></li>
</ul>
<p>&nbsp;</p>
<p>Además podemos <span class="hl-yellow"><strong>incluir código R dentro de la línea de texto</strong></span> (en lugar de mostrar el texto x ejecuta el código R mostrando la variable).</p>
</div>
</div>
</section>
<section id="personalización-de-chunks" class="slide level2">
<h2>Personalización de chunks</h2>
<p>Los <span class="hl-yellow"><strong>chunks podemos personalizarlos</strong></span> con opciones al inicio del chunk precedido de <code>#|</code>:</p>
<ul>
<li><p><code>#| echo: false</code>: <span class="hl-green"><strong>ejecuta código</strong></span> y se <span class="hl-green"><strong>muestra resultado</strong></span> pero <span class="hl-red"><strong>no visualiza código</strong></span> en la salida.</p></li>
<li><p><code>#| include: false</code>: <span class="hl-green"><strong>ejecuta código</strong></span> pero <span class="hl-red"><strong>no muestra resultado</strong></span> y <span class="hl-red"><strong>no visualiza código</strong></span> en la salida.</p></li>
<li><p><code>#| eval: false</code>: <span class="hl-red"><strong>no ejecuta código</strong></span>, <span class="hl-red"><strong>no muestra resultado</strong></span> pero <span class="hl-green"><strong>sí visualiza código</strong></span> en la salida.</p></li>
<li><p><code>#| message: false</code>: <span class="hl-green"><strong>ejecuta código</strong></span> pero <span class="hl-red"><strong>no muestra mensajes de salida</strong></span>.</p></li>
<li><p><code>#| warning: false</code>: <span class="hl-green"><strong>ejecuta código</strong></span> pero <span class="hl-red"><strong>no muestra mensajes de warning</strong></span>.</p></li>
<li><p><code>#| error: true</code>: <span class="hl-green"><strong>ejecuta código</strong></span> y <span class="hl-green"><strong>permite que haya errores</strong></span> mostrando el mensaje de error en la salida.</p></li>
</ul>

<img data-src="img/quarto-options-chunk.png" width="380" class="r-stretch"><p>Estas opciones podemos aplicarlas chunk a chunk o fijar los parámetros de forma global con <code>knitr::opts_chunk$set()</code> al inicio del documento (dentro de un chunk).</p>
</section>
<section id="organizando-qmd" class="slide level2">
<h2>Organizando qmd</h2>
<p>Además de texto y código podemos introducir lo siguiente:</p>
<ul>
<li><p><span class="hl-yellow"><strong>Ecuaciones</strong></span>: puedes añadir además ecuaciones como <span class="math inline">\(x^2\)</span> (he escrito <code>$x^2$</code>, la ecuación entre dólares).</p></li>
<li><p><span class="hl-yellow"><strong>Listas</strong></span>: puedes itemizar elementos poniendo <code>*</code></p></li>
</ul>
<p><code>* Paso 1: ...</code></p>
<p><code>* Paso 2: ...</code></p>
<ul>
<li><span class="hl-yellow"><strong>Cross-references</strong></span>: puedes etiquetar partes del documento (la etiqueta se construye con <code>{#nombre-seccion}</code>) y llamarlas luego con <code>[Sección](@nombre-seccion)</code></li>
</ul>
</section>
<section id="gráficasimágenes-en-qmd" class="slide level2">
<h2>Gráficas/imágenes en qmd</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/quarto-fig-qmd.png" width="340"> <img data-src="img/quarto-fig-html.png" width="390"></p>
</div><div class="column" style="width:50%;">
<p>Por último, también podemos <span class="hl-yellow"><strong>añadir pies de gráficas o imágenes</strong></span> añadiendo <code>#| fig-cap: "..."</code></p>
</div>
</div>
<div class="fragment">
<div class="columns">
<div class="column" style="width:65%;">
<p>Fíjate que el <span class="hl-yellow"><strong>caption está en el margen</strong></span> (por ejemplo). Puedes cambiarlo introduciendo <span class="hl-yellow"><strong>ajustes en la cabecera</strong></span> (todo lo relativo a figuras empieza por <code>fig-</code>, y puedes ver las opciones tabulando). Tienes más información en <strong><a href="https://quarto.org/" class="uri">https://quarto.org/</a></strong></p>
</div><div class="column" style="width:35%;">
<p><img data-src="img/quarto-cabecera-desplegable.png" width="400"></p>
</div>
</div>
</div>
</section>
<section id="añadir-estilos" class="slide level2">
<h2>Añadir estilos</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/quarto-estilos-qmd.png" width="400"> <img data-src="img/quarto-estilos-html.png" width="400"></p>
</div><div class="column" style="width:50%;">
<p>Por último puedes añadir un <span class="hl-yellow"><strong>tema personalizado</strong></span> incluyendo un <span class="hl-yellow"><strong>archivo de estilos</strong></span> (archivo en formato <code>.scss</code> o <code>.css</code>). Tenéis disponible un archivo de estilos en <a href="https://github.com/dadosdelaplace/seminario-R-biods" class="uri">https://github.com/dadosdelaplace/seminario-R-biods</a>.</p>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Importante</strong></p>
</div>
<div class="callout-content">
<p>El archivo de estilos debe estar en la misma carpeta que el archivo <code>.qmd</code></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="generar-diapositivas" class="slide level2">
<h2>Generar diapositivas</h2>
<p>El proceso es equivalente con tres cambios:</p>
<ul>
<li><span class="hl-yellow"><strong>Quarto presentation</strong></span>: ahora en <code>File &gt; New File</code> hay que hacer click en <code>Quarto Presentation</code>. La cabecera ahora será ahora parecido a esto (entre otras personalizaciones posibles)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb300"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb300-1"><a href="#cb300-1"></a>title<span class="sc">:</span> <span class="st">"Tidyverse y Quarto"</span></span>
<span id="cb300-2"><a href="#cb300-2"></a>subtitle<span class="sc">:</span> <span class="st">"Seminario de tidyverse y Quarto para docencia e investigación"</span></span>
<span id="cb300-3"><a href="#cb300-3"></a>author<span class="sc">:</span> <span class="st">"Seminarios BioDS • curso 2023-2024"</span></span>
<span id="cb300-4"><a href="#cb300-4"></a>affiliation<span class="sc">:</span> Facultad de Estudios Estadísticos (UCM)</span>
<span id="cb300-5"><a href="#cb300-5"></a>lang<span class="sc">:</span> es</span>
<span id="cb300-6"><a href="#cb300-6"></a>format<span class="sc">:</span> </span>
<span id="cb300-7"><a href="#cb300-7"></a>  revealjs<span class="sc">:</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="generar-diapositivas-1" class="slide level2">
<h2>Generar diapositivas</h2>
<p>El proceso es equivalente con tres cambios:</p>
<ul>
<li><span class="hl-yellow"><strong>Separado de diapositivas</strong></span>: para indicarle el cambio de diapositiva basta con escribir <code>. . .</code> (tres puntos separados por espacios y un salto de línea)</li>
</ul>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Formato multicolumna</strong></span>: el formato diapositivas permite el modo multicolumna (importante los espacios y no espacios del código ya que no es <code>R</code> sino revealjs)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb301"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1"></a><span class="sc">:::</span><span class="er">:</span> columns</span>
<span id="cb301-2"><a href="#cb301-2"></a><span class="sc">:::</span> {.column width<span class="ot">=</span><span class="st">"40%"</span>}</span>
<span id="cb301-3"><a href="#cb301-3"></a>  algo en la primera <span class="fu">columna</span> (más estrecha)</span>
<span id="cb301-4"><a href="#cb301-4"></a><span class="sc">:::</span></span>
<span id="cb301-5"><a href="#cb301-5"></a><span class="er">:::</span> {.column width<span class="ot">=</span><span class="st">"60%"</span>}</span>
<span id="cb301-6"><a href="#cb301-6"></a>  algo en la segunda <span class="fu">columna</span> (más ancha)</span>
<span id="cb301-7"><a href="#cb301-7"></a><span class="sc">:::</span></span>
<span id="cb301-8"><a href="#cb301-8"></a><span class="er">::::</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section></section>
<section>
<section id="importar" class="title-slide slide level1 center">
<h1>Importar y exportar</h1>
<p><span style="color:#444442;"><strong>Importar/exportar datos en R</strong></span></p>
</section>
<section id="importarexportar-datos" class="slide level2">
<h2>Importar/exportar datos</h2>
<p>Hasta ahora solo hemos usado datos cargados ya en paquetes pero muchas veces <span class="hl-yellow"><strong>necesitaremos importar datos de manera externa</strong></span>. Una de las principales <span class="hl-yellow"><strong>fortalezas</strong></span> de <code>R</code> es que podemos importar datos de manera muy sencilla en distintos formatos:</p>
<ul>
<li><span class="hl-yellow"><strong>Formatos nativos de R</strong></span>: formatos <code>.rda</code>, <code>.RData</code> y <code>.rds</code></li>
</ul>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Datos rectangulares (tabulados)</strong></span>: formatos <code>.csv</code> y <code>.tsv</code></li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Datos sin tabular</strong></span>: formato <code>.txt</code></li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Datos en excel</strong></span>: formatos <code>.xls</code> y <code>.xlsx</code></li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Datos desde SAS/Stata/SPSS</strong></span>: formatos <code>.sas7bdat</code>, <code>.sav</code> y <code>.dat</code></li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Datos desde API</strong></span>: Google Drive, aemet, catastro, twitter, spotify, etc</li>
</ul>
</div>
</section>
<section id="datos-rectangulares-readr" class="slide level2">
<h2>Datos rectangulares: readr</h2>
<p>El paquete <code>{readr}</code> dentro del entorno <code>{tidyverse}</code> contiene distintas funciones útiles para la <span class="hl-yellow"><strong>carga de datos rectangulares (sin formatear)</strong></span>.</p>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><code>read_csv()</code>: archivos <code>.csv</code> cuyo <span class="hl-purple"><strong>separador sea la coma</strong></span></li>
<li><code>read_csv2()</code>: <span class="hl-purple"><strong>punto y coma</strong></span></li>
<li><code>read_tsv()</code>: <span class="hl-purple"><strong>tabulador</strong></span>.</li>
<li><code>read_table()</code>: <span class="hl-purple"><strong>espacio</strong></span>.</li>
<li><code>read_delim()</code>: función genérica para <span class="hl-purple"><strong>archivos delimitados por caracteres</strong></span>.</li>
</ul>
</div><div class="column" style="width:50%;">
<p><img data-src="img/data-import-readr.png"></p>
</div>
</div>
<p>Todos necesitan como <strong>argumento la ruta del archivo</strong> amén de <strong>otros opcionales</strong> (saltar o no cabecera, decimales, etc). Ver más en <a href="https://readr.tidyverse.org/" class="uri">https://readr.tidyverse.org/</a></p>
</section>
<section id="datos-tabulados-.csv-.tsv" class="slide level2">
<h2>Datos tabulados (.csv, .tsv)</h2>
<p>La principal ventaja de <code>{readr}</code> es que <span class="hl-yellow"><strong>automatiza el formateo</strong></span> para pasar de un archivo plano (sin formato) a un tibble (en filas y columnas, con formato).</p>
<div class="fragment">
<ul>
<li>Archivo <code>.csv</code>: con <code>read_csv()</code> cargaremos archivos <span class="hl-purple"><strong>separados por coma</strong></span>, pasando como <span class="hl-yellow"><strong>argumento la ruta</strong></span> en <code>file = ...</code>. Vamos a importar el dataset <code>chickens.csv</code> (sobre pollos de dibujos animados, why not). Si te fijas en la salida nos proporciona el tipo de variables.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb302"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb302-1"><a href="#cb302-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb302-2"><a href="#cb302-2"></a>chickens <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"./datos/chickens.csv"</span>)</span>
<span id="cb302-3"><a href="#cb302-3"></a>chickens</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 4
  chicken                 sex     eggs_laid motto                               
  &lt;chr&gt;                   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;                               
1 Foghorn Leghorn         rooster         0 That's a joke, ah say, that's a jok…
2 Chicken Little          hen             3 The sky is falling!                 
3 Ginger                  hen            12 Listen. We'll either die free chick…
4 Camilla the Chicken     hen             7 Bawk, buck, ba-gawk.                
5 Ernie The Giant Chicken rooster         0 Put Captain Solo in the cargo hold. </code></pre>
</div>
</div>
</div>
</section>
<section id="datos-tabulados-.csv-.tsv-1" class="slide level2">
<h2>Datos tabulados (.csv, .tsv)</h2>
<p>El <span class="hl-yellow"><strong>formato de las variables</strong></span> normalmente lo hará <code>read_csv()</code> de forma <span class="hl-yellow"><strong>automática</strong></span>, y podemos consultarlo con <code>spec()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb304"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb304-1"><a href="#cb304-1"></a><span class="fu">spec</span>(chickens)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>cols(
  chicken = col_character(),
  sex = col_character(),
  eggs_laid = col_double(),
  motto = col_character()
)</code></pre>
</div>
</div>
</section>
<section id="datos-tabulados-.csv-.tsv-2" class="slide level2">
<h2>Datos tabulados (.csv, .tsv)</h2>
<p>Aunque lo haga normalmente bien de forma automática podemos <span class="hl-yellow"><strong>especificar el formato explícitamente</strong></span> en <code>col_types = list()</code> (en formato lista, con <code>col_xxx()</code> para cada tipo de variable, por ejemplo una la pondremos como cualitativa o factor).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb306"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb306-1"><a href="#cb306-1"></a>chickens <span class="ot">&lt;-</span></span>
<span id="cb306-2"><a href="#cb306-2"></a>  <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"./datos/chickens.csv"</span>,</span>
<span id="cb306-3"><a href="#cb306-3"></a>           <span class="at">col_types =</span> <span class="fu">list</span>(<span class="fu">col_character</span>(), <span class="fu">col_factor</span>(), <span class="fu">col_double</span>(), <span class="fu">col_character</span>()))</span>
<span id="cb306-4"><a href="#cb306-4"></a>chickens</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 4
  chicken                 sex     eggs_laid motto                               
  &lt;chr&gt;                   &lt;fct&gt;       &lt;dbl&gt; &lt;chr&gt;                               
1 Foghorn Leghorn         rooster         0 That's a joke, ah say, that's a jok…
2 Chicken Little          hen             3 The sky is falling!                 
3 Ginger                  hen            12 Listen. We'll either die free chick…
4 Camilla the Chicken     hen             7 Bawk, buck, ba-gawk.                
5 Ernie The Giant Chicken rooster         0 Put Captain Solo in the cargo hold. </code></pre>
</div>
</div>
</section>
<section id="datos-tabulados-.csv-.tsv-3" class="slide level2">
<h2>Datos tabulados (.csv, .tsv)</h2>
<p>Incluso podemos indicar que <span class="hl-yellow"><strong>variables que queremos seleccionar</strong></span> (sin ocupar memoria), indicándoselo en <code>col_select = ...</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb308"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb308-1"><a href="#cb308-1"></a>chickens <span class="ot">&lt;-</span></span>
<span id="cb308-2"><a href="#cb308-2"></a>  <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"./datos/chickens.csv"</span>,</span>
<span id="cb308-3"><a href="#cb308-3"></a>           <span class="at">col_select =</span> <span class="fu">c</span>(chicken, sex, eggs_laid))</span>
<span id="cb308-4"><a href="#cb308-4"></a>chickens</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  chicken                 sex     eggs_laid
  &lt;chr&gt;                   &lt;chr&gt;       &lt;dbl&gt;
1 Foghorn Leghorn         rooster         0
2 Chicken Little          hen             3
3 Ginger                  hen            12
4 Camilla the Chicken     hen             7
5 Ernie The Giant Chicken rooster         0</code></pre>
</div>
</div>
</section>
<section id="datos-sin-tabular-.txt" class="slide level2">
<h2>Datos sin tabular (.txt)</h2>
<p>Vamos a usar de nuevo <code>read_csv()</code> con el archivo <code>massey-rating.txt</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb310"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb310-1"><a href="#cb310-1"></a>datos_txt <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"./datos/massey-rating.txt"</span>)</span>
<span id="cb310-2"><a href="#cb310-2"></a><span class="fu">as_tibble</span>(datos_txt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 1
   `UCC PAY LAZ KPK  RT   COF BIH DII ENG ACU Rank Team            Conf`
   &lt;chr&gt;                                                                
 1 1   1   1   1   1     1   1   1   1   1    1 Ohio St          B10    
 2 2   2   2   2   2     2   2   2   4   2    2 Oregon           P12    
 3 3   4   3   4   3     4   3   4   2   3    3 Alabama          SEC    
 4 4   3   4   3   4     3   5   3   3   4    4 TCU              B12    
 5 6   6   6   5   5     7   6   5   6  11    5 Michigan St      B10    
 6 7   7   7   6   7     6  11   8   7   8    6 Georgia          SEC    
 7 5   5   5   7   6     8   4   6   5   5    7 Florida St       ACC    
 8 8   8   9   9  10     5   7   7  10   7    8 Baylor           B12    
 9 9  11   8  13  11    11  12   9  14   9    9 Georgia Tech     ACC    
10 13  10  13  11   8     9  10  11   9  10   10 Mississippi      SEC   </code></pre>
</div>
</div>
<div class="fragment">
<p>Si te fijas nos interpreta todo como una sola columna: <span class="hl-yellow"><strong>no tiene comas el archivo y no sabe por donde separar</strong></span></p>
</div>
<div class="fragment">
<p>¿Qué sucede cuando el <span class="hl-red"><strong>separador no es el correcto</strong></span>?</p>
</div>
</section>
<section id="datos-sin-tabular-.txt-1" class="slide level2">
<h2>Datos sin tabular (.txt)</h2>
<p>Para ello tenemos</p>
<ul>
<li><p><code>read_csv2()</code> cuando el <span class="hl-yellow"><strong>separador sea el punto y coma</strong></span>, <code>read_tsv()</code> cuando el <span class="hl-yellow"><strong>sea un tabulador</strong></span> y <code>read_table()</code> cuando el <span class="hl-yellow"><strong>sea un espacio</strong></span></p></li>
<li><p><code>read_delim()</code> en general</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb312"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb312-1"><a href="#cb312-1"></a>datos_txt <span class="ot">&lt;-</span> <span class="fu">read_table</span>(<span class="at">file =</span> <span class="st">"./datos/massey-rating.txt"</span>)</span>
<span id="cb312-2"><a href="#cb312-2"></a><span class="fu">as_tibble</span>(datos_txt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 13
     UCC   PAY   LAZ   KPK    RT   COF   BIH   DII   ENG   ACU  Rank Team  Conf 
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
 1     1     1     1     1     1     1     1     1     1     1     1 Ohio  St   
 2     2     2     2     2     2     2     2     2     4     2     2 Oreg… P12  
 3     3     4     3     4     3     4     3     4     2     3     3 Alab… SEC  
 4     4     3     4     3     4     3     5     3     3     4     4 TCU   B12  
 5     6     6     6     5     5     7     6     5     6    11     5 Mich… St   
 6     7     7     7     6     7     6    11     8     7     8     6 Geor… SEC  
 7     5     5     5     7     6     8     4     6     5     5     7 Flor… St   
 8     8     8     9     9    10     5     7     7    10     7     8 Bayl… B12  
 9     9    11     8    13    11    11    12     9    14     9     9 Geor… Tech 
10    13    10    13    11     8     9    10    11     9    10    10 Miss… SEC  </code></pre>
</div>
</div>
</section>
<section id="datos-en-excel-.xls-.xlsx" class="slide level2">
<h2>Datos en excel (.xls, .xlsx)</h2>
<p>Otro de los paquetes fundamentales de importación será el paquete <code>{readxl}</code> para <span class="hl-yellow"><strong>importar datos desde una Excel</strong></span>. Tres funciones serán claves:</p>
<ul>
<li><code>read_xls()</code> específica para <code>.xls</code>, <code>read_xlsx()</code> específica para <code>.xlsx</code></li>
<li><code>read_excel()</code>: para ambas</li>
</ul>
<div class="fragment">
<p>Vamos a importar <code>deaths.xlsx</code> con registros de fallecimientos de famosos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb314"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb314-1"><a href="#cb314-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb314-2"><a href="#cb314-2"></a>deaths <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="at">path =</span> <span class="st">"./datos/deaths.xlsx"</span>)</span>
<span id="cb314-3"><a href="#cb314-3"></a>deaths</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 6
  `Lots of people`             ...2       ...3  ...4     ...5          ...6     
  &lt;chr&gt;                        &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;         &lt;chr&gt;    
1 simply cannot resist writing &lt;NA&gt;       &lt;NA&gt;  &lt;NA&gt;     &lt;NA&gt;          some not…
2 at                           the        top   &lt;NA&gt;     of            their sp…
3 or                           merging    &lt;NA&gt;  &lt;NA&gt;     &lt;NA&gt;          cells    
4 Name                         Profession Age   Has kids Date of birth Date of …
5 David Bowie                  musician   69    TRUE     17175         42379    
6 Carrie Fisher                actor      60    TRUE     20749         42731    
7 Chuck Berry                  musician   90    TRUE     9788          42812    
8 Bill Paxton                  actor      61    TRUE     20226         42791    </code></pre>
</div>
</div>
</div>
</section>
<section id="datos-en-excel-.xls-.xlsx-1" class="slide level2">
<h2>Datos en excel (.xls, .xlsx)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb316"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb316-1"><a href="#cb316-1"></a>deaths</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 6
  `Lots of people`             ...2       ...3  ...4     ...5          ...6     
  &lt;chr&gt;                        &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;         &lt;chr&gt;    
1 simply cannot resist writing &lt;NA&gt;       &lt;NA&gt;  &lt;NA&gt;     &lt;NA&gt;          some not…
2 at                           the        top   &lt;NA&gt;     of            their sp…
3 or                           merging    &lt;NA&gt;  &lt;NA&gt;     &lt;NA&gt;          cells    
4 Name                         Profession Age   Has kids Date of birth Date of …
5 David Bowie                  musician   69    TRUE     17175         42379    
6 Carrie Fisher                actor      60    TRUE     20749         42731    
7 Chuck Berry                  musician   90    TRUE     9788          42812    
8 Bill Paxton                  actor      61    TRUE     20226         42791    </code></pre>
</div>
</div>
<p>Algo por <span class="hl-yellow"><strong>desgracia muy habitual</strong></span> es que haya <span class="hl-red"><strong>algún tipo de comentario o texto al inicio</strong></span> del archivo, teniendo que <span class="hl-yellow"><strong>saltarnos dichas filas</strong></span>.</p>
</section>
<section id="datos-en-excel-.xls-.xlsx-2" class="slide level2">
<h2>Datos en excel (.xls, .xlsx)</h2>
<p>Podemos <span class="hl-yellow"><strong>saltarnos dichas filas</strong></span> directamente en la carga con <code>skip = ...</code> (indicando el número de filas que nos saltamos)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb318"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb318-1"><a href="#cb318-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb318-2"><a href="#cb318-2"></a>deaths <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="at">path =</span> <span class="st">"./datos/deaths.xlsx"</span>, <span class="at">skip =</span> <span class="dv">4</span>)</span>
<span id="cb318-3"><a href="#cb318-3"></a>deaths</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 6
  Name          Profession Age   `Has kids` `Date of birth`     `Date of death`
  &lt;chr&gt;         &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt;      &lt;dttm&gt;              &lt;chr&gt;          
1 David Bowie   musician   69    TRUE       1947-01-08 00:00:00 42379          
2 Carrie Fisher actor      60    TRUE       1956-10-21 00:00:00 42731          
3 Chuck Berry   musician   90    TRUE       1926-10-18 00:00:00 42812          
4 Bill Paxton   actor      61    TRUE       1955-05-17 00:00:00 42791          
5 Prince        musician   57    TRUE       1958-06-07 00:00:00 42481          </code></pre>
</div>
</div>
</section>
<section id="datos-en-excel-.xls-.xlsx-3" class="slide level2">
<h2>Datos en excel (.xls, .xlsx)</h2>
<p>Además con <code>col_names = ...</code> podemos renombrar ya las columnas en la importación (si <span class="hl-yellow"><strong>proporcionamos nombres asume la 1ª línea ya como un dato</strong></span>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb320" data-code-line-numbers="3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb320-1"><a href="#cb320-1"></a>deaths <span class="ot">&lt;-</span></span>
<span id="cb320-2"><a href="#cb320-2"></a>  <span class="fu">read_xlsx</span>(<span class="at">path =</span> <span class="st">"./datos/deaths.xlsx"</span>,</span>
<span id="cb320-3"><a href="#cb320-3"></a>            <span class="at">skip =</span> <span class="dv">5</span>,</span>
<span id="cb320-4"><a href="#cb320-4"></a>            <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"name"</span>, <span class="st">"profession"</span>, <span class="st">"age"</span>, <span class="st">"kids"</span>, <span class="st">"birth"</span>, <span class="st">"death"</span>))</span>
<span id="cb320-5"><a href="#cb320-5"></a>deaths</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 6
  name               profession age   kids  birth               death
  &lt;chr&gt;              &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt; &lt;dttm&gt;              &lt;chr&gt;
1 David Bowie        musician   69    TRUE  1947-01-08 00:00:00 42379
2 Carrie Fisher      actor      60    TRUE  1956-10-21 00:00:00 42731
3 Chuck Berry        musician   90    TRUE  1926-10-18 00:00:00 42812
4 Bill Paxton        actor      61    TRUE  1955-05-17 00:00:00 42791
5 Prince             musician   57    TRUE  1958-06-07 00:00:00 42481
6 Alan Rickman       actor      69    FALSE 1946-02-21 00:00:00 42383
7 Florence Henderson actor      82    TRUE  1934-02-14 00:00:00 42698</code></pre>
</div>
</div>
</section>
<section id="datos-en-excel-.xls-.xlsx-4" class="slide level2">
<h2>Datos en excel (.xls, .xlsx)</h2>
<p>En ocasiones las <span class="hl-red"><strong>fechas de Excel están mal formateadas</strong></span> (sorpresa): podemos hacer uso de <code>convertToDate()</code> del paquete <code>{openxlsx}</code> para convertirlo</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb322"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb322-1"><a href="#cb322-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb322-2"><a href="#cb322-2"></a>deaths<span class="sc">$</span>death <span class="ot">&lt;-</span> <span class="fu">convertToDate</span>(deaths<span class="sc">$</span>death)</span>
<span id="cb322-3"><a href="#cb322-3"></a>deaths</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 6
  name               profession age   kids  birth               death     
  &lt;chr&gt;              &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt; &lt;dttm&gt;              &lt;date&gt;    
1 David Bowie        musician   69    TRUE  1947-01-08 00:00:00 2016-01-10
2 Carrie Fisher      actor      60    TRUE  1956-10-21 00:00:00 2016-12-27
3 Chuck Berry        musician   90    TRUE  1926-10-18 00:00:00 2017-03-18
4 Bill Paxton        actor      61    TRUE  1955-05-17 00:00:00 2017-02-25
5 Prince             musician   57    TRUE  1958-06-07 00:00:00 2016-04-21
6 Alan Rickman       actor      69    FALSE 1946-02-21 00:00:00 2016-01-14
7 Florence Henderson actor      82    TRUE  1934-02-14 00:00:00 2016-11-24</code></pre>
</div>
</div>
</section>
<section id="datos-en-excel-.xls-.xlsx-5" class="slide level2">
<h2>Datos en excel (.xls, .xlsx)</h2>
<p>También podemos <span class="hl-yellow"><strong>cargar un Excel con varias hojas</strong></span>: para <span class="hl-yellow"><strong>indicarle la hoja</strong></span> (bien por su nombre bien por su número) usaremos el argumento <code>sheet = ...</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb324"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb324-1"><a href="#cb324-1"></a>mtcars <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="at">path =</span> <span class="st">"./datos/datasets.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"mtcars"</span>)</span>
<span id="cb324-2"><a href="#cb324-2"></a>mtcars</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 11
    mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1  21       6   160   110  3.9   2.62  16.5     0     1     4     4
2  21       6   160   110  3.9   2.88  17.0     0     1     4     4
3  22.8     4   108    93  3.85  2.32  18.6     1     1     4     1
4  21.4     6   258   110  3.08  3.22  19.4     1     0     3     1
5  18.7     8   360   175  3.15  3.44  17.0     0     0     3     2</code></pre>
</div>
</div>
<div class="fragment">
<p>Incluso podemos indicar el <span class="hl-yellow"><strong>rango de celdas</strong></span> a cargar con <code>range = ...</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb326"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb326-1"><a href="#cb326-1"></a>iris <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="at">path =</span> <span class="st">"./datos/datasets.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"iris"</span>, <span class="at">range =</span> <span class="st">"C1:E4"</span>)</span>
<span id="cb326-2"><a href="#cb326-2"></a>iris</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  Petal.Length Petal.Width Species
         &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;  
1          1.4         0.2 setosa 
2          1.4         0.2 setosa 
3          1.3         0.2 setosa </code></pre>
</div>
</div>
</div>
</section>
<section id="desde-sasstataspss" class="slide level2">
<h2>Desde SAS/STATA/SPSS</h2>
<p>El paquete <code>{haven}</code> dentro de la órbita tidyverse nos permitirá <span class="hl-yellow"><strong>importar archivos de los 3 software de pago más importantes</strong></span>: SAS, SPSS y Stata</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb328"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb328-1"><a href="#cb328-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb328-2"><a href="#cb328-2"></a></span>
<span id="cb328-3"><a href="#cb328-3"></a><span class="co"># SAS</span></span>
<span id="cb328-4"><a href="#cb328-4"></a>iris_sas <span class="ot">&lt;-</span> <span class="fu">read_sas</span>(<span class="at">data_file =</span> <span class="st">"./datos/iris.sas7bdat"</span>)</span>
<span id="cb328-5"><a href="#cb328-5"></a></span>
<span id="cb328-6"><a href="#cb328-6"></a><span class="co"># SPSS</span></span>
<span id="cb328-7"><a href="#cb328-7"></a>iris_spss <span class="ot">&lt;-</span> <span class="fu">read_sav</span>(<span class="at">file =</span> <span class="st">"./datos/iris.sav"</span>)</span>
<span id="cb328-8"><a href="#cb328-8"></a></span>
<span id="cb328-9"><a href="#cb328-9"></a><span class="co"># Stata</span></span>
<span id="cb328-10"><a href="#cb328-10"></a>iris_stata <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="at">file =</span> <span class="st">"./datos/iris.dta"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exportar" class="slide level2">
<h2>Exportar</h2>
<p>De la misma manera que podemos importar también podemos <span class="hl-yellow"><strong>exportar</strong></span></p>
<ul>
<li>exportado en <code>.RData</code> (opción recomendada para variables guardadas en <code>R</code>). Recuerda que esta extensión <span class="hl-yellow"><strong>solo se podrá usar en <code>R</code></strong></span>. Para ello nos basta con usar <code>save(objeto, file = ruta)</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb329"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb329-1"><a href="#cb329-1"></a>tabla <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"a"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="st">"b"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb329-2"><a href="#cb329-2"></a><span class="fu">save</span>(tabla, <span class="at">file =</span> <span class="st">"./datos/tabla_prueba.RData"</span>)</span>
<span id="cb329-3"><a href="#cb329-3"></a><span class="fu">rm</span>(tabla) <span class="co"># eliminar</span></span>
<span id="cb329-4"><a href="#cb329-4"></a><span class="fu">load</span>(<span class="st">"./datos/tabla_prueba.RData"</span>)</span>
<span id="cb329-5"><a href="#cb329-5"></a>tabla</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
      a     b
  &lt;int&gt; &lt;int&gt;
1     1     1
2     2     2
3     3     3
4     4     4</code></pre>
</div>
</div>
</section>
<section id="exportar-1" class="slide level2">
<h2>Exportar</h2>
<p>De la misma manera que podemos importar también podemos <span class="hl-yellow"><strong>exportar</strong></span></p>
<ul>
<li>exportado en <code>.RDS</code> (opción recomendada para variables guardadas en <code>R</code>). Recuerda que esta extensión <span class="hl-yellow"><strong>solo se podrá usar en <code>R</code></strong></span>. Para ello nos basta con usar <code>saveRDS(objeto, file = ruta)</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb331"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb331-1"><a href="#cb331-1"></a><span class="fu">saveRDS</span>(tabla, <span class="at">file =</span> <span class="st">"tabla.RDS"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exportar-2" class="slide level2">
<h2>Exportar</h2>
<p>De la misma manera que podemos importar también podemos <span class="hl-yellow"><strong>exportar</strong></span></p>
<ul>
<li>exportado en <code>.csv</code>. Para ello nos basta con usar <code>write_csv(objeto, file = ruta)</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb332"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb332-1"><a href="#cb332-1"></a><span class="fu">write_csv</span>(tabla, <span class="at">file =</span> <span class="st">"./datos/tabla_prueba.csv"</span>)</span>
<span id="cb332-2"><a href="#cb332-2"></a><span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"./datos/tabla_prueba.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
      a     b
  &lt;dbl&gt; &lt;dbl&gt;
1     1     1
2     2     2
3     3     3
4     4     4</code></pre>
</div>
</div>
</section>
<section id="exportar-3" class="slide level2">
<h2>Exportar</h2>
<p>De la misma manera que podemos importar también podemos <span class="hl-yellow"><strong>exportar</strong></span></p>
<ul>
<li>exportado en <code>.xlsx</code>. Para ello nos basta con usar <code>write.xlsx(objeto, file = ruta)</code> del paquete <code>{openxlsx}</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb334"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb334-1"><a href="#cb334-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb334-2"><a href="#cb334-2"></a><span class="fu">write.xlsx</span>(tabla, <span class="at">file =</span> <span class="st">"./datos/tabla_prueba.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="desde-web" class="slide level2">
<h2>Desde web</h2>
<p>Una de las principales ventajas de <code>R</code> es que podemos hacer uso de todas las funciones anteriores de <span class="hl-yellow"><strong>importar pero directamente desde una web</strong></span>, sin necesidad de realizar la descarga manual: en lugar de pasarle la ruta local le indicaremos el <span class="hl-yellow"><strong>enlace</strong></span>. Por ejemplo, vamos a descargar los datos de covid del ISCIII (<a href="https://cnecovid.isciii.es/covid19/#documentaci%C3%B3n-y-datos" class="uri">https://cnecovid.isciii.es/covid19/#documentaci%C3%B3n-y-datos</a>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb335"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb335-1"><a href="#cb335-1"></a>covid_datos <span class="ot">&lt;-</span></span>
<span id="cb335-2"><a href="#cb335-2"></a>  <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"https://cnecovid.isciii.es/covid19/resources/casos_hosp_uci_def_sexo_edad_provres.csv"</span>)</span>
<span id="cb335-3"><a href="#cb335-3"></a>covid_datos</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 700 × 8
   provincia_iso sexo  grupo_edad fecha      num_casos num_hosp num_uci num_def
   &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;      &lt;date&gt;         &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
 1 A             H     0-9        2020-01-01         0        0       0       0
 2 A             H     10-19      2020-01-01         0        0       0       0
 3 A             H     20-29      2020-01-01         0        0       0       0
 4 A             H     30-39      2020-01-01         0        0       0       0
 5 A             H     40-49      2020-01-01         0        0       0       0
 6 A             H     50-59      2020-01-01         0        0       0       0
 7 A             H     60-69      2020-01-01         0        0       0       0
 8 A             H     70-79      2020-01-01         0        0       0       0
 9 A             H     80+        2020-01-01         0        0       0       0
10 A             H     NC         2020-01-01         0        0       0       0
# ℹ 690 more rows</code></pre>
</div>
</div>
</section>
<section id="desde-google-drive" class="slide level2">
<h2>Desde google drive</h2>
<p>Otra opción disponible (sobre todo si trabajamos con otras personas que trabajan) es <span class="hl-yellow"><strong>importar desde una hoja de cálculo Google Drive</strong></span>, haciendo uso de <code>read_sheet()</code> del paquete <code>{googlesheets4}</code></p>
<p>La primera vez te pedirá un permiso de tidyverse para interactuar con vuestro drive</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb337"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb337-1"><a href="#cb337-1"></a><span class="fu">library</span>(googlesheets4)</span>
<span id="cb337-2"><a href="#cb337-2"></a>google_sheet <span class="ot">&lt;-</span></span>
<span id="cb337-3"><a href="#cb337-3"></a>  <span class="fu">read_sheet</span>(<span class="st">"https://docs.google.com/spreadsheets/d/1n_UTbD93-oDJR2r-rsMNff5ro147NL_ZN_vYIA2eJ3Q/edit?usp=sharing"</span>)</span>
<span id="cb337-4"><a href="#cb337-4"></a>google_sheet</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="tu-turno-7" class="slide level2">
<h2>💻 Tu turno</h2>
<p><span style="color:#444442;"><strong>Intenta realizar los siguientes ejercicios sin mirar las soluciones</strong></span></p>
<div class="panel-tabset">
<ul id="tabset-8" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-8-1"><span class="hl-yellow"><strong>Ejercicio 1</strong></span></a></li><li><a href="#tabset-8-2"><span class="hl-yellow"><strong>Ejercicio 2</strong></span></a></li><li><a href="#tabset-8-3"><span class="hl-yellow"><strong>Ejercicio 3</strong></span></a></li><li><a href="#tabset-8-4"><span class="hl-yellow"><strong>Ejercicio 4</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-8-1">
<p>📝 El dataset <code>who</code> que hemos usado en ejercicios anteriores, expórtalo a un formato nativo de <code>R</code> en la carpeta <code>datos</code> del proyecto</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb338"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb338-1"><a href="#cb338-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb338-2"><a href="#cb338-2"></a><span class="fu">save</span>(who, <span class="at">file =</span> <span class="st">"./datos/who.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-8-2">
<p>📝 Carga el dataset <code>who</code> pero desde la carpeta de datos (importa el archivo creado en el ejercicio anterior)</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb339"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb339-1"><a href="#cb339-1"></a><span class="fu">load</span>(<span class="st">"./datos/who.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-8-3">
<p>📝 Repite lo mismo (exportar e importar) en 4 formatos: <code>.csv</code>, <code>.xlsx</code>, <code>.sav</code> (spss) y <code>.dta</code> (stata)</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb340"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb340-1"><a href="#cb340-1"></a><span class="co"># csv</span></span>
<span id="cb340-2"><a href="#cb340-2"></a><span class="fu">library</span>(readr)</span>
<span id="cb340-3"><a href="#cb340-3"></a><span class="fu">write_csv</span>(who, <span class="at">file =</span> <span class="st">"./datos/who.csv"</span>)</span>
<span id="cb340-4"><a href="#cb340-4"></a>who_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"./datos/who.csv"</span>)</span>
<span id="cb340-5"><a href="#cb340-5"></a></span>
<span id="cb340-6"><a href="#cb340-6"></a><span class="co"># excel</span></span>
<span id="cb340-7"><a href="#cb340-7"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb340-8"><a href="#cb340-8"></a><span class="fu">write.xlsx</span>(who, <span class="at">file =</span> <span class="st">"./datos/who.xlsx"</span>)</span>
<span id="cb340-9"><a href="#cb340-9"></a>who_data <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="at">path =</span> <span class="st">"./datos/who.xlsx"</span>)</span>
<span id="cb340-10"><a href="#cb340-10"></a></span>
<span id="cb340-11"><a href="#cb340-11"></a><span class="co"># sas y stata</span></span>
<span id="cb340-12"><a href="#cb340-12"></a><span class="fu">library</span>(haven)</span>
<span id="cb340-13"><a href="#cb340-13"></a><span class="fu">write_sav</span>(who, <span class="at">path =</span> <span class="st">"./datos/who.sav"</span>)</span>
<span id="cb340-14"><a href="#cb340-14"></a>who_data <span class="ot">&lt;-</span> <span class="fu">read_spss</span>(<span class="at">path =</span> <span class="st">"./datos/who.sav"</span>)</span>
<span id="cb340-15"><a href="#cb340-15"></a></span>
<span id="cb340-16"><a href="#cb340-16"></a><span class="fu">write_dta</span>(who, <span class="at">path =</span> <span class="st">"./datos/who.dta"</span>)</span>
<span id="cb340-17"><a href="#cb340-17"></a>who_data <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="at">path =</span> <span class="st">"./datos/who.dta"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-8-4">
<p>📝 Repite la carga del <code>who.csv</code> pero solo selecciona ya en la carga las 4 primeras columnas</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb341"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb341-1"><a href="#cb341-1"></a>who_select <span class="ot">&lt;-</span></span>
<span id="cb341-2"><a href="#cb341-2"></a>  <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"./datos/who.csv"</span>,</span>
<span id="cb341-3"><a href="#cb341-3"></a>           <span class="at">col_select =</span> <span class="fu">c</span>(<span class="st">"country"</span>, <span class="st">"iso2"</span>, <span class="st">"iso3"</span>, <span class="st">"year"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="listas" class="title-slide slide level1 center">
<h1>Introducción a listas</h1>
<p><span style="color:#444442;"><strong>Uso de listas: paquete purrr</strong></span></p>
</section>
<section id="introducción-a-listas" class="slide level2">
<h2>Introducción a listas</h2>
<p>Veamos un pequeño resumen de los datos que ya conocemos:</p>
<ul>
<li><p><span class="hl-yellow"><strong>vectores</strong></span>: colección de elementos de igual tipo. Pueden ser números, caracteres o valores lógicos, entre otros.</p></li>
<li><p><span class="hl-yellow"><strong>matrices</strong></span>: colección BIDIMENSIONAL de elementos de igual tipo e igual longitud.</p></li>
<li><p><span class="hl-yellow"><strong>data.frame / tibble</strong></span>: colección BIDIMENSIONAL de elementos de igual longitud pero de cualquier tipo.</p></li>
</ul>
<div class="fragment">
<p>Las <span class="hl-yellow"><strong>listas</strong></span> serán <span class="hl-purple"><strong>colecciones de variables de diferente tipo y diferente longitud</strong></span>, con estructuras totalmente heterógeneas (incluso una lista puede tener dentro a su vez otra lista).</p>
</div>
</section>
<section id="paquete-purrr" class="slide level2">
<h2>Paquete purrr</h2>
<p>Una opción más flexible y versatil que la familia <code>lapply</code> es hacer uso del paquete <code>{purrr}</code> ya cargado dentro del entorno <code>{tidyverse}</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb342"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb342-1"><a href="#cb342-1"></a><span class="fu">library</span>(purrr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Este paquete está pensado para imitar la <span class="hl-yellow"><strong>programa funcional</strong></span> de otros lenguajes orientados Big Data como Scala o Hadoop (de Google).</p>

<img data-src="img/purrr.png" class="r-stretch"></section>
<section id="paquete-purrr-1" class="slide level2">
<h2>Paquete purrr</h2>
<p>La función más simple de <code>{purrr}</code> es conocida como la función <code>map()</code>, encargada de <span class="hl-yellow"><strong>aplicar una función a una lista de manera vectorial</strong></span>, elemento a elemento. . . .</p>
<p>Por ejemplo, con <code>map()</code> podemos <span class="hl-yellow"><strong>“mapear” cada lista</strong></span> y aplicar la función raíz cuadrada a cada elemento de la lista.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb343"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb343-1"><a href="#cb343-1"></a>x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"x1"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="st">"x2"</span> <span class="ot">=</span> <span class="dv">11</span><span class="sc">:</span><span class="dv">20</span>)</span>
<span id="cb343-2"><a href="#cb343-2"></a><span class="fu">map</span>(x, sqrt) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$x1
[1] 1.000000 1.414214 1.732051 2.000000

$x2
 [1] 3.316625 3.464102 3.605551 3.741657 3.872983 4.000000 4.123106 4.242641
 [9] 4.358899 4.472136</code></pre>
</div>
</div>
<div class="fragment">
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Be careful</strong></p>
</div>
<div class="callout-content">
<p>Con <code>R</code> tenemos una vectorización automática cuando hablamos de vectores ya que trabaja elemento-a-elemento, pero por defecto, el <span class="hl-yellow"><strong>output de <code>map</code> es una lista</strong></span>.</p>
</div>
</div>
</div>
</div>
</section>
<section id="paquete-purrr-2" class="slide level2">
<h2>Paquete purrr</h2>
<p>Otro ejemplo: definamos dos distribuciones normales, con diferente <span class="math inline">\(n\)</span>. ¿Cómo <strong>calcular la media de cada una</strong> de manera inmediata?</p>
<div class="fragment">
<p>Las guardamos en una lista y aplicamos <code>map()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb345"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb345-1"><a href="#cb345-1"></a>x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1500</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.7</span>),</span>
<span id="cb345-2"><a href="#cb345-2"></a>          <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">2800</span>, <span class="at">mean =</span> <span class="dv">2</span>, <span class="at">sd =</span> <span class="fl">1.5</span>))</span>
<span id="cb345-3"><a href="#cb345-3"></a><span class="fu">map</span>(x, mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] -0.04136339

[[2]]
[1] 2.03415</code></pre>
</div>
</div>
</div>
</section>
<section id="paquete-purrr-3" class="slide level2">
<h2>Paquete purrr</h2>
<p>Lo mismo si queremos usar cualquier otra función que queramos definir nosotros mismos (por ejemplo, la media de los cuadrados)</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb347"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb347-1"><a href="#cb347-1"></a><span class="fu">map</span>(x, <span class="cf">function</span>(x) { <span class="fu">mean</span>(x<span class="sc">^</span><span class="dv">2</span>) })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] 0.4759231

[[2]]
[1] 6.409026</code></pre>
</div>
</div>
</section>
<section id="paquete-purrr-4" class="slide level2">
<h2>Paquete purrr</h2>
<p>Además de ser <span class="hl-yellow"><strong>más legible y eficiente</strong></span>, con <code>{purrr}</code> podemos <span class="hl-yellow"><strong>decidir el formato de salida de manera sencilla</strong></span></p>
<ul>
<li>output como <span class="hl-purple"><strong>vector double</strong></span> con <code>map_dbl()</code></li>
<li>output como <span class="hl-purple"><strong>vector de enteros</strong></span> con <code>map_int()</code></li>
<li>output como <span class="hl-purple"><strong>vector de caracteres</strong></span> con <code>map_chr()</code></li>
<li>output como <span class="hl-purple"><strong>vector lógico</strong></span> con <code>map_lgl()</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb349"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb349-1"><a href="#cb349-1"></a><span class="fu">map_dbl</span>(x, mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.04136339  2.03414977</code></pre>
</div>
<div class="sourceCode cell-code" id="cb351"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb351-1"><a href="#cb351-1"></a><span class="fu">map_chr</span>(x, <span class="cf">function</span>(x) { glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"Mean is {round(mean(x), 5)}"</span>) })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Mean is -0.04136" "Mean is 2.03415" </code></pre>
</div>
</div>
</section>
<section id="paquete-purrr-5" class="slide level2">
<h2>Paquete purrr</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb353"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb353-1"><a href="#cb353-1"></a><span class="fu">c</span>(x[[<span class="dv">1</span>]][<span class="dv">3</span>], x[[<span class="dv">2</span>]][<span class="dv">3</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.8233694 -0.9365637</code></pre>
</div>
</div>
<p>Además si incluyes <span class="hl-yellow"><strong>como argumento un número</strong></span> en lugar de una función, nos devolverá el <span class="hl-yellow"><strong>i-ésimo elemento de la lista</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb355"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb355-1"><a href="#cb355-1"></a><span class="fu">map_dbl</span>(x, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.8233694 -0.9365637</code></pre>
</div>
</div>
</section>
<section id="paquete-purrr-6" class="slide level2">
<h2>Paquete purrr</h2>
<p>También nos permite la opción de generalizarlo para funciones que necesiten <span class="hl-yellow"><strong>dos argumentos de entrada</strong></span> (operaciones binarias) con <code>map2()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb357"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb357-1"><a href="#cb357-1"></a>x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"a"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="st">"b"</span> <span class="ot">=</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb357-2"><a href="#cb357-2"></a>y <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"c"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">0</span>), <span class="st">"b"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb357-3"><a href="#cb357-3"></a><span class="fu">map2</span>(x, y, <span class="cf">function</span>(x, y) { x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> y<span class="sc">^</span><span class="dv">2</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$a
[1]  2 20  9

$b
[1] 41 41 37</code></pre>
</div>
</div>
</section>
<section id="paquete-purrr-7" class="slide level2">
<h2>Paquete purrr</h2>
<p>El output podemos también obtenerlo en formato <code>tibble</code> añadiendo un <code>list_rbind()</code> o <code>list_cbind()</code> para <span class="hl-yellow"><strong>concatenar los valores d euna lista en formato tabular</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb359"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb359-1"><a href="#cb359-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>)</span>
<span id="cb359-2"><a href="#cb359-2"></a>y <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb359-3"><a href="#cb359-3"></a><span class="fu">map2</span>(x, y, <span class="cf">function</span>(x, y) { <span class="fu">tibble</span>(x, y) }) <span class="sc">|&gt;</span> <span class="fu">list_rbind</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  x         y
  &lt;chr&gt; &lt;int&gt;
1 a         1
2 b         2
3 c         3</code></pre>
</div>
</div>
</section>
<section id="paquete-purrr-8" class="slide level2">
<h2>Paquete purrr</h2>
<p>Lo anterior se puede <span class="hl-yellow"><strong>generalizar</strong></span> con <code>pmap_xxx()</code> lo que nos permite aplicar funciones con <span class="hl-yellow"><strong>múltiples argumentos</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb361"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb361-1"><a href="#cb361-1"></a>x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb361-2"><a href="#cb361-2"></a>y <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>)</span>
<span id="cb361-3"><a href="#cb361-3"></a>z <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">300</span>)</span>
<span id="cb361-4"><a href="#cb361-4"></a><span class="fu">pmap_dbl</span>(<span class="fu">list</span>(x, y, z), sum)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 111 221 331</code></pre>
</div>
</div>
</section>
<section id="paquete-purrr-9" class="slide level2">
<h2>Paquete purrr</h2>
<p>Dentro del paquete contamos con otro tipo de [<strong>iteradores que no devuelven nada</strong>] (solo side-effects) como es el caso de <code>walk()</code> (solo un argumento de entrada), <code>walk2()</code> (dos argumentos) and <code>pwalk()</code> (multiples argumentos), todos ellos <span class="hl-yellow"><strong>con un return invisible</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb363"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb363-1"><a href="#cb363-1"></a><span class="fu">list</span>(<span class="st">"a"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="st">"b"</span> <span class="ot">=</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>) <span class="sc">|&gt;</span></span>
<span id="cb363-2"><a href="#cb363-2"></a>  <span class="fu">map2</span>(<span class="fu">list</span>(<span class="st">"a"</span> <span class="ot">=</span> <span class="dv">11</span><span class="sc">:</span><span class="dv">13</span>, <span class="st">"b"</span> <span class="ot">=</span> <span class="dv">14</span><span class="sc">:</span><span class="dv">16</span>),</span>
<span id="cb363-3"><a href="#cb363-3"></a>       <span class="cf">function</span>(x, y) { x <span class="sc">+</span> y }) <span class="sc">|&gt;</span> </span>
<span id="cb363-4"><a href="#cb363-4"></a>  <span class="fu">walk</span>(print)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12 14 16
[1] 18 20 22</code></pre>
</div>
</div>
</section>
<section id="paquete-purrr-10" class="slide level2">
<h2>Paquete purrr</h2>
<p>Recientemente se ha desarrollado <code>{loopurrr}</code>, un paquete que permite la traducción con <code>as_loop()</code> de lenguaje funcional en <code>{purrr}</code> a bucles para poder entender mejor lo que hace (ver más en <a href="https://timteafan.github.io/loopurrr/" class="uri">https://timteafan.github.io/loopurrr/</a>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb365"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb365-1"><a href="#cb365-1"></a><span class="co"># remotes::install_github("TimTeaFan/loopurrr")</span></span>
<span id="cb365-2"><a href="#cb365-2"></a><span class="fu">library</span>(loopurrr)</span>
<span id="cb365-3"><a href="#cb365-3"></a>x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">1</span>, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>), <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>))</span>
<span id="cb365-4"><a href="#cb365-4"></a>x <span class="sc">|&gt;</span></span>
<span id="cb365-5"><a href="#cb365-5"></a>  <span class="fu">map</span>(sum) <span class="sc">|&gt;</span>  </span>
<span id="cb365-6"><a href="#cb365-6"></a>  <span class="fu">as_loop</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section>
<section>
<section id="joins" class="title-slide slide level1 center">
<h1>Joins</h1>
<p><span style="color:#444442;"><strong>Cruzando datos</strong></span></p>
</section>
<section id="relacionando-datos" class="slide level2">
<h2>Relacionando datos</h2>
<p>Al trabajar con datos <span class="hl-yellow"><strong>no siempre tendremos la información en una sola tabla</strong></span> y a veces nos interesará cruzar la información de distintas fuentes.</p>
<div class="fragment">
<p>Para ello usaremos un clásico de todo lenguaje que maneja datos: los famosos <span class="hl-yellow"><strong>join</strong></span>, una herramienta que nos va a permitir <span class="hl-yellow"><strong>cruzar una o variables tablas</strong></span>, haciendo uso de una <span class="hl-yellow"><strong>columna identificadora</strong></span> de cada una de ellas (por ejemplo, imagina que cruzamos datos de hacienda y de antecedentes penales, haciendo <em>join</em> por la columna <code>DNI</code>).</p>
</div>
</section>
<section id="relacionando-datos-1" class="slide level2">
<h2>Relacionando datos</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb366"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb366-1"><a href="#cb366-1"></a>tabla_1 <span class="sc">|&gt;</span></span>
<span id="cb366-2"><a href="#cb366-2"></a>  <span class="fu">xxx_join</span>(tabla_2, <span class="at">by =</span> id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><p><code>inner_join()</code>: solo sobreviven los <span class="hl-yellow"><strong>registros con id en ambas</strong></span> tablas.</p></li>
<li><p><code>full_join()</code>: mantiene <span class="hl-yellow"><strong>todos los registros de ambas</strong></span> tablas.</p></li>
<li><p><code>left_join()</code>: mantiene <span class="hl-yellow"><strong>todos los registros de la primera tabla</strong></span>, y busca cuales tienen id también en la segunda (en caso de <span class="hl-yellow"><strong>no tenerlo se rellena con NA</strong></span> los campos de la 2ª tabla).</p></li>
<li><p><code>right_join()</code>: mantiene <span class="hl-yellow"><strong>todos los registros de la segunda tabla</strong></span>, y busca cuales tienen id también en la primera.</p></li>
</ul>

<img data-src="img/sql-joins.jpg" class="r-stretch"></section>
<section id="relacionando-datos-2" class="slide level2">
<h2>Relacionando datos</h2>
<p>Vamos a probar los distintos joins con un ejemplo sencillo</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb367"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb367-1"><a href="#cb367-1"></a>tb_1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"key"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="st">"val_x"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>))</span>
<span id="cb367-2"><a href="#cb367-2"></a>tb_2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"key"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>), <span class="st">"val_y"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb368"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb368-1"><a href="#cb368-1"></a>tb_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
    key val_x
  &lt;int&gt; &lt;chr&gt;
1     1 x1   
2     2 x2   
3     3 x3   </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb370"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb370-1"><a href="#cb370-1"></a>tb_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
    key val_y
  &lt;dbl&gt; &lt;chr&gt;
1     1 y1   
2     2 y2   
3     4 y3   </code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="left-join" class="slide level2">
<h2>Left join</h2>
<p>Imagina que queremos <span class="hl-yellow"><strong>incorporar</strong></span> a <code>tb_1</code> la <span class="hl-yellow"><strong>información de la tabla_2</strong></span>, identificando los registros por la columna key (indicando con <code>by = "key"</code> la columna por la que tiene que cruzar): queremos mantener todos los registros de la primera tabla y buscar cuales tienen id (mismo valor en <code>key</code>) también en la segunda tabla.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb372"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb372-1"><a href="#cb372-1"></a>tb_1  <span class="sc">|&gt;</span> </span>
<span id="cb372-2"><a href="#cb372-2"></a>  <span class="fu">left_join</span>(tb_2, <span class="at">by =</span> <span class="st">"key"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
    key val_x val_y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     3 x3    &lt;NA&gt; </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><img data-src="img/left_join.jpg"></p>
</div>
</div>
</section>
<section id="left-join-1" class="slide level2">
<h2>Left join</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb374"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb374-1"><a href="#cb374-1"></a>tb_1 <span class="sc">|&gt;</span> </span>
<span id="cb374-2"><a href="#cb374-2"></a>  <span class="fu">left_join</span>(tb_2, <span class="at">by =</span> <span class="st">"key"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
    key val_x val_y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     3 x3    &lt;NA&gt; </code></pre>
</div>
</div>
<p>Fíjate que los <span class="hl-yellow"><strong>registros de la primera cuya key no ha encontrado en la segunda</strong></span> les ha dado el valor de <span class="hl-yellow"><strong>ausente</strong></span>.</p>
</section>
<section id="right-join" class="slide level2">
<h2>Right join</h2>
<p>El <code>right_join()</code> realizará la operación contraria: vamos ahora a <span class="hl-yellow"><strong>incorporar</strong></span> a <code>tb_2</code> la <span class="hl-yellow"><strong>información de la tabla_2</strong></span>, identificando los registros por la columna key (indicando con <code>by = "key"</code> la columna por la que tiene que cruzar): queremos mantener todos los registros de la segunda y buscar cuales tienen id (mismo valor en <code>key</code>) también en la primera tabla.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb376"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb376-1"><a href="#cb376-1"></a>tb_1 <span class="sc">|&gt;</span> </span>
<span id="cb376-2"><a href="#cb376-2"></a>  <span class="fu">right_join</span>(tb_2, <span class="at">by =</span> <span class="st">"key"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
    key val_x val_y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     4 &lt;NA&gt;  y3   </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><img data-src="img/right_join.jpg"></p>
</div>
</div>
</section>
<section id="right-join-1" class="slide level2">
<h2>Right join</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb378"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb378-1"><a href="#cb378-1"></a>tb_1 <span class="sc">|&gt;</span> </span>
<span id="cb378-2"><a href="#cb378-2"></a>  <span class="fu">right_join</span>(tb_2, <span class="at">by =</span> <span class="st">"key"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
    key val_x val_y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     4 &lt;NA&gt;  y3   </code></pre>
</div>
</div>
<p>Fíjate que ahora los <span class="hl-yellow"><strong>registros de la segunda cuya key no ha encontrado en la primera</strong></span> son los que les ha dado el valor de <span class="hl-yellow"><strong>ausente</strong></span>.</p>
</section>
<section id="claves-y-sufijos" class="slide level2">
<h2>Claves y sufijos</h2>
<p>Las columnas clave que usaremos para el cruce <span class="hl-yellow"><strong>no siempre se llamarán igual</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb380"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb380-1"><a href="#cb380-1"></a>tb_1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="st">"val_x"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>))</span>
<span id="cb380-2"><a href="#cb380-2"></a>tb_2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"key_2"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>), <span class="st">"val_y"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<ul>
<li><code>by = c("key_2" = "key_2")</code>: le indicaremos en qué columna de cada tabla están las claves por las que vamos a cruzar.</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb381"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb381-1"><a href="#cb381-1"></a><span class="co"># Left</span></span>
<span id="cb381-2"><a href="#cb381-2"></a>tb_1 <span class="sc">|&gt;</span> </span>
<span id="cb381-3"><a href="#cb381-3"></a>  <span class="fu">left_join</span>(tb_2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="st">"key_2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  key_1 val_x val_y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     3 x3    &lt;NA&gt; </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb383"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb383-1"><a href="#cb383-1"></a><span class="co"># Right</span></span>
<span id="cb383-2"><a href="#cb383-2"></a>tb_1  <span class="sc">|&gt;</span> </span>
<span id="cb383-3"><a href="#cb383-3"></a>  <span class="fu">right_join</span>(tb_2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="st">"key_2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  key_1 val_x val_y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     4 &lt;NA&gt;  y3   </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="claves-y-sufijos-1" class="slide level2">
<h2>Claves y sufijos</h2>
<p>Además podemos <span class="hl-yellow"><strong>cruzar por varias columnas a la vez</strong></span> (interpretará como igual registro aquel que tenga el conjunto de claves igual), con <code>by = c("var1_t1" = "var1_t2", "var2_t1" = "var2_t2", ...)</code>. Modifiquemos el ejemplo anterior</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb385"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb385-1"><a href="#cb385-1"></a>tb_1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"k_11"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="st">"k_12"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>),  <span class="st">"val_x"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>))</span>
<span id="cb385-2"><a href="#cb385-2"></a>tb_2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"k_21"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>), <span class="st">"k_22"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"e"</span>), <span class="st">"val_y"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb386"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb386-1"><a href="#cb386-1"></a><span class="co"># Left</span></span>
<span id="cb386-2"><a href="#cb386-2"></a>tb_1 <span class="sc">|&gt;</span> </span>
<span id="cb386-3"><a href="#cb386-3"></a>  <span class="fu">left_join</span>(tb_2,</span>
<span id="cb386-4"><a href="#cb386-4"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"k_11"</span> <span class="ot">=</span> <span class="st">"k_21"</span>, <span class="st">"k_12"</span> <span class="ot">=</span> <span class="st">"k_22"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
   k_11 k_12  val_x val_y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
1     1 a     x1    y1   
2     2 b     x2    y2   
3     3 c     x3    &lt;NA&gt; </code></pre>
</div>
</div>
</div>
</section>
<section id="claves-y-sufijos-2" class="slide level2">
<h2>Claves y sufijos</h2>
<p>También podría suceder que al cruzar dos tablas, haya <span class="hl-yellow"><strong>columnas de valores que se llamen igual</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb388"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb388-1"><a href="#cb388-1"></a>tb_1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="st">"val"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>))</span>
<span id="cb388-2"><a href="#cb388-2"></a>tb_2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"key_2"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>), <span class="st">"val"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb389"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb389-1"><a href="#cb389-1"></a><span class="co"># Left</span></span>
<span id="cb389-2"><a href="#cb389-2"></a>tb_1 <span class="sc">|&gt;</span> </span>
<span id="cb389-3"><a href="#cb389-3"></a>  <span class="fu">left_join</span>(tb_2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="st">"key_2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  key_1 val.x val.y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     3 x3    &lt;NA&gt; </code></pre>
</div>
</div>
<p>Fíjate que <span class="hl-yellow"><strong>por defecto nos añade los sufijos</strong></span> <code>.x</code> y <code>.y</code> para indicarnos de que tabla vienen.</p>
</div>
</section>
<section id="claves-y-sufijos-3" class="slide level2">
<h2>Claves y sufijos</h2>
<p>Dicho <span class="hl-yellow"><strong>sufijo podemos especificárselo</strong></span> en el argumento opcional <code>suffix = ...</code>, que nos permita <span class="hl-yellow"><strong>distinguir las variables</strong></span> de una tabla y de otra.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb391"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb391-1"><a href="#cb391-1"></a><span class="co"># Left</span></span>
<span id="cb391-2"><a href="#cb391-2"></a>tb_1 <span class="sc">|&gt;</span></span>
<span id="cb391-3"><a href="#cb391-3"></a>  <span class="fu">left_join</span>(tb_2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="st">"key_2"</span>), <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">"_tabla1"</span>, <span class="st">"_tabla2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  key_1 val_tabla1 val_tabla2
  &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;     
1     1 x1         y1        
2     2 x2         y2        
3     3 x3         &lt;NA&gt;      </code></pre>
</div>
</div>
</section>
<section id="full-join" class="slide level2">
<h2>Full join</h2>
<p>Los dos anteriores casos forman lo que se conoce como <span class="hl-yellow"><strong>outer joins</strong></span>: cruces donde se mantienen observaciones que salgan en al menos una tabla. El tercer outer join es el conocido como <code>full_join()</code> que nos <span class="hl-yellow"><strong>mantendrá las observaciones de ambas</strong></span> tablas, <span class="hl-yellow"><strong>añadiendo las filas</strong></span> que no casen con la otra tabla.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb393"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb393-1"><a href="#cb393-1"></a>tb_1 <span class="sc">|&gt;</span> </span>
<span id="cb393-2"><a href="#cb393-2"></a>  <span class="fu">full_join</span>(tb_2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="st">"key_2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  key_1 val.x val.y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     3 x3    &lt;NA&gt; 
4     4 &lt;NA&gt;  y3   </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><img data-src="img/full_join.jpg"></p>
</div>
</div>
</section>
<section id="inner-join" class="slide level2">
<h2>Inner join</h2>
<p>Frente a los outer join está lo que se conoce como <span class="hl-yellow"><strong>inner join</strong></span>, con <code>inner_join()</code>: un cruce en el que solo se mantienen las <span class="hl-yellow"><strong>observaciones que salgan en ambas tablas</strong></span>, solo mantiene aquellos registros matcheados.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb395"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb395-1"><a href="#cb395-1"></a>tb_1 <span class="sc">|&gt;</span> </span>
<span id="cb395-2"><a href="#cb395-2"></a>  <span class="fu">inner_join</span>(tb_2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="st">"key_2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  key_1 val.x val.y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><img data-src="img/inner_join.png"></p>
</div>
</div>
</section>
<section id="inner-join-1" class="slide level2">
<h2>Inner join</h2>
<p>Fíjate que en términos de registros, <code>inner_join</code> si es conmutativa, <strong>nos da igual el orden de las tablas</strong>: lo único que cambia es el orden de las columnas que añade.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb397"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb397-1"><a href="#cb397-1"></a>tb_1 <span class="sc">|&gt;</span> </span>
<span id="cb397-2"><a href="#cb397-2"></a>  <span class="fu">inner_join</span>(tb_2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="st">"key_2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  key_1 val.x val.y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb399"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb399-1"><a href="#cb399-1"></a>tb_2 <span class="sc">|&gt;</span> </span>
<span id="cb399-2"><a href="#cb399-2"></a>  <span class="fu">inner_join</span>(tb_1, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"key_2"</span> <span class="ot">=</span> <span class="st">"key_1"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  key_2 val.x val.y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 y1    x1   
2     2 y2    x2   </code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="antisemi-join" class="slide level2">
<h2>Anti/semi join</h2>
<p>Por último tenemos dos herramientas interesantes para <span class="hl-yellow"><strong>filtrar (no cruzar) registros</strong></span>: <code>semi_join()</code> y <code>anti_join()</code>. El <span class="hl-yellow"><strong>semi join</strong></span> nos deja en la <span class="hl-yellow"><strong>primera tabla los registros que cuya clave está también en la segunda</strong></span> (como un inner join pero sin añadir la info de la segunda tabla). Y el segundo, los anti join, hace justo lo contrario (aquellos que no están).</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb401"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb401-1"><a href="#cb401-1"></a><span class="co"># semijoin</span></span>
<span id="cb401-2"><a href="#cb401-2"></a>tb_1 <span class="sc">|&gt;</span> </span>
<span id="cb401-3"><a href="#cb401-3"></a>  <span class="fu">semi_join</span>(tb_2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="st">"key_2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  key_1 val  
  &lt;int&gt; &lt;chr&gt;
1     1 x1   
2     2 x2   </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb403"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb403-1"><a href="#cb403-1"></a><span class="co"># antijoin</span></span>
<span id="cb403-2"><a href="#cb403-2"></a>tb_1 <span class="sc">|&gt;</span> </span>
<span id="cb403-3"><a href="#cb403-3"></a>  <span class="fu">anti_join</span>(tb_2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="st">"key_2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  key_1 val  
  &lt;int&gt; &lt;chr&gt;
1     3 x3   </code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="tu-turno-16" class="slide level2">
<h2>💻 Tu turno</h2>
<p><span style="color:#444442;"><strong>Intenta realizar los siguientes ejercicios sin mirar las soluciones</strong></span></p>
<p>Para los ejercicios usaremos las tablas disponibles en el paquete <code>{nycflights13}</code> (echa un vistazo antes)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb405"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb405-1"><a href="#cb405-1"></a><span class="fu">library</span>(nycflights13)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><span class="hl-yellow"><strong>airlines</strong></span>: nombre de aerolíneas (con su abreviatura).</li>
<li><span class="hl-yellow"><strong>airports</strong></span>: datos de aeropuertos (nombres, longitud, latitud, altitud, etc).</li>
<li><span class="hl-yellow"><strong>flights</strong></span>: datos de vuelos.</li>
<li><span class="hl-yellow"><strong>planes</strong></span>: datos de los aviones.</li>
<li><span class="hl-yellow"><strong>weather</strong></span>: datos meteorológicos horarios de las estaciones LGA, JFK y EWR.</li>
</ul>
</section>
<section id="tu-turno-16" class="slide level2">
<h2>💻 Tu turno</h2>
<p><span style="color:#444442;"><strong>Intenta realizar los siguientes ejercicios sin mirar las soluciones</strong></span></p>
<div class="panel-tabset">
<ul id="tabset-9" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-9-1"><span class="hl-yellow"><strong>Ejercicio 1</strong></span></a></li><li><a href="#tabset-9-2"><span class="hl-yellow"><strong>Ejercicio 2</strong></span></a></li><li><a href="#tabset-9-3"><span class="hl-yellow"><strong>Ejercicio 3</strong></span></a></li><li><a href="#tabset-9-4"><span class="hl-yellow"><strong>Ejercicio 4</strong></span></a></li><li><a href="#tabset-9-5"><span class="hl-yellow"><strong>Ejercicio 5</strong></span></a></li><li><a href="#tabset-9-6"><span class="hl-yellow"><strong>Ejercicio 6</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-9-1">
<p>📝 Del paquete <code>{nycflights13}</code> cruza la tabla <code>flights</code> con <code>airlines</code>. Queremos mantener todos los registros de vuelos, añadiendo la información de las aerolíneas a la tabla de aviones.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb406"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb406-1"><a href="#cb406-1"></a>flights_airlines <span class="ot">&lt;-</span></span>
<span id="cb406-2"><a href="#cb406-2"></a>  flights <span class="sc">|&gt;</span> </span>
<span id="cb406-3"><a href="#cb406-3"></a>  <span class="fu">left_join</span>(airlines, <span class="at">by =</span> <span class="st">"carrier"</span>)</span>
<span id="cb406-4"><a href="#cb406-4"></a>flights_airlines</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-9-2">
<p>📝 A la tabla obtenida del cruce del apartado anterior, cruza después con los datos de los aviones en <code>planes</code>, pero incluyendo solo aquellos vuelos de los que tengamos información de sus aviones (y viceversa).</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb407"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb407-1"><a href="#cb407-1"></a>flights_airlines_planes <span class="ot">&lt;-</span> </span>
<span id="cb407-2"><a href="#cb407-2"></a>  flights_airlines <span class="sc">|&gt;</span> </span>
<span id="cb407-3"><a href="#cb407-3"></a>  <span class="fu">inner_join</span>(planes, <span class="at">by =</span> <span class="st">"tailnum"</span>)</span>
<span id="cb407-4"><a href="#cb407-4"></a>flights_airlines_planes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-9-3">
<p>📝 Repite el ejercicio anterior pero conservando ambas variables <code>year</code> (en una es el año del vuelo, en la otra es el año de construcción del avión), y distinguiéndolas entre sí</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb408"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb408-1"><a href="#cb408-1"></a>flights_airlines_planes <span class="ot">&lt;-</span> </span>
<span id="cb408-2"><a href="#cb408-2"></a>  flights_airlines <span class="sc">|&gt;</span> </span>
<span id="cb408-3"><a href="#cb408-3"></a>  <span class="fu">inner_join</span>(planes, <span class="at">by =</span> <span class="st">"tailnum"</span>,</span>
<span id="cb408-4"><a href="#cb408-4"></a>             <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">"_flight"</span>, <span class="st">"_build_aircraft"</span>))</span>
<span id="cb408-5"><a href="#cb408-5"></a>flights_airlines_planes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-9-4">
<p>📝 Al cruce obtenido del ejercicio anterior incluye la longitud y latitud de los aeropuertos en <code>airports</code>, distinguiendo entre la latitud/longitud del aeropuerto en destino y en origen.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb409"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb409-1"><a href="#cb409-1"></a>flights_airlines_planes <span class="sc">%&gt;%</span></span>
<span id="cb409-2"><a href="#cb409-2"></a>  <span class="fu">left_join</span>(airports <span class="sc">%&gt;%</span> <span class="fu">select</span>(faa, lat, lon),</span>
<span id="cb409-3"><a href="#cb409-3"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"origin"</span> <span class="ot">=</span> <span class="st">"faa"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb409-4"><a href="#cb409-4"></a>  <span class="fu">rename</span>(<span class="at">lat_origin =</span> lat, <span class="at">lon_origin =</span> lon) <span class="sc">|&gt;</span> </span>
<span id="cb409-5"><a href="#cb409-5"></a>  <span class="fu">left_join</span>(airports <span class="sc">%&gt;%</span> <span class="fu">select</span>(faa, lat, lon),</span>
<span id="cb409-6"><a href="#cb409-6"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"dest"</span> <span class="ot">=</span> <span class="st">"faa"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb409-7"><a href="#cb409-7"></a>  <span class="fu">rename</span>(<span class="at">lat_dest =</span> lat, <span class="at">lon_dest =</span> lon)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-9-5">
<p>📝 Filtra de <code>airports</code> solo aquellos aeropuertos de los que salgan vuelos. Repite el proceso filtrado solo aquellos a los que lleguen vuelos</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb410"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb410-1"><a href="#cb410-1"></a>airports <span class="sc">|&gt;</span> </span>
<span id="cb410-2"><a href="#cb410-2"></a>  <span class="fu">semi_join</span>(flights, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"faa"</span> <span class="ot">=</span> <span class="st">"origin"</span>))</span>
<span id="cb410-3"><a href="#cb410-3"></a>airports <span class="sc">|&gt;</span> </span>
<span id="cb410-4"><a href="#cb410-4"></a>  <span class="fu">semi_join</span>(flights, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"faa"</span> <span class="ot">=</span> <span class="st">"dest"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-9-6">
<p>📝 ¿De cuántos vuelos no disponemos información del avión? Elimina antes los vuelos que no tengan identificar (diferente a NA) del avión</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb411"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb411-1"><a href="#cb411-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb411-2"><a href="#cb411-2"></a>  <span class="fu">drop_na</span>(tailnum) <span class="sc">|&gt;</span></span>
<span id="cb411-3"><a href="#cb411-3"></a>  <span class="fu">anti_join</span>(planes, <span class="at">by =</span> <span class="st">"tailnum"</span>) <span class="sc">|&gt;</span></span>
<span id="cb411-4"><a href="#cb411-4"></a>  <span class="fu">count</span>(tailnum, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="co"># de mayor a menor ya de paso</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="factores" class="title-slide slide level1 center">
<h1>Factores</h1>
<p><span style="color:#444442;"><strong>Trabajando con variables cualitativas</strong></span></p>
</section>
<section id="factores-1" class="slide level2">
<h2>Factores</h2>
<p>En el caso de las <span class="hl-yellow"><strong>variables cualitativas</strong></span>, llamaremos <strong>niveles o modalidades</strong> a los <strong>diferentes valores</strong> que pueden tomar estos datos. Por ejemplo, en el caso de la variable <code>sex</code> del conjunto <code>starwars</code>, tenemos 4 niveles permitidos: <code>female</code>, <code>hermaphroditic</code>, <code>male</code> y <code>none</code> (amén de datos ausentes).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb412"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb412-1"><a href="#cb412-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">count</span>(sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  sex                n
  &lt;chr&gt;          &lt;int&gt;
1 female            16
2 hermaphroditic     1
3 male              60
4 none               6
5 &lt;NA&gt;               4</code></pre>
</div>
</div>
</section>
<section id="factores-2" class="slide level2">
<h2>Factores</h2>
<p>Este tipo de variables se conocen en <code>R</code> como <span class="hl-yellow"><strong>factores</strong></span>. Y el paquete fundamental para tratarlos es <code>{forcats}</code> (del entorno <code>{tidyverse}</code>).</p>

<img data-src="./img/factors.jpg" class="r-stretch"></section>
<section id="factores-3" class="slide level2">
<h2>Factores</h2>
<p>Este paquete nos permite fijar los <span class="hl-yellow"><strong>niveles</strong></span> (guardados internamente como <code>levels</code>) que toma una determinada variable categórica, dándoles un <span class="hl-yellow"><strong>tratamiento diferente a las cadena de texto normales</strong></span>.</p>
<div class="fragment">
<p>Veamos un ejempo sencillo definiendo una variable <code>estado</code> que tome los valores <code>"sano"</code>, <code>"leve"</code> y <code>"grave"</code> de la siguiente manera.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb414"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb414-1"><a href="#cb414-1"></a>estado <span class="ot">&lt;-</span></span>
<span id="cb414-2"><a href="#cb414-2"></a>  <span class="fu">c</span>(<span class="st">"leve"</span>, <span class="st">"grave"</span>, <span class="st">"sano"</span>, <span class="st">"sano"</span>, <span class="st">"leve"</span>, <span class="st">"sano"</span>, <span class="st">"sano"</span>, <span class="st">"grave"</span>,</span>
<span id="cb414-3"><a href="#cb414-3"></a>    <span class="st">"grave"</span>, <span class="st">"leve"</span>, <span class="st">"grave"</span>, <span class="st">"sano"</span>, <span class="st">"sano"</span>)</span>
<span id="cb414-4"><a href="#cb414-4"></a>estado</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "leve"  "grave" "sano"  "sano"  "leve"  "sano"  "sano"  "grave" "grave"
[10] "leve"  "grave" "sano"  "sano" </code></pre>
</div>
</div>
<p>La variable <code>estado</code> actualmente es de <span class="hl-yellow"><strong>tipo texto</strong></span>, de tipo <code>chr</code>, algo que podemos comprobar con <code>class(estado)</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb416"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb416-1"><a href="#cb416-1"></a><span class="fu">class</span>(estado)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
</div>
</div>
</section>
<section id="factores-4" class="slide level2">
<h2>Factores</h2>
<p>Desde un punto de vista estadístico y computacional, para <code>R</code> esta variable ahora mismo sería equivalente una variable de nombres. Pero estadísticamente <span class="hl-yellow"><strong>no es lo mismo una variable con nombres</strong></span> (que identifican muchas veces el registro) que una variable categórica como estado que <span class="hl-yellow"><strong>solo puede tomar esos 3 niveles</strong></span>. ¿Cómo <span class="hl-yellow"><strong>convertir a factor</strong></span>?</p>
<div class="fragment">
<p>Haciendo uso de la función <code>as_factor()</code> del paquete <code>{forcats}</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb418"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb418-1"><a href="#cb418-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb418-2"><a href="#cb418-2"></a>estado_fct <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">paciente =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(estado),</span>
<span id="cb418-3"><a href="#cb418-3"></a>                     <span class="at">estado =</span> <span class="fu">as_factor</span>(estado))</span>
<span id="cb418-4"><a href="#cb418-4"></a>estado_fct</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 2
   paciente estado
      &lt;int&gt; &lt;fct&gt; 
 1        1 leve  
 2        2 grave 
 3        3 sano  
 4        4 sano  
 5        5 leve  
 6        6 sano  
 7        7 sano  
 8        8 grave 
 9        9 grave 
10       10 leve  
11       11 grave 
12       12 sano  
13       13 sano  </code></pre>
</div>
</div>
</div>
</section>
<section id="factores-5" class="slide level2">
<h2>Factores</h2>
<p>No solo ha cambiado la clase de la variable sino que ahora, debajo del valor guardado, nos aparece la frase <code>Levels: grave leve sano</code>: son las <span class="hl-yellow"><strong>modalidades o niveles</strong></span> de nuestra cualitativa.</p>
<p>&nbsp;</p>
<p>Imagina que ese día en el hospital no tuviésemos a <strong>nadie en estado grave</strong>: aunque ese día nuestra variable no tome dicho valor, el estado <code>grave</code> es un <span class="hl-yellow"><strong>nivel permitido en la base de datos</strong></span>, así que aunque lo eliminemos, por ser un factor, el nivel permanece (no lo tenemos ahora pero es un nivel permitido).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb420"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb420-1"><a href="#cb420-1"></a>estado_fct <span class="sc">|&gt;</span> </span>
<span id="cb420-2"><a href="#cb420-2"></a>  <span class="fu">filter</span>(estado <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"sano"</span>, <span class="st">"leve"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb420-3"><a href="#cb420-3"></a>  <span class="fu">pull</span>(estado)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] leve sano sano leve sano sano leve sano sano
Levels: leve grave sano</code></pre>
</div>
</div>
</section>
<section id="factores-6" class="slide level2">
<h2>Factores</h2>
<p>Con <code>factor()</code> podemos <span class="hl-yellow"><strong>especificar explícitamente</strong></span> los nombres de las modalidades, incluso si son nominales u <span class="hl-yellow"><strong>ordinales</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb422"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb422-1"><a href="#cb422-1"></a>estado_fct <span class="ot">&lt;-</span></span>
<span id="cb422-2"><a href="#cb422-2"></a>  <span class="fu">tibble</span>(<span class="at">paciente =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(estado),</span>
<span id="cb422-3"><a href="#cb422-3"></a>         <span class="at">estado =</span> <span class="fu">factor</span>(estado, <span class="at">ordered =</span> <span class="cn">TRUE</span>))</span>
<span id="cb422-4"><a href="#cb422-4"></a>estado_fct <span class="sc">|&gt;</span> <span class="fu">pull</span>(estado)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] leve  grave sano  sano  leve  sano  sano  grave grave leve  grave sano 
[13] sano 
Levels: grave &lt; leve &lt; sano</code></pre>
</div>
</div>
</section>
<section id="factores-7" class="slide level2">
<h2>Factores</h2>
<p>Con <code>levels = ...</code> podemos indicarle explícitamente el <span class="hl-yellow"><strong>orden de las modalidades</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb424"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb424-1"><a href="#cb424-1"></a>estado_fct <span class="ot">&lt;-</span></span>
<span id="cb424-2"><a href="#cb424-2"></a>  <span class="fu">tibble</span>(<span class="at">paciente =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(estado),</span>
<span id="cb424-3"><a href="#cb424-3"></a>         <span class="at">estado =</span> <span class="fu">factor</span>(estado,</span>
<span id="cb424-4"><a href="#cb424-4"></a>                         <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"sano"</span>, <span class="st">"leve"</span>, <span class="st">"grave"</span>),</span>
<span id="cb424-5"><a href="#cb424-5"></a>                         <span class="at">ordered =</span> <span class="cn">TRUE</span>))</span>
<span id="cb424-6"><a href="#cb424-6"></a>estado_fct <span class="sc">|&gt;</span> <span class="fu">pull</span>(estado)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] leve  grave sano  sano  leve  sano  sano  grave grave leve  grave sano 
[13] sano 
Levels: sano &lt; leve &lt; grave</code></pre>
</div>
</div>
</section>
<section id="factores-8" class="slide level2">
<h2>Factores</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>Si queremos indicarle que <span class="hl-yellow"><strong>elimine un nivel no usado</strong></span> en ese momento (y que queremos excluir de la definición) podemos hacerlo con <code>fct_drop()</code></p>
</div><div class="column" style="width:50%;">
<p><img data-src="img/drop_factor.jpg"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb426"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb426-1"><a href="#cb426-1"></a>estado_fct <span class="sc">|&gt;</span> </span>
<span id="cb426-2"><a href="#cb426-2"></a>  <span class="fu">filter</span>(estado <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"sano"</span>, <span class="st">"leve"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb426-3"><a href="#cb426-3"></a>  <span class="fu">mutate</span>(<span class="at">estado =</span> <span class="fu">fct_drop</span>(estado)) <span class="sc">|&gt;</span> </span>
<span id="cb426-4"><a href="#cb426-4"></a>  <span class="fu">pull</span>(estado)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] leve sano sano leve sano sano leve sano sano
Levels: sano &lt; leve</code></pre>
</div>
</div>
</section>
<section id="factores-9" class="slide level2">
<h2>Factores</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>Al igual que podemos eliminar niveles podemos <span class="hl-yellow"><strong>ampliar los niveles existentes</strong></span> (aunque no existan datos de ese nivel en ese momento) con <code>fct_expand()</code></p>
</div><div class="column" style="width:50%;">
<p><img data-src="./img/factor_expand.jpg"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb428"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb428-1"><a href="#cb428-1"></a>estado_fct <span class="sc">|&gt;</span> </span>
<span id="cb428-2"><a href="#cb428-2"></a>  <span class="fu">mutate</span>(<span class="at">estado =</span> <span class="fu">fct_expand</span>(estado, <span class="fu">c</span>(<span class="st">"UCI"</span>, <span class="st">"fallecido"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb428-3"><a href="#cb428-3"></a>  <span class="fu">pull</span>(estado)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] leve  grave sano  sano  leve  sano  sano  grave grave leve  grave sano 
[13] sano 
Levels: sano &lt; leve &lt; grave &lt; UCI &lt; fallecido</code></pre>
</div>
</div>
</section>
<section id="factores-10" class="slide level2">
<h2>Factores</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>Además con <code>fct_explicit_na()</code> podemos <span class="hl-yellow"><strong>asignar un nivel a los valores</strong></span> para que sea incluido dicho nivel en los análisis y visualizaciones.</p>
</div><div class="column" style="width:50%;">
<p><img data-src="./img/factor_explicit.jpg"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb430"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb430-1"><a href="#cb430-1"></a><span class="fu">fct_explicit_na</span>(<span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="cn">NA</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] a         b         (Missing)
Levels: a b (Missing)</code></pre>
</div>
</div>
</section>
<section id="factores-11" class="slide level2">
<h2>Factores</h2>
<p>Incluso una vez definidos podemos <span class="hl-yellow"><strong>reordenar los níveles</strong></span> con <code>fct_relevel()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb432"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb432-1"><a href="#cb432-1"></a>estado_fct_expand <span class="ot">&lt;-</span> </span>
<span id="cb432-2"><a href="#cb432-2"></a>  estado_fct <span class="sc">|&gt;</span> </span>
<span id="cb432-3"><a href="#cb432-3"></a>  <span class="fu">mutate</span>(<span class="at">estado =</span> <span class="fu">fct_expand</span>(estado, <span class="fu">c</span>(<span class="st">"UCI"</span>, <span class="st">"fallecido"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb432-4"><a href="#cb432-4"></a>  <span class="fu">pull</span>(estado)</span>
<span id="cb432-5"><a href="#cb432-5"></a></span>
<span id="cb432-6"><a href="#cb432-6"></a>estado_fct_expand <span class="sc">|&gt;</span></span>
<span id="cb432-7"><a href="#cb432-7"></a>  <span class="fu">fct_relevel</span>(<span class="fu">c</span>(<span class="st">"fallecido"</span>, <span class="st">"leve"</span>, <span class="st">"sano"</span>, <span class="st">"grave"</span>, <span class="st">"UCI"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] leve  grave sano  sano  leve  sano  sano  grave grave leve  grave sano 
[13] sano 
Levels: fallecido &lt; leve &lt; sano &lt; grave &lt; UCI</code></pre>
</div>
</div>
</section>
<section id="factores-12" class="slide level2">
<h2>Factores</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>Esta forma de trabajar con variables cualitativas nos permite dar una <span class="hl-yellow"><strong>definición teórica</strong></span> de nuestra base de datos, pudiendo incluso contar valores que aún no existen (pero que podrían), haciendo uso de <code>fct_count()</code></p>
</div><div class="column" style="width:50%;">
<p><img data-src="./img/fct_count.jpg"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb434"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb434-1"><a href="#cb434-1"></a>estado_fct <span class="sc">|&gt;</span> </span>
<span id="cb434-2"><a href="#cb434-2"></a>  <span class="fu">mutate</span>(<span class="at">estado =</span> <span class="fu">fct_expand</span>(estado, <span class="fu">c</span>(<span class="st">"UCI"</span>, <span class="st">"fallecido"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb434-3"><a href="#cb434-3"></a>  <span class="fu">pull</span>(estado) <span class="sc">|&gt;</span> </span>
<span id="cb434-4"><a href="#cb434-4"></a>  <span class="fu">fct_count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  f             n
  &lt;ord&gt;     &lt;int&gt;
1 sano          6
2 leve          3
3 grave         4
4 UCI           0
5 fallecido     0</code></pre>
</div>
</div>
</section>
<section id="factores-13" class="slide level2">
<h2>Factores</h2>
<p>Los níveles también podemos <span class="hl-yellow"><strong>ordenarlos por frecuencia</strong></span> con <code>fct_infreq()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb436"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb436-1"><a href="#cb436-1"></a>estado_fct <span class="sc">|&gt;</span> </span>
<span id="cb436-2"><a href="#cb436-2"></a>  <span class="fu">mutate</span>(<span class="at">estado =</span> <span class="fu">fct_infreq</span>(estado)) <span class="sc">|&gt;</span> </span>
<span id="cb436-3"><a href="#cb436-3"></a>  <span class="fu">pull</span>(estado) <span class="sc">|&gt;</span> </span>
<span id="cb436-4"><a href="#cb436-4"></a>  <span class="fu">fct_count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  f         n
  &lt;ord&gt; &lt;int&gt;
1 sano      6
2 grave     4
3 leve      3</code></pre>
</div>
</div>
</section>
<section id="factores-14" class="slide level2">
<h2>Factores</h2>
<p>A veces querremos <span class="hl-yellow"><strong>agrupar niveles</strong></span>, por ejemplo, no permitiendo niveles que <span class="hl-yellow"><strong>no sucedan un mínimo de veces</strong></span> con <code>fct_lump_min(.., min = ..)</code> (las observaciones que no lo cumplan irán a un <strong>nivel genérico</strong> llamado <code>Other</code>, aunque se puede cambiar con el argumento <code>other_level</code>).</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb438"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb438-1"><a href="#cb438-1"></a>estado_fct <span class="sc">|&gt;</span> </span>
<span id="cb438-2"><a href="#cb438-2"></a>  <span class="fu">pull</span>(estado) <span class="sc">|&gt;</span> </span>
<span id="cb438-3"><a href="#cb438-3"></a>  <span class="fu">fct_lump_min</span>(<span class="at">min =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] Other grave sano  sano  Other sano  sano  grave grave Other grave sano 
[13] sano 
Levels: sano &lt; grave &lt; Other</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb440"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb440-1"><a href="#cb440-1"></a>estado_fct <span class="sc">|&gt;</span> </span>
<span id="cb440-2"><a href="#cb440-2"></a>  <span class="fu">pull</span>(estado) <span class="sc">|&gt;</span> </span>
<span id="cb440-3"><a href="#cb440-3"></a>  <span class="fu">fct_lump_min</span>(<span class="at">min =</span> <span class="dv">4</span>,</span>
<span id="cb440-4"><a href="#cb440-4"></a>               <span class="at">other_level =</span> <span class="st">"otros"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] otros grave sano  sano  otros sano  sano  grave grave otros grave sano 
[13] sano 
Levels: sano &lt; grave &lt; otros</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="factores-15" class="slide level2">
<h2>Factores</h2>
<p>Podemos hacer algo equivalente pero en función de su <span class="hl-yellow"><strong>frecuencia relativa</strong></span> con <code>fct_lump_prop()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb442"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb442-1"><a href="#cb442-1"></a>estado_fct <span class="sc">|&gt;</span> </span>
<span id="cb442-2"><a href="#cb442-2"></a>  <span class="fu">pull</span>(estado) <span class="sc">|&gt;</span> </span>
<span id="cb442-3"><a href="#cb442-3"></a>  <span class="fu">fct_lump_prop</span>(<span class="at">prop =</span> <span class="fl">0.4</span>,</span>
<span id="cb442-4"><a href="#cb442-4"></a>                <span class="at">other_level =</span> <span class="st">"otros"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] otros otros sano  sano  otros sano  sano  otros otros otros otros sano 
[13] sano 
Levels: sano &lt; otros</code></pre>
</div>
</div>
</section>
<section id="factores-16" class="slide level2">
<h2>Factores</h2>
<p>Esto lo podemos aplicar a nuestros conjuntos de datos para <span class="hl-yellow"><strong>recategorizar variables</strong></span> de forma muy rápida.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb444"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb444-1"><a href="#cb444-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb444-2"><a href="#cb444-2"></a>  <span class="fu">drop_na</span>(species) <span class="sc">|&gt;</span> </span>
<span id="cb444-3"><a href="#cb444-3"></a>  <span class="fu">mutate</span>(<span class="at">species =</span></span>
<span id="cb444-4"><a href="#cb444-4"></a>           <span class="fu">fct_lump_min</span>(species, <span class="at">min =</span> <span class="dv">3</span>,</span>
<span id="cb444-5"><a href="#cb444-5"></a>                        <span class="at">other_level =</span> <span class="st">"Otras"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb444-6"><a href="#cb444-6"></a>  <span class="fu">count</span>(species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
  species     n
  &lt;fct&gt;   &lt;int&gt;
1 Droid       6
2 Gungan      3
3 Human      35
4 Otras      39</code></pre>
</div>
</div>
</section>
<section id="factores-17" class="slide level2">
<h2>Factores</h2>
<p>Con <code>fct_reorder()</code> podemos también indicar que queremos <span class="hl-yellow"><strong>ordenar los factores</strong></span> en función de una función aplicada a otra variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb446"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb446-1"><a href="#cb446-1"></a>starwars_factor <span class="ot">&lt;-</span> </span>
<span id="cb446-2"><a href="#cb446-2"></a>  starwars <span class="sc">|&gt;</span> </span>
<span id="cb446-3"><a href="#cb446-3"></a>  <span class="fu">drop_na</span>(height, species) <span class="sc">|&gt;</span> </span>
<span id="cb446-4"><a href="#cb446-4"></a>  <span class="fu">mutate</span>(<span class="at">species =</span></span>
<span id="cb446-5"><a href="#cb446-5"></a>           <span class="fu">fct_lump_min</span>(species, <span class="at">min =</span> <span class="dv">3</span>,</span>
<span id="cb446-6"><a href="#cb446-6"></a>                        <span class="at">other_level =</span> <span class="st">"Otras"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb447"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb447-1"><a href="#cb447-1"></a>starwars_factor <span class="sc">|&gt;</span> <span class="fu">pull</span>(species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] Human  Droid  Droid  Human  Human  Human  Human  Droid  Human  Human 
[11] Human  Human  Otras  Human  Otras  Otras  Human  Human  Otras  Human 
[21] Human  Droid  Otras  Human  Human  Otras  Human  Otras  Otras  Human 
[31] Otras  Human  Gungan Gungan Gungan Otras  Otras  Human  Otras  Otras 
[41] Otras  Otras  Otras  Otras  Human  Otras  Otras  Otras  Otras  Otras 
[51] Otras  Otras  Otras  Human  Human  Human  Otras  Otras  Otras  Human 
[61] Human  Human  Human  Otras  Otras  Otras  Otras  Human  Otras  Droid 
[71] Otras  Otras  Otras  Otras  Otras  Human  Otras  Human 
Levels: Droid Gungan Human Otras</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb449"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb449-1"><a href="#cb449-1"></a>starwars_factor <span class="sc">|&gt;</span></span>
<span id="cb449-2"><a href="#cb449-2"></a>  <span class="fu">mutate</span>(<span class="at">species =</span> <span class="fu">fct_reorder</span>(species, height, mean)) <span class="sc">|&gt;</span> </span>
<span id="cb449-3"><a href="#cb449-3"></a>  <span class="fu">pull</span>(species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] Human  Droid  Droid  Human  Human  Human  Human  Droid  Human  Human 
[11] Human  Human  Otras  Human  Otras  Otras  Human  Human  Otras  Human 
[21] Human  Droid  Otras  Human  Human  Otras  Human  Otras  Otras  Human 
[31] Otras  Human  Gungan Gungan Gungan Otras  Otras  Human  Otras  Otras 
[41] Otras  Otras  Otras  Otras  Human  Otras  Otras  Otras  Otras  Otras 
[51] Otras  Otras  Otras  Human  Human  Human  Otras  Otras  Otras  Human 
[61] Human  Human  Human  Otras  Otras  Otras  Otras  Human  Otras  Droid 
[71] Otras  Otras  Otras  Otras  Otras  Human  Otras  Human 
Levels: Droid Otras Human Gungan</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="tu-turno-14" class="slide level2">
<h2>💻 Tu turno</h2>
<p><span style="color:#444442;"><strong>Intenta realizar los siguientes ejercicios sin mirar las soluciones</strong></span></p>
<div class="panel-tabset">
<ul id="tabset-10" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-10-1"><span class="hl-yellow"><strong>Ejercicio 1</strong></span></a></li><li><a href="#tabset-10-2"><span class="hl-yellow"><strong>Ejercicio 2</strong></span></a></li><li><a href="#tabset-10-3"><span class="hl-yellow"><strong>Ejercicio 3</strong></span></a></li><li><a href="#tabset-10-4"><span class="hl-yellow"><strong>Ejercicio 4</strong></span></a></li><li><a href="#tabset-10-5"><span class="hl-yellow"><strong>Ejercicio 5</strong></span></a></li><li><a href="#tabset-10-6"><span class="hl-yellow"><strong>Ejercicio 6</strong></span></a></li><li><a href="#tabset-10-7"><span class="hl-yellow"><strong>Ejercicio 7</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-10-1">
<p>📝 Dada la variable <code>meses</code> definida debajo (definida como un vector de caracteres), convierte dicha variable a factor (solo eso)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb451"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb451-1"><a href="#cb451-1"></a>meses <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Ene"</span>, <span class="st">"Feb"</span>, <span class="st">"Mar"</span>, <span class="st">"Abr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb452"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb452-1"><a href="#cb452-1"></a>meses <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Ene"</span>, <span class="st">"Feb"</span>, <span class="st">"Mar"</span>, <span class="st">"Abr"</span>)</span>
<span id="cb452-2"><a href="#cb452-2"></a>meses_fct <span class="ot">&lt;-</span> <span class="fu">as_factor</span>(meses)</span>
<span id="cb452-3"><a href="#cb452-3"></a>meses_fct</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-10-2">
<p>📝 Dada la variable <code>meses</code> definida debajo convierte dicha variable a factor pero indicando los niveles de forma correcta.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb453"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb453-1"><a href="#cb453-1"></a>meses <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="st">"Abr"</span>, <span class="st">"Ene"</span>, <span class="st">"Oct"</span>, <span class="st">"Jul"</span>, <span class="st">"Ene"</span>, <span class="st">"Sep"</span>, <span class="cn">NA</span>, <span class="st">"Feb"</span>, <span class="st">"Dic"</span>,</span>
<span id="cb453-2"><a href="#cb453-2"></a>           <span class="st">"Jul"</span>, <span class="st">"Mar"</span>, <span class="st">"Ene"</span>, <span class="st">"Mar"</span>, <span class="st">"Feb"</span>, <span class="st">"Abr"</span>, <span class="st">"May"</span>, <span class="st">"Oct"</span>, <span class="st">"Sep"</span>,  <span class="cn">NA</span>,</span>
<span id="cb453-3"><a href="#cb453-3"></a>           <span class="st">"Dic"</span>, <span class="st">"Jul"</span>, <span class="st">"Nov"</span>, <span class="st">"Feb"</span>, <span class="st">"Oct"</span>, <span class="st">"Jun"</span>, <span class="st">"Sep"</span>, <span class="st">"Oct"</span>, <span class="st">"Oct"</span>, <span class="st">"Sep"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb454"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb454-1"><a href="#cb454-1"></a>meses <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="st">"Abr"</span>, <span class="st">"Ene"</span>, <span class="st">"Oct"</span>, <span class="st">"Jul"</span>, <span class="st">"Ene"</span>, <span class="st">"Sep"</span>, <span class="cn">NA</span>, <span class="st">"Feb"</span>, <span class="st">"Dic"</span>,</span>
<span id="cb454-2"><a href="#cb454-2"></a>           <span class="st">"Jul"</span>, <span class="st">"Mar"</span>, <span class="st">"Ene"</span>, <span class="st">"Mar"</span>, <span class="st">"Feb"</span>, <span class="st">"Abr"</span>, <span class="st">"May"</span>, <span class="st">"Oct"</span>, <span class="st">"Sep"</span>,  <span class="cn">NA</span>,</span>
<span id="cb454-3"><a href="#cb454-3"></a>           <span class="st">"Dic"</span>, <span class="st">"Jul"</span>, <span class="st">"Nov"</span>, <span class="st">"Feb"</span>, <span class="st">"Oct"</span>, <span class="st">"Jun"</span>, <span class="st">"Sep"</span>, <span class="st">"Oct"</span>, <span class="st">"Oct"</span>, <span class="st">"Sep"</span>)</span>
<span id="cb454-4"><a href="#cb454-4"></a></span>
<span id="cb454-5"><a href="#cb454-5"></a><span class="co"># Orden de niveles correcto e incluimos agosto aunque no haya</span></span>
<span id="cb454-6"><a href="#cb454-6"></a>meses_fct <span class="ot">&lt;-</span></span>
<span id="cb454-7"><a href="#cb454-7"></a>  <span class="fu">factor</span>(meses,</span>
<span id="cb454-8"><a href="#cb454-8"></a>         <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Ene"</span>, <span class="st">"Feb"</span>, <span class="st">"Mar"</span>, <span class="st">"Abr"</span>, <span class="st">"May"</span>, <span class="st">"Jun"</span>, <span class="st">"Jul"</span>, <span class="st">"Ago"</span>, <span class="st">"Sep"</span>, <span class="st">"Oct"</span>, <span class="st">"Nov"</span>, <span class="st">"Dic"</span>))</span>
<span id="cb454-9"><a href="#cb454-9"></a>meses_fct</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-10-3">
<p>📝 Cuenta cuantos valores hay de cada mes pero teniendo en cuenta que son factores (quizás haya niveles sin ser usados y de los que debería obtener un 0).</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb455"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb455-1"><a href="#cb455-1"></a>meses_fct <span class="sc">|&gt;</span> <span class="fu">fct_count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-10-4">
<p>📝 Dado que hay ausentes, indica que los ausentes sea un decimotercer nivel etiquetado como “ausente”.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb456"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb456-1"><a href="#cb456-1"></a>meses_fct <span class="ot">&lt;-</span> </span>
<span id="cb456-2"><a href="#cb456-2"></a>  meses_fct <span class="sc">|&gt;</span></span>
<span id="cb456-3"><a href="#cb456-3"></a>  <span class="fu">fct_explicit_na</span>(<span class="at">na_level =</span> <span class="st">"ausente"</span>)</span>
<span id="cb456-4"><a href="#cb456-4"></a>meses_fct</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-10-5">
<p>📝 Elimina los niveles no usados.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb457"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb457-1"><a href="#cb457-1"></a>meses_fct <span class="ot">&lt;-</span> </span>
<span id="cb457-2"><a href="#cb457-2"></a>  meses_fct <span class="sc">|&gt;</span></span>
<span id="cb457-3"><a href="#cb457-3"></a>  <span class="fu">fct_drop</span>()</span>
<span id="cb457-4"><a href="#cb457-4"></a>meses_fct</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-10-6">
<p>📝 Ordena los niveles por frecuencia de aparición.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb458"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb458-1"><a href="#cb458-1"></a>meses_fct <span class="sc">|&gt;</span> </span>
<span id="cb458-2"><a href="#cb458-2"></a>  <span class="fu">fct_infreq</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-10-7">
<p>📝 Agrupa niveles de forma que todo nivel que no aparezca al menos el 7% de las veces se agrupe en un nivel llamado “otros meses”</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb459"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb459-1"><a href="#cb459-1"></a>meses_fct <span class="ot">&lt;-</span></span>
<span id="cb459-2"><a href="#cb459-2"></a>  meses_fct <span class="sc">|&gt;</span> </span>
<span id="cb459-3"><a href="#cb459-3"></a>  <span class="fu">fct_lump_prop</span>(<span class="at">prop =</span> <span class="fl">0.07</span>, <span class="at">other_level =</span> <span class="st">"otros"</span>)</span>
<span id="cb459-4"><a href="#cb459-4"></a>meses_fct</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="el-mundo-github" class="title-slide slide level1 center">
<h1>El mundo Github</h1>
<p><span style="color:#444442;"><strong>Trabajar ordenados, publicar resultados, replicabilidad de lo realizado</strong></span></p>
</section>
<section id="qué-es-github" class="slide level2">
<h2>¿Qué es Github?</h2>
<p><span class="hl-yellow"><strong>GitHub</strong></span> es la plataforma colaborativa más conocida basada en el <span class="hl-yellow"><strong>sistema de control de versiones Git</strong></span></p>
<div class="fragment">
<ul>
<li><span class="hl-purple"><strong>¿Qué es Git?</strong></span> Git es un sistema de <span class="hl-yellow"><strong>control de versiones</strong></span>: una especie de <span class="hl-yellow"><strong>Dropbox</strong></span> para facilitar la <span class="hl-yellow"><strong>programación colaborativa</strong></span> entre un grupo de personas, permitiendo llevar la <span class="hl-yellow"><strong>trazabilidad de los cambios</strong></span> realizados.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-purple"><strong>¿Qué es Github?</strong></span> Nuestra <span class="hl-yellow"><strong>plataforma/interfaz</strong></span> para ejecutar el control de versiones: nos servirá no solo para trabajar colaborativamente sino para <span class="hl-yellow"><strong>hacer transparente</strong></span> el proceso de construcción de nuestros proyectos de código.</li>
</ul>
</div>
<div class="fragment">
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Importante</strong></p>
</div>
<div class="callout-content">
<p>Desde el 4 de junio de 2018 Github es de Microsoft (ergo el código que subas también)</p>
</div>
</div>
</div>
</div>
</section>
<section id="visión-general" class="slide level2">
<h2>Visión general</h2>
<p>Tras hacernos una cuenta en Github, <span class="hl-purple"><strong>arriba a la derecha</strong></span> tendremos un círculo, y haciendo click en <span class="hl-purple"><strong>Your Profile</strong></span>, veremos algo similar a esto</p>
<div class="columns">
<div class="column" style="width:55%;">
<p><img data-src="img/github_1.png"></p>
</div><div class="column" style="width:45%;">
<ul>
<li><p><span class="hl-purple"><strong>Edit profile</strong></span>: nos permite añadir una <span class="hl-yellow"><strong>descripción y foto de perfil</strong></span>.</p></li>
<li><p><span class="hl-purple"><strong>Overview</strong></span>: en ese panel de cuadrados se <span class="hl-yellow"><strong>visualizará nuestra actividad</strong></span> a lo largo del tiempo.</p></li>
<li><p><span class="hl-purple"><strong>Repositories</strong></span>: el códugo será subido a <span class="hl-yellow"><strong>repositorios</strong></span>, el equivalente a nuestras carpetas compartidas en Dropbox.</p></li>
</ul>
</div>
</div>
</section>
<section id="primer-uso-consumidor" class="slide level2">
<h2>Primer uso: consumidor</h2>
<p>Antes de aprender como crear repositorios, Github también nos servirá para</p>
<ul>
<li><span class="hl-purple"><strong>Acceder a código</strong></span> ajeno</li>
<li><span class="hl-purple"><strong>Proponer mejoras</strong></span> a otros usuarios, e incluso proponer <span class="hl-yellow"><strong>correcciones de error que detectemos</strong></span> de software que usemos</li>
</ul>
<div class="fragment">
<ul>
<li><span class="hl-purple"><strong>Instalar paquetes de R</strong></span>. En muchas ocasiones los desarrolladores de paquetes suben las actualizaciones a CRAN cada cierto tiempo, y en otras el software no es suficientemente «amplio» para poder ser subido como paquete.</li>
</ul>
<p>El código de paquetes que no tengamos subido en CRAN podremos <span class="hl-yellow"><strong>instalarlo como código desde Github</strong></span></p>
</div>
</section>
<section id="instalar-desde-github" class="slide level2">
<h2>Instalar desde Github</h2>
<p>Por ejemplo, vamos a instalar un paquete llamado <a href="https://github.com/jbgb13/peRReo"><code>{peRReo}</code></a>, cuya única función es darnos <span class="hl-yellow"><strong>paletas de colores</strong></span> basadas en portadas de <span class="hl-yellow"><strong>álbumes de música urbana</strong></span></p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/perrreo.png"></p>
</div><div class="column" style="width:50%;">
<p><img data-src="img/rosalia.png" width="360"></p>
</div>
</div>
<div class="fragment">
<p>Para ello antes tendremos que instalar un <span class="hl-yellow"><strong>conjunto de paquetes para desarrolladores</strong></span> llamado <code>{devtools}</code>, que nos permitirá la instalación desde Github</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb460"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb460-1"><a href="#cb460-1"></a><span class="fu">install.packages</span>(<span class="st">"devtools"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="instalar-desde-github-1" class="slide level2">
<h2>Instalar desde Github</h2>
<p>Las <span class="hl-yellow"><strong>instrucciones de instalación</strong></span> suelen venir detalladas en la portada del repositorio</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/install_perreo.png"></p>
</div><div class="column" style="width:50%;">
<p><img data-src="img/rosalia.png" width="310"></p>
</div>
</div>
<div class="fragment">
<p>En la mayoría de casos bastará con la función <code>install_github()</code> (del paquete que acabamos de instalar), pasándole como argumento la <span class="hl-yellow"><strong>ruta del repositorio</strong></span> (sin “github.com/”).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb461"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb461-1"><a href="#cb461-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"jbgb13/peRReo"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ya puedes perrear con ggplot ;)</p>
</div>
</section>
<section id="descargar-desde-github" class="slide level2">
<h2>Descargar desde Github</h2>
<p>La mayoría de veces lo que subamos no será un paquete de R como tal sino que <span class="hl-yellow"><strong>subiremos un código más o menos organizado</strong></span> y comentado. En ese caso podremos <span class="hl-yellow"><strong>descargar el repo entero</strong></span> haciendo click <span class="hl-green"><strong>Code</strong></span> y luego Download ZIP.</p>
<p>Por ejemplo, vamos a descargarnos los scripts de dataviz que han subido desde el <a href="https://github.com/ceopinio/bop-grafics">Centre d’Estudis d’Opinió</a></p>

<img data-src="img/ceo_github.png" class="r-stretch"></section>
<section id="ideal" class="slide level2">
<h2>Ideal</h2>

<img data-src="img/abogados_simpson.jpeg" width="600" class="r-stretch"><p><span class="hl-purple"><strong>¿Lo ideal?</strong></span> Tener dos tipos de repositorios</p>
<ul>
<li><p>Una <span class="hl-yellow"><strong>colección de repositorios públicos (producción)</strong></span> donde hacer transparente el código y los datos (<span class="hl-purple"><strong>ya validados</strong></span>), coordinado por un nº reducido de personas.</p></li>
<li><p>Una <span class="hl-yellow"><strong>colección de repositorios privados (desarrollo)</strong></span> donde esté todo el equipo colaborando y donde se haga el <span class="hl-purple"><strong>trabajo del día</strong></span>, con trazabilidad interna.</p></li>
</ul>
</section>
<section id="nuestro-primer-repositorio" class="slide level2">
<h2>Nuestro primer repositorio</h2>
<p>Vamos a <span class="hl-yellow"><strong>crear nuestro primero repositorio</strong></span> que servirá además como <span class="hl-yellow"><strong>carta de presentación</strong></span> de nuestro perfil en Github.</p>
<ol type="1">
<li><p><span class="hl-purple"><strong>Repositories</strong></span>: hacemos click en las pestaña de Repositories.</p></li>
<li><p><span class="hl-purple"><strong>New</strong></span>: hacemos click en el <span class="hl-green"><strong>botón verde New</strong></span> para crear un nuevo repositorio</p></li>
</ol>

<img data-src="img/new_repo.png" class="r-stretch"></section>
<section id="nuestro-primer-repositorio-1" class="slide level2">
<h2>Nuestro primer repositorio</h2>
<ul>
<li><p><span class="hl-purple"><strong>Repository name</strong></span>: el <span class="hl-yellow"><strong>nombre del repositorio</strong></span>. En este caso vamos a crear un repositorio muy concreto: el nombre debe <span class="hl-yellow"><strong>coincidir exactamente con tu nombre de usuario</strong></span></p></li>
<li><p><span class="hl-purple"><strong>Description</strong></span>: descripción de tu repositorio. En este caso será un repo de presentación.</p></li>
</ul>

<img data-src="img/repo_init_1.png" class="r-stretch"></section>
<section id="nuestro-primer-repositorio-2" class="slide level2">
<h2>Nuestro primer repositorio</h2>
<ul>
<li><p><span class="hl-purple"><strong>Public vs private</strong></span>: con cada repositorio tendremos la opción de hacer el repositorio</p>
<ul>
<li><span class="hl-purple"><strong>público</strong></span>: todos los usuarios podrán ver el código así cómo la trazabilidad de su desarrollo (qué se añade y cuándo). Es para mí la opción más recomendable cuando quieres darle <span class="hl-yellow"><strong>visibilidad y transparencia</strong></span> a tu trabajo</li>
<li><span class="hl-purple"><strong>privado</strong></span>: solo tendrán acceso al repositorio aquellos usuarios a los que se lo permitas. No se podrá visualizar ni instalar nada de él fuera de Github.</li>
</ul></li>
</ul>

<img data-src="img/repo_init_2.png" class="r-stretch"><p>En este caso concreto, dado que será un repositorio de presentación, lo <span class="hl-yellow"><strong>haremos público</strong></span>.</p>
</section>
<section id="nuestro-primer-repositorio-3" class="slide level2">
<h2>Nuestro primer repositorio</h2>
<ul>
<li><span class="hl-purple"><strong>Add a README file</strong></span>: un README file será el archivo donde incluiremos las <span class="hl-yellow"><strong>instrucciones y detalles de uso</strong></span> a los demás (en el caso de <code>{peRReo}</code> era el archivo que contenía los detalles de instalación)</li>
</ul>

<img data-src="img/repo_init_3.png" class="r-stretch"><p>De momento <span class="hl-red"><strong>ignoraremos los demás campos</strong></span> para este primer repositorio.</p>
</section>
<section id="nuestro-primer-repositorio-4" class="slide level2">
<h2>Nuestro primer repositorio</h2>

<img data-src="img/repo_init_1.png" class="r-stretch"><p>Por defecto Github asume que este repositorio, con el <span class="hl-yellow"><strong>mismo nombre que nuestro usuario</strong></span> será el repositorio que querremos que se presente de inicio cuando alguien entra en nuestro perfil, y será el repositorio donde [<strong>incluir en el README.md</strong>] una presentación de nosotros y un índice de tu trabajo (si quieres).</p>
</section>
<section id="nuestro-primer-repositorio-5" class="slide level2">
<h2>Nuestro primer repositorio</h2>

<img data-src="img/profile_github_md.png" class="r-stretch"><p>Fíjate que ahora en nuestra <span class="hl-yellow"><strong>portada tenemos dicho README.md</strong></span> que podemos personalizar a nuestro gusto haciendo uso de <span class="hl-yellow"><strong>html y markdown</strong></span>.</p>
<p>Aquí puedes ver <a href="https://github.com/matiassingers/awesome-readme"><strong>algunos ejemplos de README.MD</strong></a></p>
</section>
<section id="repo-de-código" class="slide level2">
<h2>Repo de código</h2>
<p>Una vez que tenemos nuestro README de presentación (recuerda que puedes <span class="hl-yellow"><strong>personalizar a tu gusto con html y markdown</strong></span>) vamos a crear un <span class="hl-yellow"><strong>repositorio de código</strong></span>.</p>
<div class="fragment">
<p>Si ya era importante <span class="hl-yellow"><strong>trabajar con proyectos</strong></span> en <code>RStudio</code>, cuando lo combinamos con Github es aún más crucial que creemos un proyecto antes de subir el código, así que vamos a crear uno de prueba que se llame <code>repo-github-1</code>.</p>
</div>
<div class="fragment">
<p>En dicho proyecto vamos a <span class="hl-yellow"><strong>crear un script</strong></span> (en mi caso llamado <strong>codigo.R</strong>) en el que deberás hacer los siguientes pasos:</p>
</div>
</section>
<section id="repo-de-código-1" class="slide level2">
<h2>Repo de código</h2>
<ol type="1">
<li><span class="hl-yellow"><strong>Carga</strong></span> directamente desde la página del <a href="https://cnecovid.isciii.es/covid19/resources">ISCIII</a> el archivo llamado <code>casos_hosp_uci_def_sexo_edad_provres.csv</code></li>
</ol>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb462"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb462-1"><a href="#cb462-1"></a><span class="co"># Carga de datos desde ISCIII</span></span>
<span id="cb462-2"><a href="#cb462-2"></a>datos_covid <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"https://cnecovid.isciii.es/covid19/resources/casos_hosp_uci_def_sexo_edad_provres.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="fragment">
<ol start="2" type="1">
<li><span class="hl-yellow"><strong>Filtra</strong></span> datos de Madrid (<code>"M"</code>), de 2020 y con sexo conocido (hombre/mujer). Tras ello quédate con las columnas <code>fecha</code>, <code>sexo</code>, <code>grupo_edad</code>, <code>num_casos</code> (ese orden). Por último obtén la suma de casos diarios por fecha y sexo.</li>
</ol>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb463"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb463-1"><a href="#cb463-1"></a><span class="co"># Depuración</span></span>
<span id="cb463-2"><a href="#cb463-2"></a>datos_madrid <span class="ot">&lt;-</span></span>
<span id="cb463-3"><a href="#cb463-3"></a>  datos_covid <span class="sc">|&gt;</span></span>
<span id="cb463-4"><a href="#cb463-4"></a>  <span class="co"># Filtrado por Madrid y fecha</span></span>
<span id="cb463-5"><a href="#cb463-5"></a>  <span class="fu">filter</span>(provincia_iso <span class="sc">==</span> <span class="st">"M"</span> <span class="sc">&amp;</span> fecha <span class="sc">&lt;=</span> <span class="st">"2020-12-31"</span> <span class="sc">&amp;</span> sexo <span class="sc">!=</span> <span class="st">"NC"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb463-6"><a href="#cb463-6"></a>  <span class="co"># Selección de columnas</span></span>
<span id="cb463-7"><a href="#cb463-7"></a>  <span class="fu">select</span>(provincia_iso<span class="sc">:</span>fecha, num_casos) <span class="sc">|&gt;</span> </span>
<span id="cb463-8"><a href="#cb463-8"></a>  <span class="co"># Resumen de casos diarios por fecha y sexo</span></span>
<span id="cb463-9"><a href="#cb463-9"></a>  <span class="fu">summarise</span>(<span class="at">num_casos =</span> <span class="fu">sum</span>(num_casos), <span class="at">.by =</span> <span class="fu">c</span>(fecha, sexo))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</section>
<section id="repo-de-código-2" class="slide level2">
<h2>Repo de código</h2>
<ol start="3" type="1">
<li><span class="hl-yellow"><strong>Exporta el dataset a un csv</strong></span> en una carpeta que se llame <code>exportado</code></li>
</ol>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb464"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb464-1"><a href="#cb464-1"></a><span class="co"># Exportamos datos</span></span>
<span id="cb464-2"><a href="#cb464-2"></a><span class="fu">write_csv</span>(datos_madrid, <span class="at">file =</span> <span class="st">"./exportado/datos_madrid.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="fragment">
<div class="columns">
<div class="column" style="width:40%;">
<ol start="4" type="1">
<li>Crea una <span class="hl-yellow"><strong>gráfica de líneas</strong></span> que tenga en el eje x fecha, en el eje y casos, con una curva por sexo (gráficas separadas).</li>
</ol>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb465"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb465-1"><a href="#cb465-1"></a><span class="co"># Gráfica</span></span>
<span id="cb465-2"><a href="#cb465-2"></a><span class="fu">ggplot</span>(datos_madrid) <span class="sc">+</span></span>
<span id="cb465-3"><a href="#cb465-3"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> fecha, <span class="at">y =</span> num_casos, <span class="at">color =</span> sexo),</span>
<span id="cb465-4"><a href="#cb465-4"></a>            <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">linewidth =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb465-5"><a href="#cb465-5"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#85519D"</span>, <span class="st">"#278862"</span>)) <span class="sc">+</span></span>
<span id="cb465-6"><a href="#cb465-6"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>sexo) <span class="sc">+</span></span>
<span id="cb465-7"><a href="#cb465-7"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb465-8"><a href="#cb465-8"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div><div class="column" style="width:60%;">
<p><img data-src="./img/ggplot.png" width="380"></p>
</div>
</div>
</div>
<div class="fragment">
<ol start="5" type="1">
<li>Tras ello <span class="hl-yellow"><strong>exportamos la gráfica</strong></span></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb466"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb466-1"><a href="#cb466-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"./exportado/ggplot.png"</span>, <span class="at">plot =</span> <span class="fu">last_plot</span>(),</span>
<span id="cb466-2"><a href="#cb466-2"></a>       <span class="at">bg =</span> <span class="st">"white"</span>, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="repo-de-código-3" class="slide level2">
<h2>Repo de código</h2>
<p>¿Cómo <span class="hl-yellow"><strong>subimos el proyecto</strong></span>? Vamos de nuevo a <span class="hl-yellow"><strong>crear un proyecto de cero</strong></span>. Antes no hemos hablado de dos campos importantes:</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="./img/repo-1.png" width="460"></p>
</div><div class="column" style="width:50%;">
<ul>
<li><p><code>Add .gitignore</code> nos permitirá <span class="hl-yellow"><strong>seleccionar el lenguaje</strong></span> en el que estará nuestro proyecto para que Github lo entienda al sincronizar (y no actualice cosas que no deba).</p></li>
<li><p><code>Choose a license</code> nos permitirá <span class="hl-yellow"><strong>seleccionar la licencia</strong></span> que determinará las condiciones en las que otros podrán reusar tu código.</p></li>
</ul>
</div>
</div>
</section>
<section id="repo-de-código-4" class="slide level2">
<h2>Repo de código</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="./img/repo-1-1.png"></p>
</div><div class="column" style="width:50%;">
<p>Si te fijas traer crearlo tenemos solo 3 archivos: el de licencia, el .gitignore y el readme.md (donde deberíamos escribir una guía de uso de lo que hayamos subido)</p>
</div>
</div>
<p>Para subir los archivos vamos a clickar en <span class="hl-purple"><strong>Add file &lt; Upload File</strong></span> y <span class="hl-yellow"><strong>arrastraremos TODOS los archivos</strong></span> de la carpeta de nuestro proyecto.</p>
</section>
<section id="repo-de-código-5" class="slide level2">
<h2>Repo de código</h2>
<p>Tras la subida de archivos tendremos un cuadro llamado <span class="hl-purple"><strong>Commit changes</strong></span></p>

<img data-src="./img/commit-1.png" class="r-stretch"><p>Un <span class="hl-purple"><strong>commit</strong></span> es una <span class="hl-yellow"><strong>modificación del repositorio</strong></span> con algo que se añade/elimine/modifique, y dicho cuadro es recomendable usarlo para <span class="hl-yellow"><strong>resumir en qué consiste la modificación</strong></span>, de manera que quede trazado el cambio.</p>
</section>
<section id="repo-de-código-6" class="slide level2">
<h2>Repo de código</h2>
<p>Haciendo click en el reloj donde indica el <span class="hl-yellow"><strong>número de commits</strong></span> accedemos al <span class="hl-yellow"><strong>histórico de commits (cambios)</strong></span> con hora, día, autor, comentarios, etc.</p>

<img data-src="./img/commit-reloj.png" class="r-stretch"></section>
<section id="repo-de-código-7" class="slide level2">
<h2>Repo de código</h2>
<p>Vamos a realizar un <span class="hl-yellow"><strong>cambio en nuestro código</strong></span>: en tu código local (local –&gt; tu ordenador), en lugar de filtrar por Madrid haz el <span class="hl-yellow"><strong>filtro por Barcelona</strong></span>, guarda el código y sube en el repositorio el nuevo archivo (con el mismo nombre, Github hará la sobrescritura)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb467" data-code-line-numbers="3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb467-1"><a href="#cb467-1"></a>datos_bcn <span class="ot">&lt;-</span></span>
<span id="cb467-2"><a href="#cb467-2"></a>  datos_covid <span class="sc">|&gt;</span></span>
<span id="cb467-3"><a href="#cb467-3"></a>  <span class="fu">filter</span>(provincia_iso <span class="sc">==</span> <span class="st">"B"</span> <span class="sc">&amp;</span> fecha <span class="sc">&lt;=</span> <span class="st">"2020-12-31"</span> <span class="sc">&amp;</span> sexo <span class="sc">!=</span> <span class="st">"NC"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb467-4"><a href="#cb467-4"></a>  <span class="fu">select</span>(fecha, sexo, grupo_edad, num_casos) <span class="sc">|&gt;</span> </span>
<span id="cb467-5"><a href="#cb467-5"></a>  <span class="fu">summarise</span>(<span class="at">num_casos =</span> <span class="fu">sum</span>(num_casos), <span class="at">.by =</span> <span class="fu">c</span>(fecha, sexo))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="consulta-de-commits" class="slide level2">
<h2>Consulta de commits</h2>
<p><img data-src="./img/barcelona_covid.png" width="550"></p>
<div class="columns">
<div class="column" style="width:40%;">
<p>Si ahora <span class="hl-yellow"><strong>consultamos el commit</strong></span>, al lado hay un número que lo identifica, y clickando en él nos resume los cambios: no solo <span class="hl-yellow"><strong>almacena todas las versiones pasadas</strong></span> sino que además nos <span class="hl-yellow"><strong>muestra las diferencias entre los archivos cambiados</strong></span></p>
</div><div class="column" style="width:60%;">
<p><img data-src="./img/commit_cambio.png"></p>
</div>
</div>
</section>
<section id="trazabilidad-de-cambios" class="slide level2">
<h2>Trazabilidad de cambios</h2>
<div class="columns">
<div class="column" style="width:72%;">
<p><img data-src="./img/commit_split.png"> <img data-src="./img/commit_unified.png"></p>
</div><div class="column" style="width:28%;">
<p>Tenemos <span class="hl-yellow"><strong>dos modos de visualización</strong></span> de los cambios: el modo split nos muestra el antiguo y el nuevo, con las inclusiones en verde y lo que ya no está en rojo; y el modo unified nos muestra todo en un mismo documento.</p>
</div>
</div>
</section>
<section id="recuperación-de-commits" class="slide level2">
<h2>Recuperación de commits</h2>

<img data-src="./img/browse-repo.png" class="r-stretch"><p>Github nos permite incluso <span class="hl-yellow"><strong>recuperar una versión del pasado</strong></span> de nuestro repositorio, haciendo click en el tercer icono del commit.</p>
</section>
<section id="recuperación-de-commits-1" class="slide level2">
<h2>Recuperación de commits</h2>

<img data-src="./img/branch-commit.png" class="r-stretch"><p>Si te fijas ahora al lado de <code>1 branch</code> tenemos un <span class="hl-yellow"><strong>menú desplegable</strong></span> en el que antes ponía <code>main</code> y ahora un número identificador del commit. Ya hablaremos de la idea de <span class="hl-yellow"><strong>rama (branch)</strong></span></p>
</section>
<section id="repo-con-rmdqmd" class="slide level2">
<h2>Repo con rmd/qmd</h2>
<div class="columns">
<div class="column" style="width:60%;">
<p>Vamos a poner en práctica lo aprendido:</p>
<ol type="1">
<li><p>Crea un nuevo repositorio en Github (llamado <code>repo-github-2</code>) donde habrá alojado con proyecto de R.</p></li>
<li><p>Crea un proyecto en <code>RStudio</code> que se llame (por ejemplo) <code>proyecto-qmd</code></p></li>
<li><p>Una vez dentro del proyecto en <code>RStudio</code> haz click en <code>File &lt; New File &lt; Quarto Document</code></p></li>
</ol>
</div><div class="column" style="width:40%;">
<p><img data-src="./img/primer-qmd.png"></p>
</div>
</div>
<p>Deberás tener un documento similar a este: un <span class="hl-yellow"><strong>quarto markdown (.qmd)</strong></span>, un documento que nos permitirá incluir <span class="hl-yellow"><strong>markdown + código</strong></span> (puede ser <code>R</code> o puede ser <code>Observable</code>, <code>D3</code>, etc).</p>
</section>
<section id="repo-con-rmdqmd-1" class="slide level2">
<h2>Repo con rmd/qmd</h2>
<p>Este formato es ideal para:</p>
<ul>
<li><span class="hl-yellow"><strong>Trabajar en equipo</strong></span> construyendo el borrador de una pieza.</li>
<li>Tomar <span class="hl-yellow"><strong>apuntes o informes</strong></span> para uno mismo.</li>
<li><span class="hl-yellow"><strong>Presentar</strong></span> tu trabajo a tus compañeros.</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="./img/prueba-qmd-html.png"></p>
</div><div class="column" style="width:50%;">
<p>Si te fijas ahora nuestro repositorio tiene un archivo con formato <code>.html</code>…es decir…</p>
<p><span class="hl-yellow"><strong>¡Es una web!</strong></span></p>
</div>
</div>
</section>
<section id="github-pages" class="slide level2">
<h2>Github pages</h2>
<p>¿Cómo <span class="hl-yellow"><strong>convertir nuestro repositorio en una web</strong></span>?</p>

<img data-src="./img/github-pages.png" class="r-stretch"><ol type="1">
<li>Haz click en <code>Settings</code></li>
<li>Ve al apartado <code>Pages</code></li>
<li>En el subapartado <code>branch</code> selecciona la única rama que tenemos ahora (<code>main</code>)</li>
<li>Selecciona la carpeta donde tengas el <code>.html</code> (en web complejas estará como en cualquier web en <code>docs</code>, en algo simple estará en la ruta raiz del repositorio)</li>
<li>Haz click en <code>Save</code></li>
</ol>
</section>
<section id="github-pages-1" class="slide level2">
<h2>Github pages</h2>
<p>Si te fijas en la <span class="hl-yellow"><strong>parte superior del repositorio</strong></span> ahora tenemos un icono naranja, que nos indica que la <span class="hl-orange"><strong>web está en proceso de ser desplegada (deploy)</strong></span></p>

<img data-src="./img/github-naranja.png" class="r-stretch"></section>
<section id="github-pages-2" class="slide level2">
<h2>Github pages</h2>
<p>Pasados unos segundos (dependiendo del tamaño de la web y tu conexión a internet) ese <span class="hl-green"><strong>icono pasará a ser un check verde</strong></span>: habemus web</p>

<img data-src="./img/github-verde.png" class="r-stretch"><p>El <span class="hl-yellow"><strong>link de la web por defecto</strong></span> será <code>{nombre_usuario}.github.io/{nombre_repo}</code></p>
</section>
<section id="github-pages-3" class="slide level2">
<h2>Github pages</h2>

<img data-src="./img/github-pages-deploy.png" class="r-stretch"><p>¡Un momento! Ahora mismo nuestra web <span class="hl-red"><strong>no nos está mostrando nuestro .qmd</strong></span>, sino por defecto el <span class="hl-yellow"><strong>README.md</strong></span>.</p>
<div class="fragment">
<p>Para que Github entienda que queremos visualizar ese <code>.html</code> que hemos generado a partir del <code>.qmd</code> vamos en nuestro proyecto local a <span class="hl-yellow"><strong>borrar</strong></span> todo lo que no sea nuestro archivo <code>.Rproj</code> y nuestro archivo <code>.qmd</code>, y vamos a <span class="hl-yellow"><strong>cambiar el nombre</strong></span> a este último llamándolo <code>index.qmd</code>, y volvemos a compilarlo para <span class="hl-yellow"><strong>generar un index.html</strong></span></p>
</div>
</section>
<section id="github-pages-4" class="slide level2">
<h2>Github pages</h2>
<p>Vamos a <span class="hl-yellow"><strong>subir a Github ese nuevo proyecto</strong></span> con el cambio de nombre (llamado <code>repo-github-3</code>) para ver luego las diferencias entre uno y otro</p>

<img data-src="./img/repo-index-html.png" class="r-stretch"></section>
<section id="github-pages-5" class="slide level2">
<h2>Github pages</h2>
<p>Si <span class="hl-yellow"><strong>repetimos el proceso para hacer una Page</strong></span> y esperamos al tick verde…</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="./img/index-html-qmd.png"></p>
</div><div class="column" style="width:50%;">
<p>Si a tu <code>.qmd</code> ya le llamas de inicio <code>index.qmd</code>, automáticamente, al detectar Github un <code>index.html</code>, interpreta que ese <span class="hl-yellow"><strong>archivo index.html</strong></span> es el que define la web (y puedes personalizar añadiendo un archivo <code>css</code> de estilos)</p>
<p><span class="hl-green"><strong>Habemus web</strong></span> simplemente clickando en Pages :)</p>
</div>
</div>
</section>
<section id="repo-con-diapositivas" class="slide level2">
<h2>Repo con diapositivas</h2>
<p>Vamos a crear el último repositorio que se llamará <code>repo-diapos</code>, y crear un proyecto en <code>RStudio</code> del mismo nombre (por ejemplo). Una vez creado le daremos a <code>File &lt; New File &lt; Quarto Presentation</code>.</p>
<div class="columns">
<div class="column" style="width:45%;">
<p><img data-src="img/quarto-slides.png"></p>
</div><div class="column" style="width:55%;">
<p>La forma de escribir será igual que un <code>.qmd</code> normal solo que ahora <span class="hl-yellow"><strong>cada diapositiva la separaremos</strong></span> con un <code>---</code> (usando archivos de estilos podemos personalizar lo que queramos)</p>
<p>Llama al archivo directamente <code>index.qmd</code>, súbelo a Github y con un click en Pages tienes una <span class="hl-yellow"><strong>web con tus diapositivas</strong></span></p>
</div>
</div>
</section>
<section id="uso-de-gitkraken" class="slide level2">
<h2>Uso de Gitkraken</h2>
<p>La forma más <span class="hl-yellow"><strong>sencilla para trabajar de manera colaborativa</strong></span> en Github, y tenerlo sincronizado con nuestro local, es hacer uso de <a href="https://www.gitkraken.com/download">Gitkraken</a></p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/gitkraken-repo.png"></p>
</div><div class="column" style="width:50%;">
<p>Una vez dentro clickamos en el icono de la carpeta (<code>Repo Management</code>) y si ya tenemos el repositorio en Github seleccionamos <code>Clone</code>, indicando donde queremos clonar (en nuestro local) y que <span class="hl-yellow"><strong>repositorio de Github queremos clonar</strong></span>.</p>
</div>
</div>
</section>
<section id="uso-de-gitkraken-1" class="slide level2">
<h2>Uso de Gitkraken</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/view-change.png"></p>
</div><div class="column" style="width:50%;">
<p>Una vez clonado, la idea es que cada <span class="hl-yellow"><strong>cambio que hagamos en local nos aparecerá en Gitkraken</strong></span> como <code>View changes</code>.</p>
</div>
</div>
</section>
<section id="uso-de-gitkraken-2" class="slide level2">
<h2>Uso de Gitkraken</h2>
<p>Cuando tengas suficientes cambios como para <span class="hl-yellow"><strong>actualizar el repositorio</strong></span> (tampoco tiene sentido actualizar con cada edición), verás algo similar a esto con todos los <span class="hl-yellow"><strong>commits realizados</strong></span></p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/stage-all-changes.png"></p>
</div><div class="column" style="width:50%;">
<p>Podrás decidir cuáles de los <span class="hl-yellow"><strong>commits locales quieres incluir en remoto</strong></span>, bien uno a uno o en <code>Stage all changes</code> (para todos)</p>
</div>
</div>
</section>
<section id="uso-de-gitkraken-3" class="slide level2">
<h2>Uso de Gitkraken</h2>
<p>Tras incluir los commits deberás incluir un <span class="hl-yellow"><strong>título y descripción del commit</strong></span></p>

<img data-src="img/titulo-commit.png" class="r-stretch"></section>
<section id="uso-de-gitkraken-4" class="slide level2">
<h2>Uso de Gitkraken</h2>
<p>Tras hacerlo verás que ahora tenemos <span class="hl-yellow"><strong>dos iconos separados en una especie de árbol</strong></span> (¿te acuerdas de la <code>branch</code> o rama?):</p>
<ul>
<li><p><span class="hl-purple"><strong>Ordenador</strong></span>: la versión del repositorio que tienes en tu <span class="hl-yellow"><strong>ordenador</strong></span>.</p></li>
<li><p><span class="hl-purple"><strong>Logo</strong></span>: la versión del repositorio que tienes <span class="hl-yellow"><strong>subida en remoto</strong></span></p></li>
</ul>

<img data-src="img/split-gitkraken.png" class="r-stretch"></section>
<section id="uso-de-gitkraken-5" class="slide level2">
<h2>Uso de Gitkraken</h2>
<p>Mientras eso suceda solo tendrás sincronizado tu ordenador con Gitkraken, pero no con Github. Para ello haremos <span class="hl-yellow"><strong>click en Push</strong></span> (con <code>Pull</code> podrás forzar a tener en local lo mismo que en remoto).</p>

<img data-src="img/push-gitkraken.png" class="r-stretch"></section>
<section id="branchs" class="slide level2">
<h2>Branchs</h2>
<p>Como hemos mencionado ya en varias ocasiones, hay un elefante en la habitación que aún no hemos mentado: las <span class="hl-yellow"><strong>ramas o branchs</strong></span> de un repositorio.</p>
<div class="fragment">
<p>Imagina que estáis trabajando varios en un proyecto y teneís una versión que funciona pero que queréis <span class="hl-yellow"><strong>modificar en paralelo a partir del estado actual</strong></span> del repositorio.</p>
</div>
<div class="fragment">
<p>Las <span class="hl-yellow"><strong>ramas</strong></span> nos permiten partir de una versión común del repositorio y hacer cambios que <span class="hl-yellow"><strong>no afecten a los demás</strong></span></p>
</div>
</section>
<section id="branchs-1" class="slide level2">
<h2>Branchs</h2>
<p>Para <span class="hl-yellow"><strong>crear una rama</strong></span> a partir del estado actual de repositorio haremos click en <code>Branch</code> y le pondremos un nombre</p>

<img data-src="img/branch-button.png" class="r-stretch"><p>Una vez creada verás <span class="hl-yellow"><strong>dos iconos</strong></span> y un <span class="hl-yellow"><strong>menú desplegable</strong></span> con las distintas ramas en las que quieres hacer el commit. Imagina que realizas un cambio pero <span class="hl-yellow"><strong>no quieres añadirlo a la rama principal</strong></span>: puedes hacer el <span class="hl-yellow"><strong>commit en tu rama propia en LOCAL</strong></span> (lo harás en la rama activa de tu menú de branchs).</p>
</section>
<section id="branchs-2" class="slide level2">
<h2>Branchs</h2>
<p>La primera vez te pedirá que escribas la <span class="hl-yellow"><strong>rama en REMOTO</strong></span> con la quieres sincronizar tu rama en local. <span class="hl-green"><strong>Consejo</strong></span>: ponle el mismo nombre en remoto que en local.</p>

<img data-src="img/name-branch.png" class="r-stretch"></section>
<section id="branchs-3" class="slide level2">
<h2>Branchs</h2>
<p>Fíjate que ahora tenemos el ordenador y el logo en el mismo sitio. Esto no significa que tengas ambas ramas en tu local, solo que <span class="hl-yellow"><strong>Gitkraken tiene ambas sincronizadas</strong></span>: clickando en cualquiera de ellas, tus archivos en tu ordenador cambiarán.</p>

<img data-src="img/both-branchs.png" class="r-stretch"></section>
<section id="pull-request" class="slide level2">
<h2>Pull request</h2>
<p>Lo más recomendable es que <span class="hl-yellow"><strong>solo se incorpore de una rama secundaria</strong></span> a la rama principal aquello que está <span class="hl-yellow"><strong>validado por un/a coordinador/a</strong></span> del repositorio, asegurándose que todo funciona correctamente.</p>
<p>Cuando queramos incluirlo haremos <span class="hl-yellow"><strong>click con botón derecho</strong></span> en el icono de la rama secundaria y seleccionamos <code>Start a pull request to origin from...</code></p>

<img data-src="img/pull-request-menu.png" class="r-stretch"><div class="fragment">
<p>Una <span class="hl-yellow"><strong>pull request</strong></span> será una <span class="hl-yellow"><strong>petición al responsable de la rama principal</strong></span> para incluir los cambios</p>
</div>
</section>
<section id="pull-request-1" class="slide level2">
<h2>Pull request</h2>
<div class="columns">
<div class="column" style="width:60%;">
<p><img data-src="img/create-pull-request.png"></p>
</div><div class="column" style="width:40%;">
<p>En el cuadro que no se abre deberemos escribir:</p>
<ul>
<li>La <span class="hl-yellow"><strong>rama</strong></span> a la que hacer el <code>merge</code> (normalmente la <code>main</code>)</li>
<li>Título y resumen de los cambios</li>
<li>Puedes incluso asignar un <span class="hl-yellow"><strong>revisor</strong></span> entre los colaboradores del repo.</li>
<li>Puedes asignar <span class="hl-yellow"><strong>etiquetas</strong></span></li>
</ul>
</div>
</div>
</section>
<section id="pull-request-2" class="slide level2">
<h2>Pull request</h2>
<p>Mientras no se acepte aparecerá un <span class="hl-yellow"><strong>icono de rama</strong></span> y un +1 en Pull Requests</p>
<p><img data-src="img/pending-branch.png" width="500"></p>
<div class="fragment">
<p>Si somos al mantenedor del repositorio, haciendo click en el menú nos saldrán las ramas que nos quieren hacer hacer <code>merge</code></p>
<p><img data-src="img/menu-pr.png" width="500"></p>
</div>
</section>
<section id="pull-request-3" class="slide level2">
<h2>Pull request</h2>
<p>Al hacer click se abrirá un <span class="hl-yellow"><strong>cuadro de Pull Request</strong></span> para decidir si</p>
<ul>
<li><span class="hl-yellow"><strong>Revisar</strong></span> los cambios</li>
<li><span class="hl-yellow"><strong>Aprobar</strong></span> el <code>merge</code></li>
<li><span class="hl-yellow"><strong>Añadir comentarios</strong></span> al que ha solicitado el <code>merge</code> por si queremos solicitar algún cambio <span class="hl-yellow"><strong>antes de ser aprobado</strong></span></li>
</ul>

<img data-src="img/menu-pr-2.png" class="r-stretch"></section>
<section id="pull-request-4" class="slide level2">
<h2>Pull request</h2>
<p>Tras revisar todo y aprobarlo clickaremos en <code>Confirm merge</code>, y tras ello podremos decidir si esa rama que era paralela a la principal la queremos <span class="hl-yellow"><strong>eliminar</strong></span> o dejar visible a todos (consejo: dejar visible para tene <span class="hl-yellow"><strong>trazabilidad</strong></span> del proyecto de trabajo)</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/merge-branch.png"></p>
</div><div class="column" style="width:50%;">
<p><img data-src="img/delete-branch.png"></p>
</div>
</div>
<div class="footer footer-default">
<p><a href="..."><strong>Javier Álvarez Liébana</strong></a> • Seminarios BioDS (UCM) • curso 2023-2024</p>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="index_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="index_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="index_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="index_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="index_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="index_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="index_files/libs/revealjs/plugin/multiplex/socket.io.js"></script>
  <script src="index_files/libs/revealjs/plugin/multiplex/multiplex.js"></script>
  <script src="index_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="index_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="index_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="index_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="index_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true,"width":"normal"},
'chalkboard': {"buttons":true},
'multiplex': {"secret":null,"id":"1b0ff0461e955904","url":"https://reveal-multiplex.glitch.me/"},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>